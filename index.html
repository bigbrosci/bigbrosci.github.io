<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.bigbrosci.com","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.8.2","exturl":false,"sidebar":{"position":"right","width":240,"display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta property="og:type" content="website">
<meta property="og:title" content="Learn VASP The Hard Way">
<meta property="og:url" content="http://www.bigbrosci.com/index.html">
<meta property="og:site_name" content="Learn VASP The Hard Way">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="By BigBro(a)s">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://www.bigbrosci.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Learn VASP The Hard Way</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Learn VASP The Hard Way</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">The 2nd edition</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">By BigBro(a)s</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">125</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">162</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2022/05/23/A31/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/23/A31/" class="post-title-link" itemprop="url">VTST的编译</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-23 15:30:16" itemprop="dateCreated datePublished" datetime="2022-05-23T15:30:16-04:00">2022-05-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-24 08:51:07" itemprop="dateModified" datetime="2022-05-24T08:51:07-04:00">2022-05-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2022/05/23/A31/" class="post-meta-item leancloud_visitors" data-flag-title="VTST的编译" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2022/05/23/A31/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022/05/23/A31/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>VTST的编译并不难，关键主要有2点：</p>
<p>1）VASP能顺利编译</p>
<p>2）VTST编译的时候，严格按照官网的说明一步一步来即可。</p>
<p>为什么要编译VTST，说白了还是VASP自带的功能不强大，没法解决我们的实际计算问题，主要是过渡态结构的搜索。因此，我们需要把VTST的一些功能添加到VASP中。网上可以搜到很多相关的编译教程，这里主要简单介绍下编译的几点注意事项，理清编译的思路，增加成功率。</p>
<p>首先，在编译VTST之前，要确定你顺利编译了VASP。如果这一步你还没搞定，就打算直接编译VTST，会导致你不知道问题从哪里来？是VASP编译的原因呢？还是VTST的原因？另外，VTST编译命令跟VASP是一样的，都是make，只要按照VTST官网的说明，复制文件到指定目录， 修改特定的文件内容，其他的和VASP编译设置一致即可。</p>
<p>其次，一定要看官网。记住，官网永远是学习的第一手资料，很多人喜欢看各种各样的教程，大部分教程都是官网的阉割版。或多或少会丢失些重要的信息，导致出错了不知道怎么解决。</p>
<p>最后，我们介绍下官网的编译说明 (<a target="_blank" rel="noopener" href="https://theory.cm.utexas.edu/vtsttools/installation.html)%EF%BC%8C%E5%A4%A7%E5%AE%B6%E7%BC%96%E8%AF%91%E5%A5%BDVASP%E4%B9%8B%E5%90%8E%EF%BC%8C%E6%8C%89%E7%85%A7%E8%AF%B4%E6%98%8E%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E8%B5%B0%EF%BC%8C%E5%9F%BA%E6%9C%AC%E9%83%BD%E8%83%BD%E9%A1%BA%E5%88%A9%E7%BC%96%E8%AF%91VTST%E5%88%B0VASP%E4%B8%AD%EF%BC%9A">https://theory.cm.utexas.edu/vtsttools/installation.html)，大家编译好VASP之后，按照说明一步一步走，基本都能顺利编译VTST到VASP中：</a></p>
<ol>
<li>第一步当然是下载并解压VTST的程序包喽：(<a target="_blank" rel="noopener" href="https://theory.cm.utexas.edu/vtsttools/download.html">https://theory.cm.utexas.edu/vtsttools/download.html</a>)</li>
</ol>
<p>解压后，发现压缩包里的文件有些令人犯迷糊，简单说明下： VTST提供了对应三种VASP版本编译的文件。</p>
<p>i)  vtstcode5 文件夹里面对应的是VASP5 版本的</p>
<p>ii) vtstcode6.1 文件夹里面对应的是VASP6.1和6.2版本的</p>
<p>iii) vtstcode5 和 vtstcode6.1两个文件夹外面的文件对应的是VASP6.3版本的。</p>
<p>iv) VASP5升级到VASP6不管是6.1还是6.3）要额外花钱，如果你有VASP5的版权，那么就用vtstcode5的文件，VASP5也有很多的子版本，尽量用最新的5.4.4。</p>
<p>v)  VASP6.1&#x2F;2升级到VASP6.3不花钱，6.3还支持机器学习，所以vtst6.1这个文件夹，直接删掉就OK了，暂不用它，直接搞6.3。</p>
<p><img src="/2022/05/23/A31/A31.png"></p>
<ol start="2">
<li><p>编译前的准备：</p>
<p>i) cp 5.4.4   5.4.4_vtst   &amp;&amp; cd  5.4.4_vtst  </p>
<p>这样的话，我们可以用原生的VASP,亦可以用VTST强化过的。另外，这也是对VASP的一个备份；</p>
<p>ii) 将下载的文件复制到 src文件中： </p>
<p>ii) 编辑src文件中的main.F 文件</p>
<p>按照官网的说明，VIM打开src&#x2F;main.F 文件，找到对应的部分，直接替换即可。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">In VTST v2.04 and later, a modification is required in main.F for the solid-state NEB.</span><br><span class="line"></span><br><span class="line">Find and replace:</span><br><span class="line"></span><br><span class="line">CALL CHAIN_FORCE(T_INFO%NIONS,DYN%POSION,TOTEN,TIFOR, &amp;</span><br><span class="line">     LATT_CUR%A,LATT_CUR%B,IO%IU6)</span><br><span class="line">with</span><br><span class="line"></span><br><span class="line">CALL CHAIN_FORCE(T_INFO%NIONS,DYN%POSION,TOTEN,TIFOR, &amp;</span><br><span class="line">     TSIF,LATT_CUR%A,LATT_CUR%B,IO%IU6)</span><br><span class="line">For vasp.6.2 also find and replace:</span><br><span class="line"></span><br><span class="line">IF (LCHAIN) CALL chain_init( T_INFO, IO)</span><br><span class="line">with</span><br><span class="line"></span><br><span class="line">CALL chain_init( T_INFO, IO)</span><br><span class="line">For vasp.6.2.1 you will need vtstcode 4.1 (revision 182). A version of the vtstcode that will work with vasp.6.1.x - vasp.6.2.0 has been saved in the vtstcode6.1 directory.</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：VASP6.2还需要额外替换一行，至于6.3是不是跟6.2一样？ 可以编译2个版本,一个替换，一个不替换，然后对比下。本人测试的结果是，如果不替换，编译会失败。</p>
<p>iii) 编辑 src&#x2F;.objects文件</p>
<p>先看下官网的说明：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">To build the code, the VASP makefile needs to be changed. Find the variable SOURCE, which defines which objects will be built, and add the following objects before chain.o:</span><br><span class="line"></span><br><span class="line">bfgs.o dynmat.o  instanton.o  lbfgs.o sd.o   cg.o dimer.o bbm.o \</span><br><span class="line">fire.o lanczos.o neb.o  qm.o opt.o</span><br><span class="line">The objects dynmat.o, neb.o, dimer.o, lanczos.o, and instanton.o must be in the SOURCE list before chain.o appears. The optimizer objects, sd.o, cg.o, qm.o, lbfgs.o, bfgs.o, and fire.o must appear before the optimizer driver opt.o. Nothing else needs to be done. </span><br></pre></td></tr></table></figure>

<p>官网里面有句话：Find the variable SOURCE, which defines which objects will be built, and add the following objects before chain.o。</p>
<p>这里的<code>variable SOURCE</code>指的就是src目录里面的<code>.objects</code>文件，这个文件前面带<code>.</code>，是隐藏的。用VIM或者其他文本编辑软件直接打开编辑就行。</p>
<p>主要有2点，加粗的<code>Before</code>告诉你怎么改<code>.objects</code>文件：</p>
<p>1： The objects dynmat.o, neb.o, dimer.o, lanczos.o, and instanton.o must be in the SOURCE list <strong>before</strong> chain.o appears. </p>
<p>2： The optimizer objects, sd.o, cg.o, qm.o, lbfgs.o, bfgs.o, and fire.o must appear <strong>before</strong> the optimizer driver opt.o. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">70         tetweight.o \</span><br><span class="line">71         hamil_rot.o \</span><br><span class="line">72         bfgs.o dynmat.o  instanton.o  lbfgs.o sd.o   cg.o dimer.o bbm.o \</span><br><span class="line">73         fire.o lanczos.o neb.o  qm.o opt.o \</span><br><span class="line">74         chain.o \</span><br></pre></td></tr></table></figure>

<p>直接复制官网的文本，将72,73行内容放到指定的位置即可(chain.o前面)，不要随便改顺序。</p>
</li>
<li><p>回顾下，1）将VTST的文件复制到src目录里面，2） 修改main.F，3） 修改 .object文件。没有遗漏的话，就可以直接编译了。直接make命令，喝杯咖啡等着即可，下面是本人编译的一些具体命令：<code>5.4.4</code> 是已经编译好的VASP5的目录，VTST（<code>5.4.4_vtst</code>）编译时环境变量的设置跟<code>5.4.4</code>完全一样。</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cp 5.4.4   5.4.4_vtst  </span><br><span class="line">cd  5.4.4_vtst  </span><br><span class="line">cp ~/Downloads/vtstcode-184/vtstcode5/*  src/</span><br><span class="line">vi src/main.F</span><br><span class="line">vi src/.objects</span><br><span class="line">make </span><br></pre></td></tr></table></figure>

<ol start="4">
<li>确认是否顺利编译，直接运行个例子看看就知道了。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep VTST -A 10 02/OUTCAR</span><br></pre></td></tr></table></figure>

<p>没问题的话则会出现下面的内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">VTST: version 3.2, (02/03/18)</span><br><span class="line"></span><br><span class="line"> CHAIN: initializing optimizer</span><br><span class="line"> </span><br><span class="line"> OPT: Using Conjugate-Gradient optimizer</span><br><span class="line"> OPT: CG, Init</span><br><span class="line"> OPT: CG, FDSTEP      0.005000</span><br><span class="line"> OPT: CG, MAXMOVE      0.200000</span><br><span class="line"> </span><br><span class="line"> CHAIN: Read ICHAIN            0</span><br><span class="line"> CHAIN: Running the NEB</span><br></pre></td></tr></table></figure>



<ol start="5">
<li><p>简单总结下：编译VTST主要有以下4个小细节：</p>
<p>i) 前提是顺利编译完成了VASP，这也是最关键的地方。</p>
<p>ii) 下载VTST的code，找到对应VASP版本的文件，并复制到src目录中</p>
<p>iii) 修改src&#x2F;main.F 文件</p>
<p>iv) 修改src&#x2F;.objects 文件</p>
</li>
<li><p>欢迎大家分享自己的经验，放到自己的网站，公众号等平台，帮助更多的人解决VTST编译的问题，也可以添加到本文章中 （<a href="mailto:&#x6c;&#113;&#99;&#x61;&#116;&#x61;&#x40;&#103;&#x6d;&#97;&#105;&#x6c;&#x2e;&#x63;&#111;&#x6d;">&#x6c;&#113;&#99;&#x61;&#116;&#x61;&#x40;&#103;&#x6d;&#97;&#105;&#x6c;&#x2e;&#x63;&#111;&#x6d;</a>）。此外，VTST的Code怎么下载？有没有具体运行的案例？提交任务的命令怎么写？按照这个说明编译失败了，怎么办？这些问题就不要找我了。我相当圣母，可俺是男的。实在没办法，放弃也是个很好的选择。</p>
</li>
</ol>
<p><img src="/2022/05/23/A31/A30/qrcode.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2022/04/29/A30/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/29/A30/" class="post-title-link" itemprop="url">VASP官方视频</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-04-29 05:30:16 / 修改时间：23:18:02" itemprop="dateCreated datePublished" datetime="2022-04-29T05:30:16-04:00">2022-04-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2022/04/29/A30/" class="post-meta-item leancloud_visitors" data-flag-title="VASP官方视频" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2022/04/29/A30/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022/04/29/A30/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="/2022/04/29/A30/fig1.png"></p>
<p>VASP官方在Youtube上开了自己的channel，虽然只有寥寥300多人关注，但也分析了9个视频。下载下来后大约是1G左右。1G只是个嚼头而已。主要内容如下：</p>
<p><img src="/2022/04/29/A30/fig2.png"></p>
<p>1 Advanced_methods_of_molecular_dynamics_VASP_Lecture</p>
<p>2 Basics_of_machine_learning_force_fields_VASP_Lecture</p>
<p>3 Electronic_Convergence_VASP_Lecture</p>
<p>4 Hybrid_functionals_VASP_Lecture</p>
<p>5 Introduction_to_ab_initio_simulation_in_VASP_VASP_Lecture</p>
<p>6 Introduction_to_molecular_dynamics_VASP_Lecture</p>
<p>7 py4vasp_04_release</p>
<p>8 Symmetry_and_sampling_in_reciprocal_space_VASP_Lecture</p>
<p>9 VASP_6.3_release</p>
<p>从图1里面文件大小可以看出来，除了7和9介绍新的后处理工具py4vasp和vasp6.3新版本之外，其他的7个视频都干货满满。不信的话再看看视频的时间，都在1个小时以上，相信对大家学习VASP肯定有帮助。</p>
<p><img src="/2022/04/29/A30/fig3.png"></p>
<p>建议大家关注下VASP的Youtube频道，这么牛逼的软件，才300多号人关注。哈哈。不过得科学上网，没有条件可以通过大师兄分享的网盘链接下载，</p>
<p>下载方式：关注公众号：大师兄科研网，后台回复： youtube   即可。</p>
<p><img src="/2022/04/29/A30/qrcode.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2022/04/29/A29/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/29/A29/" class="post-title-link" itemprop="url">ASE消虚频的小脚本</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-04-29 00:30:16 / 修改时间：23:17:44" itemprop="dateCreated datePublished" datetime="2022-04-29T00:30:16-04:00">2022-04-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2022/04/29/A29/" class="post-meta-item leancloud_visitors" data-flag-title="ASE消虚频的小脚本" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2022/04/29/A29/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022/04/29/A29/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="ASE消虚频的小脚本"><a href="#ASE消虚频的小脚本" class="headerlink" title="ASE消虚频的小脚本"></a>ASE消虚频的小脚本</h4><p>做计算，虚频是令我们又爱又恨的一个东西。结构优化的时候，出现虚频，往往需要我们花费大量的时间和精力去消掉它们，最后搞得精疲力尽。算过渡态的时候，它又不出来，又得折腾个半死才出现。再不幸一些，除了过渡态对应的虚频外，还出现了一个伴生的姐弟虚频，我们又得继续消下去。本节简单介绍一个结构优化时消虚频的小脚本。主要是根据虚频的振动方向将体系中对应原子的坐标进行微调，然后用于重新优化。</p>
<p>简单介绍下原理，先看下VASP的OUTCAR中虚频对应的部分，</p>
<p>1）7220行带有<code>f/i</code>说明有虚频存在，</p>
<p>2） <code>X, Y, Z</code>为体系中原子的坐标，也就是<code>POSCAR</code>中的内容。</p>
<p>3） <code>dx, dy,dz</code>为虚频对应的原子振动方向上的位移。</p>
<p>4）我们将<code>（dx, dy,dz）</code>这个位移乘以一个介于0-1之间的校正因子，然后跟POSCAR中的坐标加起来即可。</p>
<p>5）以z方向为例，校正因子设为0.1，微调后的z方向坐标为： <code>10.709980</code> + <code>（-0.676634）</code> $\times$ <code>0.1</code>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">7219</span><br><span class="line">7220    3 f/i=    9.313471 THz    58.518262 2PiTHz  310.663930 cm-1    38.517432 meV</span><br><span class="line">7221              X         Y         Z           dx          dy          dz</span><br><span class="line">7222       6.003159 11.629641  6.067545            0           0           0</span><br><span class="line">7223       7.651085  3.894943  9.628260            0           0           0</span><br><span class="line">7224       2.424442  5.785382  9.658882            0           0           0</span><br><span class="line">7225       5.384679  7.755200  0.000000            0           0           0</span><br><span class="line">7226       0.004928  9.643165  0.000000            0           0           0</span><br><span class="line">7227       8.286347  7.755200  0.877073            0           0           0</span><br><span class="line">7228       2.944132  9.643165  0.971480            0           0           0</span><br><span class="line">7229       6.823299  9.643165  1.459420            0           0           0</span><br><span class="line">7230       1.481083  7.755200  1.553827            0           0           0</span><br><span class="line">7231       4.619917  7.755200  2.336493            0           0           0</span><br><span class="line">7232       9.762503  9.643165  2.430900            0           0           0</span><br><span class="line">7233       6.756153  7.724844  3.627352            0           0           0</span><br><span class="line">7234       1.491401  9.684490  3.647528            0           0           0</span><br><span class="line">7235       8.239374  9.666853  5.136018            0           0           0</span><br><span class="line">7236       3.012611  7.740104  5.091365            0           0           0</span><br><span class="line">7237       6.016826  7.737975  6.049788            0           0           0</span><br><span class="line">7238       0.788563  9.668849  6.080188            0           0           0</span><br><span class="line">7239       8.321833  7.730633  7.184644            0           0           0</span><br><span class="line">7240       3.081015  9.671865  7.187374            0           0           0</span><br><span class="line">7241       0.815711  7.728916  8.180983            0           0           0</span><br><span class="line">7242       6.063762  9.648841  8.115270            0           0           0</span><br><span class="line">7243       9.839838  9.660462  8.962566            0           0           0</span><br><span class="line">7244       4.631258  7.730218  9.011537            0           0           0</span><br><span class="line">7245       7.668770  7.725888  9.623941            0           0           0</span><br><span class="line">7246       2.424191  9.657803  9.623832            0           0           0</span><br><span class="line">7247       2.095436  3.874640 10.694551            0           0           0</span><br><span class="line">7248       0.099192 11.590822 10.709980    -0.736317    0.002031   -0.676634</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>脚本内容 (命名为： <code>vib_correct.py</code> )</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Qiang Li</span></span><br><span class="line"><span class="string">Command: python3 vib_correct.py </span></span><br><span class="line"><span class="string">This is a temporary script file.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> ase.io <span class="keyword">import</span> read, write</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取虚频开始行</span></span><br><span class="line">l_position = <span class="number">0</span>  <span class="comment">#虚频振动方向部分在OUTCAR中的起始行数</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;OUTCAR&#x27;</span>) <span class="keyword">as</span> f_in:</span><br><span class="line">    lines = f_in.readlines()</span><br><span class="line">    wave_num = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> num, line <span class="keyword">in</span> <span class="built_in">enumerate</span>(lines):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;f/i&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">            wave_tem = <span class="built_in">float</span>(line.rstrip().split()[<span class="number">6</span>])</span><br><span class="line">            <span class="keyword">if</span> wave_tem &gt; wave_num: <span class="comment">#获取最大的虚频</span></span><br><span class="line">                wave_num = wave_tem</span><br><span class="line">                l_position = num+<span class="number">2</span></span><br><span class="line"><span class="comment"># ASE读POSCAR</span></span><br><span class="line">model = read(<span class="string">&#x27;POSCAR&#x27;</span>)</span><br><span class="line">model_positions = model.get_positions()</span><br><span class="line">num_atoms = <span class="built_in">len</span>(model)</span><br><span class="line"><span class="comment">#print(model_positions)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取虚频对应的OUTCAR部分 </span></span><br><span class="line">vib_lines = lines[l_position:l_position + num_atoms] <span class="comment">#振动部分 7222到7248行</span></span><br><span class="line"><span class="comment">#print(vib_lines)</span></span><br><span class="line">vib_dis = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> vib_lines:</span><br><span class="line">    <span class="comment">#model_positions = [float(i) for i in line.rstrip().split()[:3]]</span></span><br><span class="line">    vib_infor = [<span class="built_in">float</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> line.rstrip().split()[<span class="number">3</span>:]] <span class="comment"># dx， dy， dz对应的那三列</span></span><br><span class="line">    vib_dis.append(vib_infor)</span><br><span class="line">vib_dis = np.array(vib_dis) <span class="comment">#将振动部分写到一个array中。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 微调结构</span></span><br><span class="line">new_positions = model_positions + vib_dis * <span class="number">0.4</span> <span class="comment"># 0.4是微调的校正因子，即虚频对应振动位移的0.4，具体多大自己根据经验调。</span></span><br><span class="line">model.positions = new_positions</span><br><span class="line"></span><br><span class="line"><span class="comment">###保存结构</span></span><br><span class="line">write(<span class="string">&#x27;POSCAR_new&#x27;</span>, model, vasp5=<span class="literal">True</span>) <span class="comment"># POSCAR_new是微调后的结构，用于下一步的计算（别忘了把POSCAR_new改成POSCAR）。</span></span><br></pre></td></tr></table></figure>



<p>脚本使用：</p>
<ol>
<li>脚本跟计算文件在同一个目录下：<code>python3  vib_correct.py </code></li>
</ol>
<ol start="2">
<li>如果赋予了脚本可执行权限，并放到了<code>~/bin</code>目录下，直接运行：<code> vib_correct.py</code> 命令即可得到校正后的结构文件：<code>POSCAR_new</code>。</li>
<li>重新计算的时候，新建一个文件夹，把<code>POSCAR_new</code> 复制到文件夹里面，记得把名字改成<code>POSCAR</code>。</li>
<li>这个脚本只适用于普通结构优化时候的虚频。如果过渡态计算的时候出现好几个虚频，不要使用这个脚本，因为脚本默认使用最大虚频对应的位移进行校正。</li>
<li>不用ASE，自己直接写个<code>python</code>脚本也能实现。不过使用ASE可以很方便地获取<code>POSCAR</code>中原子数目，保存原子固定的信息。参考如下。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Qiang Li</span></span><br><span class="line"><span class="string">Command: python3 vib_correct.py</span></span><br><span class="line"><span class="string">This is a temporary script file.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取虚频开始行</span></span><br><span class="line">l_position = <span class="number">0</span>  <span class="comment">#虚频振动方向部分在OUTCAR中的起始行数</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;OUTCAR&#x27;</span>) <span class="keyword">as</span> f_in:</span><br><span class="line">    lines = f_in.readlines()</span><br><span class="line">    wave_num = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> num, line <span class="keyword">in</span> <span class="built_in">enumerate</span>(lines):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;f/i&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">            wave_tem = <span class="built_in">float</span>(line.rstrip().split()[<span class="number">6</span>])</span><br><span class="line">            <span class="keyword">if</span> wave_tem &gt; wave_num: <span class="comment">#获取最大的虚频</span></span><br><span class="line">                wave_num = wave_tem</span><br><span class="line">                l_position = num+<span class="number">2</span></span><br><span class="line"><span class="comment"># 读POSCAR</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;POSCAR&#x27;</span>) <span class="keyword">as</span> f_pos:</span><br><span class="line">    lines_pos = f_pos.readlines()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取虚频对应的OUTCAR部分    </span></span><br><span class="line">num_atoms = <span class="built_in">sum</span>([<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> lines_pos[<span class="number">6</span>].rstrip().split()])</span><br><span class="line">vib_lines = lines[l_position:l_position + num_atoms] <span class="comment">#振动部分 7222到7248行</span></span><br><span class="line"></span><br><span class="line">model_positions = []</span><br><span class="line">vib_dis = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> vib_lines:</span><br><span class="line">    position = [<span class="built_in">float</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> line.rstrip().split()[:<span class="number">3</span>]]</span><br><span class="line">    vib_infor = [<span class="built_in">float</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> line.rstrip().split()[<span class="number">3</span>:]] <span class="comment"># dx， dy， dz对应的那三列</span></span><br><span class="line">    model_positions.append(position)</span><br><span class="line">    vib_dis.append(vib_infor)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 微调结构</span></span><br><span class="line">model_positions = np.array(model_positions)</span><br><span class="line">vib_dis = np.array(vib_dis) <span class="comment">#将振动部分写到一个array中。</span></span><br><span class="line">new_positions = model_positions + vib_dis * <span class="number">0.4</span> <span class="comment"># 0.4是微调的校正因子，即虚频对应振动位移的0.4，具体多大自己根据经验调。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###保存结构</span></span><br><span class="line">f_out = <span class="built_in">open</span>(<span class="string">&#x27;POSCAR_new&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f_out.writelines(lines_pos[:<span class="number">8</span>])</span><br><span class="line">f_out.write(<span class="string">&#x27;Cartesian\n&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> new_positions:</span><br><span class="line">    f_out.write(<span class="string">&#x27; &#x27;</span>.join([<span class="built_in">str</span>(coord) <span class="keyword">for</span> coord <span class="keyword">in</span> i]) + <span class="string">&#x27;  F  F  F\n&#x27;</span>)</span><br><span class="line">f_out.close()</span><br></pre></td></tr></table></figure>



<p><img src="/2022/04/29/A29/qrcode.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2022/04/04/A28/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/04/A28/" class="post-title-link" itemprop="url">通过ASE获取原子之间的距离</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-04 00:30:16" itemprop="dateCreated datePublished" datetime="2022-04-04T00:30:16-04:00">2022-04-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-04-29 23:17:22" itemprop="dateModified" datetime="2022-04-29T23:17:22-04:00">2022-04-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2022/04/04/A28/" class="post-meta-item leancloud_visitors" data-flag-title="通过ASE获取原子之间的距离" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2022/04/04/A28/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022/04/04/A28/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="通过ASE获取原子之间的距离"><a href="#通过ASE获取原子之间的距离" class="headerlink" title="通过ASE获取原子之间的距离"></a>通过ASE获取原子之间的距离</h2><p>原子之间的距离是计算化学中模型搭建，结果分析中经常需要分析的部分。而计算原子的之间的距离也非常简单，通过可视化软件直接点两个原子就可以直接显示出来，可以通过自写的一些小脚本来实现。跟均相的体系不同，周期性体系由于周期性边界的存在，有时候模型中两个原子之间的距离需要将周期性边界条件考虑进去才能正确得到。今天简单介绍一个通过ASE获取原子之间的距离，并且考虑周期性边界条件的影响的小脚本。</p>
<h4 id="具体例子展示一下："><a href="#具体例子展示一下：" class="headerlink" title="具体例子展示一下："></a>具体例子展示一下：</h4><p>图里面是$TiO{_2}(101)$表面上吸附的一个Pt单原子模型，如果直接计算Pt和Ti之间距离的话（图1），测量一下为 7.461 $\AA$。实际上我们把slab模型沿着y轴重复下就会发现，还有一个更短的Pt-Ti距离。</p>
<p><img src="/2022/04/04/A28/1.png"></p>
<p>图1： Pt-Ti原子之间的距离</p>
<p>测量下，距离为：3.818 $\AA$。在周期性计算中，如果刚开始模型搭建的时候没有考虑到这一点，或者分子比较大，亦或者AIMD过程中分子到处跑，都会出现类似这样的情形。所以在测量距离时候，要注意周期性边界对数值的影响。当然最理想的情况就是模型搭建的时候将这一情况考虑进来，尽可能将分子放在slab的中间部分。如果出现这种情况，测量的时候加上周期性边界条件的校正即可，这也是本节要介绍的内容。</p>
<p><img src="/2022/04/04/A28/2.png"></p>
<p>图2：考虑周期性边界条件后Pt-Ti之间的距离</p>
<p>首先我们看下体系的坐标，在<code>p4vasp</code>的界面中，<code>POSCAR</code>中每个原子对应着不同的序号（序号是从<code>1</code>开始的），比如：Pt在POSCAR中是第109号原子，前面测量的Pt-Ti距离就是109号和23号原子之间的距离。计算两点之间的距离公式相信大家初高中的时候已经学过了。过程很简单（参考下面脚本中注释掉的部分。）：1）获取两个原子之间的坐标； 2）套公式得到距离。本节介绍通过ASE写个小脚本获取两个原子之间的距离。</p>
<p><img src="/2022/04/04/A28/3.png"></p>
<p>图3：p4vasp中原子的序号</p>
<h4 id="脚本内容"><a href="#脚本内容" class="headerlink" title="脚本内容"></a>脚本内容</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Created on Fri Apr 22 10:06:51 2022</span></span><br><span class="line"><span class="string">@author: qli</span></span><br><span class="line"><span class="string">Command: python3 get_dis_AB.py  atom_A_index atom_B_index</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> ase.io <span class="keyword">import</span> read, write</span><br><span class="line"><span class="keyword">import</span> os, sys</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Important Note: Atoms are indexed from 0.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">atom_A, atom_B = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> sys.argv[<span class="number">1</span>:<span class="number">3</span>]]</span><br><span class="line">model = read(<span class="string">&#x27;POSCAR&#x27;</span>)</span><br><span class="line">positions = model.get_positions()</span><br><span class="line">dis_AB_1 = model.get_distance(atom_A, atom_B, mic=<span class="literal">True</span>)</span><br><span class="line">dis_AB_2 = model.get_distance(atom_A, atom_B, mic=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">round</span>(dis_AB_1, <span class="number">4</span>), <span class="string">&#x27;\t&#x27;</span>,<span class="built_in">round</span>(dis_AB_2,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">## Not Used </span></span><br><span class="line"><span class="comment">#coord_A = positions[atom_A]</span></span><br><span class="line"><span class="comment">#coord_B = positions[atom_B]</span></span><br><span class="line"><span class="comment">#dis_AB = np.linalg.norm(coord_A-coord_B)</span></span><br><span class="line"><span class="comment">#print(round(dis_AB,4))                     </span></span><br></pre></td></tr></table></figure>

<ol>
<li>atom_A，和 atom_B 是要测量的2个原子，<code>注意：ASE中原子的序号是从0开始的</code>，所以上面的例子中，Ti和Pt在ASE中则是22和108号原子。</li>
<li>脚本里面读的是<code>POSCAR</code>，根据自己的需求改成<code>CONTCAR</code>或者其他的带有坐标的文件。</li>
<li><code>mic=True</code> 考虑周期性边界的影响。<code>mic=False</code> 则是直接测量两个原子的距离。</li>
<li>最后面注释的几行是获取原子坐标，通过<code>numpy</code>计算距离的例子，效果等于前面<code>mic=False</code>.</li>
<li>脚本使用的命令：<code>python3 get_dis_AB.py  22 108 </code></li>
</ol>
<h4 id="脚本效果："><a href="#脚本效果：" class="headerlink" title="脚本效果："></a>脚本效果：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbro:~/Desktop/example$ python3 get_dis_AB.py  22 108</span><br><span class="line">3.8175 	 7.4611</span><br></pre></td></tr></table></figure>

<h4 id="改进下输出格式"><a href="#改进下输出格式" class="headerlink" title="改进下输出格式"></a>改进下输出格式</h4><p>将前面脚本中<code>print</code>的一行删掉，换成下面的即可，反正数值已经在这里了，怎么输出根据自己爱好，把print对应的效果改改即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Atom_A\tAtom_B\tdis_A-B&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;%s\t%s\t%.4f&#x27;</span> %(atom_A, atom_B, dis_AB_1))</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbro:~/Desktop/example$ python3 get_dis_AB.py  22 108</span><br><span class="line">Atom_A Atom_B	dis_A-B</span><br><span class="line">22	108	3.8175</span><br></pre></td></tr></table></figure>

<h4 id="放到-bin目录下，随时可以使用："><a href="#放到-bin目录下，随时可以使用：" class="headerlink" title="放到~/bin目录下，随时可以使用："></a>放到<code>~/bin</code>目录下，随时可以使用：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbro:~/Desktop/example$ chmod u+x get_dis_AB.py </span><br><span class="line">qli@bigbro:~/Desktop/example$ mv get_dis_AB.py  ~/bin/</span><br><span class="line">qli@bigbro:~/Desktop/example$ ls</span><br><span class="line">POSCAR</span><br><span class="line">qli@bigbro:~/Desktop/example$ get_dis_AB.py  22 108 </span><br><span class="line">Atom_A	Atom_B	dis_A-B</span><br><span class="line">22	108	3.8175</span><br></pre></td></tr></table></figure>

<p>没有<code>~/bin</code>的话，自己创建一个即可：<code>mkdir ~/bin</code></p>
<p>有兴趣的也可以自己尝试着解决周期性边界条件对计算两原子之间距离的影响，GitHub上也有很多类似的代码。也欢迎大家分享自己的代码或者链接；可以发送到我的邮箱：<code>lqcata@gmail.com</code>或者直接Q:<code>122103465</code>，微信：<code>BigBroSci</code> 联系。</p>
<p><img src="/2022/04/04/A28/qrcode.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2021/12/26/S07/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/12/26/S07/" class="post-title-link" itemprop="url">Ipad 连接服务器APP</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-12-26 19:30:16" itemprop="dateCreated datePublished" datetime="2021-12-26T19:30:16-05:00">2021-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-28 01:29:18" itemprop="dateModified" datetime="2021-12-28T01:29:18-05:00">2021-12-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Share/" itemprop="url" rel="index"><span itemprop="name">Share</span></a>
        </span>
    </span>

  
    <span id="/2021/12/26/S07/" class="post-meta-item leancloud_visitors" data-flag-title="Ipad 连接服务器APP" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2021/12/26/S07/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/12/26/S07/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在ipad，手机上运行终端，连接服务器可以让我们随时随地查看，提交任务。在这里推荐一款ipad和iphone上的终端APP: SSHaking。如果你用的安卓系统，一些推荐的APP可以直接到文章底部去找。<br>先依照个人使用的经验，列出来以下SSHaking的优点：</p>
<p>1） 界面简洁，没广告；</p>
<p>2） 可以同时打开好几个terminal界面；</p>
<p>3）连接服务器设置也很简单；</p>
<p>4） 支持连接多个Hosts； （平时常用的terminus只支持一个，连多个的话要花钱，服务器如果只有一个，也推荐terminus）</p>
<p>5） 免费！！！！</p>
<p>6）APP的开发者很牛，可能也很帅！</p>
<p>7）希望大家多多下载这款APP，有什么bug及时给作者提出来，而且作者看到后修复的也很及时。</p>
<p>如果你用的是安卓系统，可以有以下几个选择：</p>
<p>1） juiceSSH (轻和浅吟🐳)<br>2） Admin hands (HeyTamas)</p>
<p>括号里是提供APP名字的好心人。如果你也有推荐的其他好用的APP(免费的)，可以在微信公众号留言。</p>
<p> <img src="/2021/12/26/S07/F00/QR_code.jpeg" alt=""></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/jvghzIlV6NOsNFjUa445xQ">https://mp.weixin.qq.com/s/jvghzIlV6NOsNFjUa445xQ</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2021/01/01/A27/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/01/01/A27/" class="post-title-link" itemprop="url">从Citrine Informatics数据库获取数据</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-01 00:30:16" itemprop="dateCreated datePublished" datetime="2021-01-01T00:30:16-05:00">2021-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2021/01/01/A27/" class="post-meta-item leancloud_visitors" data-flag-title="从Citrine Informatics数据库获取数据" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2021/01/01/A27/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/01/01/A27/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Citrine 也是一个材料学数据库，自带了机器学习工具，大家也可以研究琢磨一下。官网是 <a target="_blank" rel="noopener" href="https://citrination.com/search/simple?searchMatchOption=fuzzyMatch。这里，我们将通过几个例子了解如何在这个数据库中获取数据。在Citrine中获取数据需要用到">https://citrination.com/search/simple?searchMatchOption=fuzzyMatch。这里，我们将通过几个例子了解如何在这个数据库中获取数据。在Citrine中获取数据需要用到</a> matminer.data_retrieval.retrieve_Citrine.CitrineDataRetrieval 这个工具，其跟materials project类似，也学要一个API_key。大家可以在官网注册，并记录下API_Key。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#请先在终端中输入： pip install citrination_client ； 否则会报错</span></span><br><span class="line"><span class="comment">#然后我们回到代码，导入 CitrineDataRetrieval 这个模块</span></span><br><span class="line"><span class="keyword">from</span> matminer.data_retrieval.retrieve_Citrine <span class="keyword">import</span> CitrineDataRetrieval</span><br></pre></td></tr></table></figure>
<h4 id="示例1：获取化学式为-Si-的所有材料的实验测得的能带"><a href="#示例1：获取化学式为-Si-的所有材料的实验测得的能带" class="headerlink" title="示例1：获取化学式为 Si 的所有材料的实验测得的能带"></a>示例1：获取化学式为 Si 的所有材料的实验测得的能带</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先实例化这个工具，需要提供你的API_Key</span></span><br><span class="line">cdr = CitrineDataRetrieval(api_key=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 接下来，类似从materials project获取数据，我们需要用get_dataframe函数</span></span><br><span class="line">df = cdr.get_dataframe(criteria=&#123;<span class="string">&#x27;formula&#x27;</span>:<span class="string">&#x27;Si&#x27;</span>, <span class="string">&#x27;data_type&#x27;</span>: <span class="string">&#x27;EXPERIMENTAL&#x27;</span>&#125;, </span><br><span class="line">                       properties=[<span class="string">&#x27;Band gap&#x27;</span>],</span><br><span class="line">                       secondary_fields=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  0%|                                                                                            | 0/7 [00:00&lt;?, ?it/s]d:\programs\anaconda3\envs\py36\lib\site-packages\matminer\data_retrieval\retrieve_Citrine.py:103: FutureWarning:</span><br><span class="line"></span><br><span class="line">pandas.io.json.json_normalize is deprecated, use pandas.json_normalize instead</span><br><span class="line"></span><br><span class="line">100%|████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00&lt;00:00, 87.33it/s]</span><br><span class="line"></span><br><span class="line">all available fields:</span><br><span class="line">[<span class="string">&#x27;Band gap&#x27;</span>, <span class="string">&#x27;uid&#x27;</span>, <span class="string">&#x27;Band gap-units&#x27;</span>, <span class="string">&#x27;category&#x27;</span>, <span class="string">&#x27;references&#x27;</span>, <span class="string">&#x27;chemicalFormula&#x27;</span>, <span class="string">&#x27;Crystallinity&#x27;</span>, <span class="string">&#x27;Band gap-conditions&#x27;</span>, <span class="string">&#x27;Band gap-methods&#x27;</span>, <span class="string">&#x27;Band gap-dataType&#x27;</span>]</span><br><span class="line"></span><br><span class="line">suggested common fields:</span><br><span class="line">[<span class="string">&#x27;references&#x27;</span>, <span class="string">&#x27;chemicalFormula&#x27;</span>, <span class="string">&#x27;Crystallinity&#x27;</span>, <span class="string">&#x27;Band gap&#x27;</span>, <span class="string">&#x27;Band gap-units&#x27;</span>, <span class="string">&#x27;Band gap-conditions&#x27;</span>, <span class="string">&#x27;Band gap-methods&#x27;</span>, <span class="string">&#x27;Band gap-dataType&#x27;</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df <span class="comment">#查看表格</span></span><br></pre></td></tr></table></figure>
<p><img src="/2021/01/01/A27/r1.png" alt=""></p>
<p>从上面结果可以看出，数据库里有化学式为Si的材料共7中实验测得的能带数据。这些数据来源的文献，带隙的值，实验方法都被记录了下来。</p>
<h4 id="示例2：获取材料对-OH-和-O物种的吸附能"><a href="#示例2：获取材料对-OH-和-O物种的吸附能" class="headerlink" title="示例2：获取材料对 OH 和 O物种的吸附能"></a>示例2：获取材料对 <em>OH 和 </em>O物种的吸附能</h4><p>想不到citrine数据库还有各种材料对<em>OH 和 </em>O 物种的吸附能，一起来看看怎么获取把。要查询更多的数据库，请探索官网<a target="_blank" rel="noopener" href="https://citrination.com/datasets">https://citrination.com/datasets</a> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 我们发现这里不需要指定筛选条件，只需要返回所需要的性质即可。</span></span><br><span class="line">df_OH = cdr.get_dataframe(criteria=&#123;&#125;, properties=[<span class="string">&#x27;adsorption energy of OH&#x27;</span>], secondary_fields=<span class="literal">True</span>)</span><br><span class="line">df_O = cdr.get_dataframe(criteria=&#123;&#125;, properties=[<span class="string">&#x27;adsorption energy of O&#x27;</span>], secondary_fields=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<pre><code>  0%|                                                                                            | 0/9 [00:00&lt;?, ?it/s]d:\programs\anaconda3\envs\py36\lib\site-packages\matminer\data_retrieval\retrieve_Citrine.py:103: FutureWarning:

pandas.io.json.json_normalize is deprecated, use pandas.json_normalize instead

100%|███████████████████████████████████████████████████████████████████████████████████| 9/9 [00:00&lt;00:00, 128.63it/s]


all available fields:
[&#39;uid&#39;, &#39;Adsorption energy of OH&#39;, &#39;Adsorption energy of OH-units&#39;, &#39;Morphology&#39;, &#39;Surface facet&#39;, &#39;category&#39;, &#39;references&#39;, &#39;chemicalFormula&#39;, &#39;Adsorption energy of OH-conditions&#39;, &#39;Adsorption energy of OH-dataType&#39;]

suggested common fields:
[&#39;references&#39;, &#39;chemicalFormula&#39;, &#39;Surface facet&#39;, &#39;Adsorption energy of OH&#39;, &#39;Adsorption energy of OH-units&#39;, &#39;Adsorption energy of OH-dataType&#39;, &#39;Morphology&#39;, &#39;Adsorption energy of OH-conditions&#39;]


100%|█████████████████████████████████████████████████████████████████████████████████| 21/21 [00:00&lt;00:00, 140.70it/s]

all available fields:
[&#39;uid&#39;, &#39;Surface facet&#39;, &#39;Adsorption energy of O&#39;, &#39;category&#39;, &#39;references&#39;, &#39;chemicalFormula&#39;, &#39;Reconstruction&#39;, &#39;Adsorption energy of O-units&#39;, &#39;Adsorption energy of O-conditions&#39;]

suggested common fields:
[&#39;references&#39;, &#39;chemicalFormula&#39;, &#39;Surface facet&#39;, &#39;Adsorption energy of O&#39;, &#39;Adsorption energy of O-units&#39;, &#39;Adsorption energy of O-conditions&#39;, &#39;Reconstruction&#39;]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_OH.head()</span><br></pre></td></tr></table></figure>
<p><img src="/2021/01/01/A27/r2.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_O.head()</span><br></pre></td></tr></table></figure>
<p><img src="/2021/01/01/A27/r3.png" alt=""></p>
<p>大家可以看到，这些数据库里面的数据还不够丰富。大家也可以把自己计算得到的数据上传到citrine数据库中，促进科学知识的开放获取。</p>
<ul>
<li>实际上 citrine 数据库包含了很多实验数据，下次的分享中，我们会把citrine数据库中的实验数据和materials project中的计算数据做个对比。</li>
<li>强烈推荐大家在学习的时候使用jupyter notebook。</li>
<li>附上jupyter notebook文件共大家参考：【链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1W1XKj-Fnjmx1yIe2QB7_MQ">https://pan.baidu.com/s/1W1XKj-Fnjmx1yIe2QB7_MQ</a> 提取码：jvoi 】</li>
</ul>
<p>本次分享到此结束。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2020/12/22/A26/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/22/A26/" class="post-title-link" itemprop="url">利用matminer从数据库获取数据</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-22 00:30:16" itemprop="dateCreated datePublished" datetime="2020-12-22T00:30:16-05:00">2020-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2020/12/22/A26/" class="post-meta-item leancloud_visitors" data-flag-title="利用matminer从数据库获取数据" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/12/22/A26/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/22/A26/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://nbviewer.jupyter.org/github/hackingmaterials/matminer_examples/blob/master/matminer_examples/data_retrieval-nb/data_retrieval_basics.ipynb">https://nbviewer.jupyter.org/github/hackingmaterials/matminer_examples/blob/master/matminer_examples/data_retrieval-nb/data_retrieval_basics.ipynb</a></p>
<h2 id="从Materials-Project-数据库获取"><a href="#从Materials-Project-数据库获取" class="headerlink" title="从Materials Project 数据库获取"></a>从Materials Project 数据库获取</h2><p>从Materials Project数据库获取数据得用到 matminer.data_retrieval.retrieve_MP.MPDataRetrieval 功能。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首先导入模块</span></span><br><span class="line"><span class="keyword">from</span> matminer.data_retrieval.retrieve_MP <span class="keyword">import</span> MPDataRetrieval</span><br><span class="line"><span class="comment"># 实例化 MPDataRetrieval 这个类</span></span><br><span class="line">mpdr = MPDataRetrieval(api_key=<span class="string">&#x27;your_own_api_key&#x27;</span>) </span><br><span class="line"><span class="comment"># 在实例化 MPDataRetrieval 时需要输入用户在 Material Project 网站的 API Key.</span></span><br></pre></td></tr></table></figure>
<h2 id="示例1：获取所有单元素材料的密度"><a href="#示例1：获取所有单元素材料的密度" class="headerlink" title="示例1：获取所有单元素材料的密度"></a>示例1：获取所有单元素材料的密度</h2><p>上一次的介绍说到，matminer 处理的数据跟 pandas 库一样，是 dataframe，所以我们要用 get_dataframe 方法获取数据; dataframe 看起来就像excel 表格一样。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = mpdr.get_dataframe(criteria=&#123;<span class="string">&quot;nelements&quot;</span>: <span class="number">1</span>&#125;, properties=[<span class="string">&#x27;density&#x27;</span>, <span class="string">&#x27;pretty_formula&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;There are &#123;&#125; entries on MP with 1 element&quot;</span>.<span class="built_in">format</span>(df[<span class="string">&#x27;density&#x27;</span>].count())) <span class="comment"># 计算有多少材料</span></span><br><span class="line"><span class="comment">#请自行关注 df[&#x27;density&#x27;].count() 语句</span></span><br></pre></td></tr></table></figure>
<p>criteria 是搜索条件，它是一个字典，字典里面可以有多个键值对; properties 是想要获取的材料性质，它是个列表，里面可以有多个性质。其实criteria 也是材料的性质。想知道所有可用的性质，请参考 <a target="_blank" rel="noopener" href="https://github.com/materialsproject/pymatgen/blob/master/pymatgen/ext/matproj.py">https://github.com/materialsproject/pymatgen/blob/master/pymatgen/ext/matproj.py</a></p>
<p>上述代码意味着 我们想在数据库中搜索材料，这些材料元素种类为1，对于这些材料，我们想得到它们的密度和化学式信息。</p>
<p>结果如下：</p>
<p><img src="/2020/12/22/A26/re1.png" style="zoom:80%;"></p>
<p>让我们看一下这个 dataframe 表格长什么样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.head()  <span class="comment"># 这个语句会显示 df 这个表格的前几行，可以看到，我们获得了 716 个单元素材料。</span></span><br><span class="line">           <span class="comment"># 表格里记录了我们需要的密度 和 化学式的性质，以及它们的ID</span></span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<p><img src="/2020/12/22/A26/re2.png" style="zoom: 80%;"></p>
<h3 id="示例2：获取所有带隙大于-4-0-eV的材料"><a href="#示例2：获取所有带隙大于-4-0-eV的材料" class="headerlink" title="示例2：获取所有带隙大于 4.0 eV的材料"></a>示例2：获取所有带隙大于 4.0 eV的材料</h3><p>方法挺简单的，就是在上个例子的 get_dataframe 方法中设置新的搜索条件: 带隙大于4.0 eV.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 带隙是 band_gap，大于4怎么写呢？ 是 greater than, 缩写成 gt. 在 matminer中要写成 $gt </span></span><br><span class="line"><span class="comment"># 大家注意体会 criteria 的字典形式。criteria=, properties= 可以省略不写。</span></span><br><span class="line">df = mpdr.get_dataframe(&#123;<span class="string">&quot;band_gap&quot;</span>: &#123;<span class="string">&quot;$gt&quot;</span>: <span class="number">4.0</span>&#125;&#125;, [<span class="string">&#x27;pretty_formula&#x27;</span>, <span class="string">&#x27;band_gap&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;There are &#123;&#125; entries on MP with a band gap larger than 4.0&quot;</span>.<span class="built_in">format</span>(df[<span class="string">&#x27;band_gap&#x27;</span>].count()))</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<p><img src="/2020/12/22/A26/re3.png" style="zoom:80%;"></p>
<p>再看一下表格长什么样子</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<p><img src="/2020/12/22/A26/re4.png" style="zoom:80%;"></p>
<p>如果想把表格保存成excel可读写的格式，可以用下面的语句：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.to_csv(<span class="string">&#x27;materials_bg_gt_4.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="示例3：获取-VRH-剪切模量和体积模量¶"><a href="#示例3：获取-VRH-剪切模量和体积模量¶" class="headerlink" title="示例3：获取 VRH 剪切模量和体积模量¶"></a>示例3：获取 VRH 剪切模量和体积模量<a target="_blank" rel="noopener" href="http://localhost:8888/notebooks/get_data_from_pymatgen.ipynb#示例3：获取-VRH-剪切模量和体积模量">¶</a></h3><p>首先得要求这些材料存在弹性的性质，其次，我们还想要求这些弹性数据没有警告信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存在弹性常数信息用 &quot;elasticity&quot;: &#123;&quot;$exists&quot;: True&#125; 表示，没有警告信息用 一个空列表表示：&quot;elasticity.warnings&quot;: []</span></span><br><span class="line"></span><br><span class="line">df = mpdr.get_dataframe(&#123;<span class="string">&quot;elasticity&quot;</span>: &#123;<span class="string">&quot;$exists&quot;</span>: <span class="literal">True</span>&#125;, <span class="string">&quot;elasticity.warnings&quot;</span>: []&#125;,</span><br><span class="line">                        [<span class="string">&#x27;pretty_formula&#x27;</span>, <span class="string">&#x27;elasticity.K_VRH&#x27;</span>, <span class="string">&#x27;elasticity.G_VRH&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;There are &#123;&#125; elastic entries on MP with no warnings&quot;</span>.<span class="built_in">format</span>(df[<span class="string">&#x27;elasticity.K_VRH&#x27;</span>].count()))</span><br></pre></td></tr></table></figure>
<p>搜索结果如下：</p>
<p><img src="/2020/12/22/A26/r5.png" style="zoom:80%;"></p>
<p>我们想统计一下这些数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe() <span class="comment"># 该语句可以很方便地对表格中的每一列数据进行统计，给出数量，平均数，方差，最小、最大值等信息</span></span><br></pre></td></tr></table></figure>
<p>得到：</p>
<p><img src="/2020/12/22/A26/r6.png" style="zoom:80%;"></p>
<p><strong>接下来看一个更复杂的例子</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">除了上次的搜索条件外，我们想搜索包含 Pb 和 Te 的材料：&quot;elements&quot;: &#123;&quot;$all&quot;: [&quot;Pb&quot;, &quot;Te&quot;]&#125; </span></span><br><span class="line"><span class="string">材料的稳定性也在考虑之中，energy above hull 必须在1e-6以下：&quot;e_above_hull&quot;: &#123;&quot;$lt&quot;: 1e-6&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">df = mpdr.get_dataframe(criteria=&#123;<span class="string">&quot;elasticity&quot;</span>: &#123;<span class="string">&quot;$exists&quot;</span>: <span class="literal">True</span>&#125;, </span><br><span class="line">                         <span class="string">&quot;elasticity.warnings&quot;</span>: [],</span><br><span class="line">                         <span class="string">&quot;elements&quot;</span>: &#123;<span class="string">&quot;$all&quot;</span>: [<span class="string">&quot;Pb&quot;</span>, <span class="string">&quot;Te&quot;</span>]&#125;,</span><br><span class="line">                         <span class="string">&quot;e_above_hull&quot;</span>: &#123;<span class="string">&quot;$lt&quot;</span>: <span class="number">1e-6</span>&#125;&#125;, <span class="comment"># to limit the number of hits for the sake of time</span></span><br><span class="line">                        properties = [<span class="string">&quot;elasticity.K_VRH&quot;</span>, <span class="string">&quot;elasticity.G_VRH&quot;</span>, <span class="string">&quot;pretty_formula&quot;</span>, </span><br><span class="line">                                      <span class="string">&quot;e_above_hull&quot;</span>, <span class="string">&quot;bandstructure&quot;</span>, <span class="string">&quot;dos&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;There are &#123;&#125; elastic entries on MP with no warnings that contain &quot;</span></span><br><span class="line">      <span class="string">&quot;Pb and Te with energy above hull ~ 0.0 eV&quot;</span>.<span class="built_in">format</span>(df[<span class="string">&#x27;elasticity.K_VRH&#x27;</span>].count()))</span><br></pre></td></tr></table></figure>
<p>结果是：</p>
<p>There are 3 elastic entries on MP with no warnings that contain Pb and Te with energy above hull ~ 0.0 eV</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/12/22/A26/r7.png" alt=""></p>
<p>下面来查看一下其中一个材料的能带和DOS图</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pymatgen.electronic_structure.plotter <span class="keyword">import</span> BSDOSPlotter <span class="comment"># 调用 Pymatgen 作图</span></span><br><span class="line"></span><br><span class="line">mpid = <span class="string">&#x27;mp-20740&#x27;</span></span><br><span class="line">idx = df.index[df.index==mpid][<span class="number">0</span>]  <span class="comment"># 获取 mp-20740 这个材料所在的行数</span></span><br><span class="line">plt = BSDOSPlotter().get_plot(bs=df.loc[idx, <span class="string">&#x27;bandstructure&#x27;</span>], dos=df.loc[idx, <span class="string">&#x27;dos&#x27;</span>]);</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/12/22/A26/r8.png" style="zoom:80%;"></p>
<h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><ul>
<li><p>matminer获得的数据(本教程保存在 df 变量中)可以可视化，也可以直接用来做机器学习。有兴趣的同学请自学 pandas 这个 python 库，学习 dataframe 数据的处理方法。</p>
</li>
<li><p>Pymatgen 做的能带和DOS图不够美观。大家可以留言，我有机会可以跟大家分享修改pymatgen代码来美化这些图。</p>
</li>
<li><p>官网的教程是基于 jupyter notebook的。jupyter notebook 的好处是既能运行代码，又能自由地给代码加注释，公式，图片。所得到的文档便于阅读和理解。希望大家也能学会这个python 库。</p>
</li>
<li><p>如果想调用 jupyter notebook来运行上述代码，建议大家在具有图形界面的终端上试验。以windows 系统为例，再按照上篇教程创建好 py36 虚拟环境后，需要</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install jupyter <span class="comment"># 具体的使用方法请参考其它网络教程</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>本文还附带jupyter notebook 版本的文档供大家阅读和使用 【链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/153PcfiM3vaAG71MCCTFuCQ">https://pan.baidu.com/s/153PcfiM3vaAG71MCCTFuCQ</a><br>提取码：w4us 】</p>
</li>
</ul>
<p>本次的教程到这就结束了。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2020/12/16/A25/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/16/A25/" class="post-title-link" itemprop="url">超好用的材料类机器学习开源软件-Matminer</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-16 00:30:16" itemprop="dateCreated datePublished" datetime="2020-12-16T00:30:16-05:00">2020-12-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2020/12/16/A25/" class="post-meta-item leancloud_visitors" data-flag-title="超好用的材料类机器学习开源软件-Matminer" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/12/16/A25/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/12/16/A25/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>今天向大家隆重介绍一款材料类的机器学习开源软件：Matminer！机器学习预测材料性质，乃至逆向设计材料是材料领域的热门研究话题。很多同学有心做机器学习方面的研究，奈何不知道有哪些实用的代码，从而使项目一拖再拖。材料类的机器学习软件有很多，我比较喜欢Matminer这一款，因为它是由Pymatgen开发者开发的，非常易于使用。现在就向大家介绍一下这款软件（本教程根据Matminer官网<a target="_blank" rel="noopener" href="https://hackingmaterials.lbl.gov/matminer/#installing-matminer撰写）">https://hackingmaterials.lbl.gov/matminer/#installing-matminer撰写）</a></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Matminer是用于材料数据挖掘的基于Python的开源软件。它可以从各种数据库获取材料属性数据，将复杂材料属性(如成分、晶体结构、能带结构)表征为与物理相关的特征量，训练机器学习模型，并分析数据挖掘的结果。</p>
<p>Matminer使用pandas数据格式。它还有一个进阶的自动化版本叫Automatminer，可以自动化的训练机器学习模型并得到结果。</p>
<p>Matminer 可以生产可交互的图像。下面的流程图生动展示了matminer的工作内容。Matminer 可以访问Citrine，Materials Project，MDF等数据库，获得材料结构、能带、力学性能等多种性质。这些性质可以被转换成数值化的、可视化的特征量，该特征量可以被用于训练机器学习模型。</p>
<p><img src="/2020/12/16/A25/A25.png" alt=""></p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>Matminer的安装过程非常简单，大家只要安装好Anaconda3 (Python 3.6) 后，在终端输入 pip install matminer 就行了。建议大家一并安装Pymatgen。</p>
<p>下面以天河超算为例，展示matminer的安装过程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建基于python 3.6 的虚拟环境，名字叫 py36</span></span><br><span class="line">(base) [test@ln0%tianhe2 ~]$ conda create -n py36 python=<span class="number">3.6</span></span><br></pre></td></tr></table></figure>
<p>安装好环境后，激活该环境，并安装pymatgen 和 matminer</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 激活环境用conda activate 命令</span></span><br><span class="line">(base) [test@ln0%tianhe2 ~]$ conda activate py36</span><br><span class="line"></span><br><span class="line"><span class="comment"># 括号里的 base 就会变成 py36</span></span><br><span class="line">(py36) [test@ln0%tianhe2 ~]$ conda install -c conda-forge pymatgen</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下面这个命令为安装 matminer</span></span><br><span class="line">(py36) [test@ln0%tianhe2 ~]$ pip install matminer</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>下面测试安装结果，输入下列命令，如果不出错，就是安装成功了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(py36) [test@ln0%tianhe2 ~]$ python</span><br><span class="line">Python <span class="number">3.6</span><span class="number">.12</span> |Anaconda, Inc.| (default, Sep  <span class="number">8</span> <span class="number">2020</span>, <span class="number">23</span>:<span class="number">10</span>:<span class="number">56</span>) </span><br><span class="line">[GCC <span class="number">7.3</span><span class="number">.0</span>] on linux</span><br><span class="line"><span class="type">Type</span> <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> <span class="keyword">or</span> <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pymatgen</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> matminer</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span></span><br></pre></td></tr></table></figure>
<p>现在可以尽情地去测试啦！后续教程将陆续分享。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2020/10/02/A24/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/10/02/A24/" class="post-title-link" itemprop="url">离子迁移概率密度可视化</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-10-02 00:30:16" itemprop="dateCreated datePublished" datetime="2020-10-02T00:30:16-04:00">2020-10-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2020/10/02/A24/" class="post-meta-item leancloud_visitors" data-flag-title="离子迁移概率密度可视化" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/10/02/A24/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/10/02/A24/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>大师兄在9月8日的文章中讲了如何用 Pymatgen 计算离子的电导率（该方法可以用来研究固态电解质等问题），<strong>本次，大师兄介绍一下如何使用 Pymatgen 可视化离子的迁移概率密度。</strong></p>
<p>先举个例子，</p>
<blockquote>
<p>在“Design principles for solid-state lithium superionic conductors”一文中（Wang et al., Nature Materials <strong>2015</strong>, <em>14</em> , 1026–1031. ），作者用Ab Initio Molecular Dynamic （AIMD）计算了Li 离子在Li$\mathrm{_1}<script type="math/tex">\mathrm{_0}$GeP$\mathrm{_2}$S$\mathrm{_1}</script>\mathrm{_2}$， Li$\mathrm{_7}$P$\mathrm{_3}$S$\mathrm{_1}$$\mathrm{_1}$，Li$\mathrm{_2}$S，和 Li$\mathrm{_4}$GeS$\mathrm{_4}$ 四种材料中的迁移概率密度（Probability Density），结果如下图所示：</p>
</blockquote>
<p><img src="/2020/10/02/A24/A24_1.png" alt=""></p>
<blockquote>
<ul>
<li>从图中可以看出Li离子在图a所示材料中主要沿c轴方向的通道迁移，而且由于这个通道连通得比较好，Li离子的迁移势垒会比较低（0.22~0.25 eV）。</li>
<li>Li离子在图b所示的材料的迁移路径形成了一个三维网格，而且由于这个概率密度比图b中的概率密度分布得更加均匀，Li离子的迁移势垒更低（0.18~0.19 eV）。</li>
<li>图b所示的材料就完全不行了，因为Li离子的概率密度仅分布在特定的位点附近，说明离子不能有效地移动。</li>
<li>Li离子在图d所示材料中也存在迁移局域化的行为。</li>
<li>作者总结说 “A general principle for the design of Li-ion conductors with low activation energy can be distilled from the above findings: all of the sites within the diffusion network should be energetically close to equivalent, with large channels connecting them.”</li>
</ul>
</blockquote>
<p><strong>那么我们如何在自己的计算中画出这样的图呢？</strong>Pymatgen 举手说，它可以帮忙！</p>
<p>但是在开始之前，我们要安装Pymatgen的插件：<strong>Pymatgen-diffusion</strong>（<a target="_blank" rel="noopener" href="https://github.com/materialsvirtuallab/pymatgen-diffusion）。">https://github.com/materialsvirtuallab/pymatgen-diffusion）。</a></p>
<h2 id="安装-Pymatgen-diffusion"><a href="#安装-Pymatgen-diffusion" class="headerlink" title="安装 Pymatgen-diffusion"></a>安装 Pymatgen-diffusion</h2><p><strong>推荐大家使用最新版的Anaconda安装Pymatgen及其插件。</strong>点击上面的链接，进入官网后，点击最新版本链接，</p>
<p><img src="/2020/10/02/A24/A24_2.png" alt=""></p>
<p>我们可以下载.zip文件，</p>
<p><img src="/2020/10/02/A24/A24_3.png" alt=""></p>
<p>下载完成后，大家可以解压这个文件，得到 pymatgen-diffusion-2019.8.18文件夹。</p>
<p>我们把其中的 pymatgen_diffusion 文件夹放到 Anaconda的site-packages文件夹下，路径是 Windows 系统：……\Anaconda\Lib\site-packages；Linux系统：……/anaconda3/lib/pythonx.x/site-packages，就算安装好了。</p>
<p>接下来我们可以启动python，导入这个模块，如果不报错就没有问题了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[test@ln0%tianhe2 li_sn_s]$ python</span><br><span class="line">Python 3.8.3 (default, Jul  2 2020, 16:21:59) </span><br><span class="line">[GCC 7.3.0] :: Anaconda, Inc. on linux</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; import pymatgen_diffusion</span><br><span class="line">&gt;&gt;&gt; </span><br></pre></td></tr></table></figure>
<h2 id="学习用法"><a href="#学习用法" class="headerlink" title="学习用法"></a>学习用法</h2><p>我们可以在其github网站上通过例子学习这个模块的用法。</p>
<p><img src="/2020/10/02/A24/A24_4.png" alt=""></p>
<p>点击打开 probbility_analysis.ipynb 文件。</p>
<p><img src="/2020/10/02/A24/A24_5.png" alt=""></p>
<p>其内容如下（有所删减）：如果不想看的话可直接查看 <strong>开始作图</strong> 部分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pymatgen.analysis.diffusion_analyzer <span class="keyword">import</span> DiffusionAnalyzer</span><br><span class="line"><span class="keyword">from</span> pymatgen_diffusion.aimd.pathway <span class="keyword">import</span> ProbabilityDensityAnalysis</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment">#ProbabilityDensityAnalysis object</span></span><br><span class="line">filename=<span class="string">&quot;/Users/iekhengchu/repos/pymatgen-diffusion/pymatgen_diffusion/aimd/tests/cNa3PS4_pda.json&quot;</span></span><br><span class="line"></span><br><span class="line">data = json.load(<span class="built_in">open</span>(<span class="string">&quot;../pymatgen_diffusion/aimd/tests/cNa3PS4_pda.json&quot;</span>, <span class="string">&quot;r&quot;</span>))</span><br><span class="line">diff_analyzer = DiffusionAnalyzer.from_dict(data) <span class="comment"># 初始化DiffusionAnalyzer类</span></span><br><span class="line"></span><br><span class="line">pda = ProbabilityDensityAnalysis.from_diffusion_analyzer(diff_analyzer, interval=<span class="number">0.5</span>, </span><br><span class="line">                                                         species=(<span class="string">&quot;Na&quot;</span>, <span class="string">&quot;Li&quot;</span>)) <span class="comment">#可以指定离子</span></span><br><span class="line"><span class="comment">#Save probability distribution to a CHGCAR-like file</span></span><br><span class="line">pda.to_chgcar(filename=<span class="string">&quot;CHGCAR_new2.vasp&quot;</span>) <span class="comment">#保存概率密度文件</span></span><br></pre></td></tr></table></figure>
<h2 id="开始作图"><a href="#开始作图" class="headerlink" title="开始作图"></a>开始作图</h2><p>代码（test.py）如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pymatgen_diffusion.aimd.pathway <span class="keyword">import</span> ProbabilityDensityAnalysis</span><br><span class="line"><span class="keyword">from</span> pymatgen.core.trajectory <span class="keyword">import</span> Trajectory</span><br><span class="line"><span class="keyword">from</span> pymatgen.io.vasp.outputs <span class="keyword">import</span> Xdatcar</span><br><span class="line"><span class="keyword">from</span> pymatgen.analysis.diffusion_analyzer <span class="keyword">import</span> DiffusionAnalyzer</span><br><span class="line"></span><br><span class="line">traj = Trajectory.from_file(<span class="string">&#x27;XDATCAR&#x27;</span>)</span><br><span class="line">diff = DiffusionAnalyzer.from_structures(traj,<span class="string">&#x27;Li&#x27;</span>,<span class="number">900</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">pda = ProbabilityDensityAnalysis.from_diffusion_analyzer(diff,interval=<span class="number">0.5</span>,species=(<span class="string">&quot;Li&quot;</span>))</span><br><span class="line">pda.to_chgcar(filename=<span class="string">&quot;pda.vasp&quot;</span>) <span class="comment">#保存概率密度文件</span></span><br></pre></td></tr></table></figure>
<p>此处理过程大概耗时8分钟，因机器而异。</p>
<p>在VESTA中可视化如下：</p>
<p><img src="/2020/10/02/A24/A24_6.png" alt=""></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2020/09/24/A23/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/24/A23/" class="post-title-link" itemprop="url">Ubuntu常用软件的安装</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-09-24 00:30:16" itemprop="dateCreated datePublished" datetime="2020-09-24T00:30:16-04:00">2020-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2020/09/24/A23/" class="post-meta-item leancloud_visitors" data-flag-title="Ubuntu常用软件的安装" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/09/24/A23/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/09/24/A23/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前面一节我们介绍了Ubuntu虚拟机的安装，今天就介绍一些Ubuntu常用软件的软装。大部分极其简单，敲个命令，输入下密码就能解决。少部分非常简单，设置下环境变量就可以解决。有些安装比较蛋疼的可以借助第三方平台比如Anaconda等来安装，也可以归纳到非常简单的行列中。所以，So easy！！！</p>
<h5 id="1-第一件事："><a href="#1-第一件事：" class="headerlink" title="1  第一件事："></a>1  第一件事：</h5><p>打开终端（<code>CONTROL</code> + <code>ALT</code> + <code>T</code>），创建<code>~/bin</code> 文件夹。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbrosci:~$ mkdir ~/bin</span><br></pre></td></tr></table></figure>
<p>这个文件夹用于存储一些日常的脚本文件，可执行的小程序。 平时勤备份也不会占用太大空间。</p>
<h5 id="2-命令安装程序"><a href="#2-命令安装程序" class="headerlink" title="2 命令安装程序"></a>2 命令安装程序</h5><p>复制下面的<code>sudo apt-get</code>命令，输入到<code>Terminal</code>中，回车，输入密码即可。 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install python3-pip</span><br><span class="line">sudo apt-get install curl</span><br><span class="line">curl https://bootstrap.pypa.io/get-pip.py --output get-pip.py</span><br><span class="line">sudo python get-pip.py</span><br><span class="line"></span><br><span class="line">sudo apt-get install vim </span><br><span class="line">sudo apt-get install vim-gtk</span><br><span class="line">sudo apt-get install sshfs</span><br><span class="line">sudo apt-get install rename </span><br><span class="line">sudo apt-get install xclip </span><br><span class="line">sudo apt-get install git </span><br><span class="line">sudo apt-get install gnuplot</span><br><span class="line">sudo apt-get install xcrysden</span><br><span class="line">sudo apt-get tree</span><br><span class="line">sudo apt-get install inkscape  </span><br><span class="line"></span><br><span class="line">sudo apt-get install fish </span><br><span class="line">sudo apt-get install tmux </span><br><span class="line">sudo apt-get install texlive-full</span><br><span class="line">sudo apt-get install kile  </span><br></pre></td></tr></table></figure>
<p>pip 用来安装python程序；</p>
<p>vim就不介绍了；</p>
<p>sshfs 用来把服务器挂载到本地电脑，方便传输数据；</p>
<p>rename 可以很方便批量命名；</p>
<p>xclip 可以把命令的输出复制到剪切板里面，方便鼠标粘贴；</p>
<p>git 用来从git-hub下载，上传，管理一些脚本程序等， </p>
<p>gnuplot 画图用的</p>
<p>xcrysden 可视化软件</p>
<p>tree 方便显示文件目录</p>
<p>inkscape 一款非常好用的做图软件</p>
<p>fish，tmux 装逼效果明显，没对象的重点关注下，好好学习一番，当然功能没的说，很强大。</p>
<p>Latex 写文章的可以使用最后两个命令安装。</p>
<p>其他的暂时也想不起来，如果你有推荐的，可以发邮件给我，后面再添上去。（lqcata@gmail.com）</p>
<h5 id="3-安装Anaconda"><a href="#3-安装Anaconda" class="headerlink" title="3  安装Anaconda"></a>3  安装Anaconda</h5><p>它可以帮助你节省很多时间和精力去安装软件。下载后，按照下面命令，然后一路狂摁回车或者输入<code>yes</code>即可，官网也有安装教程，这里就不累赘了。通过Anaconda安装其他软件，可以参考前面的教程：<a href="https://www.bigbrosci.com/2020/09/19/A20/">https://www.bigbrosci.com/2020/09/19/A20/</a> </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbrosci:~/Downloads$ ls</span><br><span class="line">Anaconda3-2020.07-Linux-x86_64.sh  p4vasp-0.3.30.tgz </span><br><span class="line">qli@bigbrosci:~/Downloads$ bash Anaconda3-2020.07-Linux-x86_64.sh </span><br><span class="line">Welcome to Anaconda3 2020.07</span><br><span class="line"></span><br><span class="line">In order to <span class="built_in">continue</span> the installation process, please review the license</span><br><span class="line">agreement.</span><br><span class="line">Please, press ENTER to <span class="built_in">continue</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; </span><br></pre></td></tr></table></figure>
<p>Anaconda安装的软件可以通过<a target="_blank" rel="noopener" href="https://anaconda.org">https://anaconda.org</a> 来查询，都会列出来安装的命令，比如RDkit：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install -c rdkit rdkit</span><br></pre></td></tr></table></figure>
<p>另一个需要注意的是，Anaconda安装后，最喜爱的<code>p4vasp</code>不能正常使用了。解决办法如下：</p>
<p>1） 找到p4v的目录，一般在<code>/usr/bin/</code></p>
<p>2）将<code>p4v</code>中的<code>python</code> 全部改为<code>python2</code></p>
<p>3)  将<code>p4v.py</code> 第一行中的<code>python</code>改为<code>python2</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(base) qli@bigbrosci:~$ p4v </span><br><span class="line">  File <span class="string">&quot;/usr/bin/p4v.py&quot;</span>, line 9</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;&quot;</span><span class="string">&quot;You need to get version 2.0 (or later) of PyGTK for this to work. You</span></span><br><span class="line"><span class="string">             can get source code from http://www.pygtk.org &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">          ^</span><br><span class="line">SyntaxError: invalid syntax</span><br><span class="line">(base) qli@bigbrosci:~$ <span class="built_in">which</span> p4v </span><br><span class="line">/usr/bin/p4v</span><br><span class="line">(base) qli@bigbrosci:~$ sudo vi /usr/bin/p4v</span><br><span class="line">[sudo] password <span class="keyword">for</span> qli: </span><br><span class="line">(base) qli@bigbrosci:~$ sudo vi /usr/bin/p4v.py </span><br><span class="line">(base) qli@bigbrosci:~$ grep python  /usr/bin/p4v</span><br><span class="line"><span class="built_in">export</span> PYTHONPATH=<span class="variable">$PYTHONPATH</span>:/usr/lib/python2.7/dist-packages</span><br><span class="line"><span class="built_in">exec</span> python2 /usr/bin/p4v.py <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">(base) qli@bigbrosci:~$ grep python  /usr/bin/p4v.py </span><br><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br></pre></td></tr></table></figure>
<h5 id="4-其他可执行的程序"><a href="#4-其他可执行的程序" class="headerlink" title="4 其他可执行的程序"></a>4 其他可执行的程序</h5><p>这里我们以VESTA为例，这种方法非常简单实用。</p>
<p>4.1） 下载解压VESTA程序包。（<a target="_blank" rel="noopener" href="https://jp-minerals.org/vesta/en/）">https://jp-minerals.org/vesta/en/）</a> 直接通过官网下载即可，没必要去群里面求助，也没必要往群里面上传。</p>
<p>4.2） 本人习惯性地将其解压到<code>/home/qli/Documents/VESTA-gtk3</code></p>
<p>4.3)   设置环境变量，将下面的<code>export</code> 两行复制到<code>~/.bashrc</code> 文件中， <code>source</code> 下 <code>.bashrc</code> 文件，然后直接敲命令<code>VESTA</code>即可打开可视化界面。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbrosci:~/Documents/VESTA-gtk3$ ls</span><br><span class="line">asfdc           Library_License  RIETAN.sh          style         VESTA-core</span><br><span class="line">bvparm2016.cif  libVESTA.so      spgra.dat          style.ini     VESTA_def.ini</span><br><span class="line">elements        LICENSE          spgro.dat          template.ins  VESTA-gui</span><br><span class="line">elements.ini    mspgr.dat        STRUCTURE_TIDY     tmp           VESTA.ini</span><br><span class="line">img             PowderPlot       STRUCTURE_TIDY.sh  VESTA         wyckoff.dat</span><br><span class="line">qli@bigbrosci:~/Documents/VESTA-gtk3$ <span class="built_in">pwd</span></span><br><span class="line">/home/qli/Documents/VESTA-gtk3</span><br><span class="line">qli@bigbrosci:~/Documents/VESTA-gtk3$ <span class="built_in">cd</span> </span><br><span class="line">qli@bigbrosci:~$ vi .bashrc</span><br><span class="line"><span class="built_in">export</span> VESTA=<span class="string">&#x27;/home/qli/Documents/VESTA-gtk3&#x27;</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$VESTA</span></span><br><span class="line">qli@bigbrosci:~$ <span class="built_in">source</span> .bashrc	 </span><br><span class="line">qli@bigbrosci:~$ VESTA</span><br></pre></td></tr></table></figure>
<p><code>注意</code> 上面VESTA的路径记得换成你自己电脑里面的。</p>
<h5 id="5-Ubuntu的备份"><a href="#5-Ubuntu的备份" class="headerlink" title="5 Ubuntu的备份"></a>5 Ubuntu的备份</h5><p>本人喜欢瞎折腾，也经常会把电脑搞崩溃，备份就显得尤其重要。对于Ubuntu来说，前面我们在虚拟机的安装中提到存储Ubuntu系统的<code>vdi</code>文件，如果你有足够大的硬盘，可以定期将一个稳定版本的vdi保存起来，万一系统崩溃，删掉坏的，导入最新的备份即可。</p>
<p>如果没有用虚拟机，直接装的Ubuntu系统，或者双系统，可以尝试定期保存<code>~/bin</code> 和<code>~/.bashrc</code> 文件，本人之前就是这样做的（现在懒得折腾，系统不坏了），它们不怎么占空间，打包压缩下，邮件基本就可以上传。如果系统坏掉了，非得安装一个新的才能解决的时候，只需要重复本教程，下载一些常用的软件，以及用备份的<code>~/bin</code> 和<code>~/.bashrc</code> 文件还原一下设置即可。数据一般来说都直接存储在服务器中，相关备份不在本教程讨论范围之内。</p>
<p>当然还有其他的办法备份和恢复虚拟机，比如创建当前Ubuntu版本的iso文件，定期备份当前整个系统以便引导修复等等，精力有限，不再累赘。有兴趣的可以尝试。</p>
<h5 id="6-打赏"><a href="#6-打赏" class="headerlink" title="6 打赏"></a>6 打赏</h5><p>如果感觉本文对你的相关研究有帮助，欢迎打赏，支持作者的热心付出。如果你也有自己擅长的操作等，热烈欢迎无私分享，可以通过QQ（122103465）或者邮件（lqcata@gmail.com）联系。</p>
<p><img src="/2020/09/24/A23/打赏码.jpg" alt="打赏码" style="zoom: 33%;"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2020/09/23/A22/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/23/A22/" class="post-title-link" itemprop="url">Ubuntu虚拟机的安装</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-09-23 00:30:16" itemprop="dateCreated datePublished" datetime="2020-09-23T00:30:16-04:00">2020-09-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2020/09/23/A22/" class="post-meta-item leancloud_visitors" data-flag-title="Ubuntu虚拟机的安装" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/09/23/A22/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/09/23/A22/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>为方便新手入坑，这里我们先介绍一下Ubuntu虚拟机的安装细节。VMWARE和VirtualBox是两个主要的选择，前者收费，后者免费。当然介绍免费的喽。 本节主要把安装的过程展示一遍，然后把需要注意的细节强调一下。安装虚拟机要量力而行，优先在台式机上安装虚拟机。如果你的电脑配置很普通的话，运行起来可能不会很流畅。</p>
<h5 id="第一步：-准备工作"><a href="#第一步：-准备工作" class="headerlink" title="第一步： 准备工作"></a>第一步： 准备工作</h5><p>1 下载Ubuntu的安装包</p>
<p><a target="_blank" rel="noopener" href="https://ubuntu.com/download/desktop">https://ubuntu.com/download/desktop</a></p>
<p>2 下载Virtual Box，并安装</p>
<p><a target="_blank" rel="noopener" href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></p>
<p>3 下载Virtual Box的扩展包并安装（Extension Pack）</p>
<p><img src="/2020/09/23/A22/VM_D.png" alt=""></p>
<h5 id="第二步：安装虚拟机-初始化"><a href="#第二步：安装虚拟机-初始化" class="headerlink" title="第二步：安装虚拟机(初始化)"></a>第二步：安装虚拟机(初始化)</h5><p>2.1） 创建新的虚拟机</p>
<p><img src="/2020/09/23/A22/1.png" alt=" 9.38.59" style="zoom:50%;"></p>
<p>2.2）设置虚拟机的名字，名字里面只要你输入<code>Ubuntu</code>字样，后面的Type和Version会自动更新，<code>Machine Folder</code> 最好选择一个硬盘比较大的盘。 </p>
<p><img src="/2020/09/23/A22/2.png" alt="2" style="zoom:50%;"></p>
<p>2.3） 设置虚拟机的内存，本人喜欢设置为host的一半。</p>
<p><img src="/2020/09/23/A22/2_1.png" alt="2_1" style="zoom:50%;"></p>
<p>2.4）创建虚拟机，按照图片选择即可。</p>
<p><img src="/2020/09/23/A22/2_2.png" alt="2_2" style="zoom:50%;"></p>
<p><img src="/2020/09/23/A22/3.png" alt="3" style="zoom:50%;"></p>
<p><img src="/2020/09/23/A22/4.png" alt="4" style="zoom:50%;"></p>
<p>2.5） 设置虚拟机的<code>vdi</code>文件的目录，如果前面选择好了，这个采用默认即可。虚拟机的大小：如果使用Ubuntu比较频繁，安装的软件、数据处理等比较多的话，根据自己的情况酌情增加下。但是尽量别太小，到时候存储不够容易导致死机崩溃。</p>
<p>另外一个需要注意的是：Ubuntu的系统以及后面你安装的软件，下载的东西，写的脚本等都会存在这个vdi文件里面，如果你换了一台电脑，还想继续使用虚拟机，大可不用再重复本教程的操作，直接导入vdi即可（前面2.4步骤的第一个图片）。</p>
<p><img src="/2020/09/23/A22/5.png" alt="5" style="zoom:50%;"></p>
<p>2.6） 经过前面步骤，虚拟机初始化基本完成了（界面上可以看到），按照箭头，点<code>Settings</code>。</p>
<p><img src="/2020/09/23/A22/6.png" style="zoom:50%;"></p>
<p>2.7) <code>System</code>设置处理器的数目，同样也是host的一半。太小Ubuntu容易卡死，太大host容易卡死。</p>
<p><img src="/2020/09/23/A22/7.png" alt="7" style="zoom:50%;"></p>
<p>2.8）指定Ubuntu安装iso文件的目录，点<code>Storage</code> —&gt; <code>光盘 Empty</code> —&gt; <code>右侧光盘图标</code> </p>
<p><img src="/2020/09/23/A22/9.png" alt="9" style="zoom:50%;"></p>
<p>2.9） 在弹出的对话框，选择前面下载好的Ubuntu安装文件。</p>
<p><img src="/2020/09/23/A22/10.png" alt="8" style="zoom:50%;"></p>
<p><img src="/2020/09/23/A22/11.png" alt="11" style="zoom: 50%;"></p>
<p><img src="/2020/09/23/A22/12.png" alt="12" style="zoom:50%;"></p>
<h5 id="3-安装虚拟机-（Ubuntu的安装）"><a href="#3-安装虚拟机-（Ubuntu的安装）" class="headerlink" title="3 安装虚拟机 （Ubuntu的安装）"></a>3 安装虚拟机 （Ubuntu的安装）</h5><p>3.1） 点击下方图片的<code>Start</code>绿色图表，开始启动安装</p>
<p><img src="/2020/09/23/A22/13.png" alt="11" style="zoom:50%;"></p>
<p>3.2） 选择Install Ubuntu，后面的一路<code>Continue</code></p>
<p><img src="/2020/09/23/A22/14.png" alt="14" style="zoom:50%;"></p>
<p>3.3） 设置键盘类型</p>
<p><img src="/2020/09/23/A22/15.png" alt="15" style="zoom:50%;"></p>
<p>3.4）按照下面的选择，<code>Continue</code></p>
<p><img src="/2020/09/23/A22/16.png" alt="16" style="zoom:50%;"></p>
<p><img src="/2020/09/23/A22/17.png" alt="17" style="zoom:50%;"></p>
<p>3.5) 设置用户名，计算机名，以及密码。</p>
<p><img src="/2020/09/23/A22/18.png" alt="18" style="zoom: 67%;"></p>
<p>3.6） Ubuntu 终于开始安装了，电脑配置好的别走开，配置不好的一边凉快等着去。（PS：配置不好不建议虚拟机，卡的你怀疑人生）</p>
<p><img src="/2020/09/23/A22/19.png" alt="19" style="zoom:50%;"></p>
<p>3.7） 安装完成后，会提示让你先移除安装的ISO文件，然后再点<code>ENTER</code></p>
<p><img src="/2020/09/23/A22/20.png" style="zoom:50%;"></p>
<p>3.8） 这里本人把安装包改了下名字，然后点<code>ENTER</code>。</p>
<p><img src="/2020/09/23/A22/21.png" alt=" 10.04.45" style="zoom:50%;"></p>
<p>3.9) Ubuntu 初步安装完成。</p>
<h5 id="4-后续设置"><a href="#4-后续设置" class="headerlink" title="4 后续设置"></a>4 后续设置</h5><p>前面只是顺利安装成功，但距离真正可以使用，还有几个设置需要继续操作下。</p>
<p>4.1）安装增强扩展包。（前面准备工作中，我们在host中安装了扩展包，Ubuntu里面也需要安装一下）</p>
<p><img src="/2020/09/23/A22/21_1.png" alt="21_1" style="zoom:50%;"></p>
<p><img src="/2020/09/23/A22/22.png" alt="22" style="zoom:50%;"></p>
<p><img src="/2020/09/23/A22/23.png" alt="23" style="zoom:50%;"></p>
<p>最明显的效果：</p>
<p>安装增强包前，不管你怎么拖放VirtualBox的界面，Ubuntu的界面总是那么一点。</p>
<p><img src="/2020/09/23/A22/24.png" alt="24" style="zoom:50%;"></p>
<p>安装后：Ubuntu的界面可以随意调整。（重启后才会更新效果）</p>
<p><img src="/2020/09/23/A22/25.png" alt="25" style="zoom:50%;"></p>
<p>4.2）设置虚拟机的网络。</p>
<p><code>Setting</code> —&gt; <code>Network</code>，然后按照下面的设置即可。</p>
<p><img src="/2020/09/23/A22/26.png" alt="26" style="zoom:50%;"></p>
<p>4.2) 设置剪切板共享：host复制的文字可以直接粘贴在Ubuntu里，反之亦然。(重启后生效)</p>
<p><img src="/2020/09/23/A22/27_1.png" alt="27_1" style="zoom:50%;"></p>
<p>4.3） 设置共享文件夹。</p>
<p>共享文件夹可以让你在host和Ubuntu之间及其方便地进行数据分享。</p>
<p>4.3.1 Virtual Box界面，点<code>Settings</code> —&gt; <code>Shared Folders</code>，然后按照下面图中设置即可。</p>
<p><img src="/2020/09/23/A22/27.png" alt="27" style="zoom:50%;"></p>
<p><code>Folder Path</code>为host的文件夹目录</p>
<p><code>Mount Point</code> 为虚拟机中所挂在的位置。</p>
<p>点OK， 然后我们进入到虚拟机中，会发现一个类似硬盘的图标，名为：<code>Shared</code>，点一下，发现没有权限。</p>
<p><img src="/2020/09/23/A22/28.png" alt="28" style="zoom:50%;"></p>
<p><code>解决办法</code></p>
<p>在Ubuntu中，打开终端<code>Terminal</code>，输入命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbro:~/Desktop$ sudo adduser <span class="variable">$USER</span> vboxsf </span><br><span class="line">[sudo] password <span class="keyword">for</span> qli: </span><br><span class="line">Adding user <span class="string">&#x27;qli&#x27;</span> to group <span class="string">&#x27;vboxsf&#x27;</span> ...</span><br><span class="line">Adding user qli to group vboxsf</span><br><span class="line">Done.</span><br></pre></td></tr></table></figure>
<p>完事后，重启虚拟机。如果不能启动，显示USB相关的报错信息。取消USB的选项，再次启动即可。</p>
<p><img src="/2020/09/23/A22/29.png" alt="28" style="zoom:50%;"></p>
<p>到这里，虚拟机的安装，设置基本就完成了，剩下的就是在Ubuntu里面安装一些常用的软件程序了。这个会在后续教程里面简单介绍。</p>
<h5 id="打赏"><a href="#打赏" class="headerlink" title="打赏"></a>打赏</h5><p>如果感觉本文对你的相关研究有帮助，欢迎打赏，支持作者的热心付出。如果你遇到相关的问题，或者也有自己擅长的操作，热烈欢迎无私分享，可以通过QQ（122103465）或者邮件（lqcata@gmail.com）联系。</p>
<p><img src="/2020/09/23/A22/打赏码.jpg" style="zoom:25%;"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2020/09/22/A21/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/22/A21/" class="post-title-link" itemprop="url">Ubuntu20中P4VASP的安装</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-09-22 20:30:16" itemprop="dateCreated datePublished" datetime="2020-09-22T20:30:16-04:00">2020-09-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2020/09/22/A21/" class="post-meta-item leancloud_visitors" data-flag-title="Ubuntu20中P4VASP的安装" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/09/22/A21/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/09/22/A21/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>P4vasp是一款基于Python2的，用于可视化，搭建结构的软件。由于Python2已经被时代所淘汰，p4vasp官网也不见任何的针对python3的更新改进，这个软件估计要凉，跟我们再见了。但Ubuntu20安装也不是很难，能撑到博士毕业应该问题不大。经过多次的测试，下面是p4vasp的安装过程，非常简单。</p>
<h5 id="下载并解压"><a href="#下载并解压" class="headerlink" title="下载并解压"></a>下载并解压</h5><p>下载链接：<a target="_blank" rel="noopener" href="http://www.p4vasp.at/#/download">http://www.p4vasp.at/#/download</a> </p>
<p>这里本人把安装包解压缩到了<code>~/Documents/</code> 目录下。</p>
<h5 id="安装步骤-1"><a href="#安装步骤-1" class="headerlink" title="安装步骤-1"></a>安装步骤-1</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbrosci:~/Documents/p4vasp-0.3.30$ ls</span><br><span class="line">BUGS           install           odpdom                setenvironment.sh</span><br><span class="line">ChangeLog      install-local.sh  p4v                   src</span><br><span class="line">data           install.sh        p4vasp-0.3.30-1.spec  <span class="built_in">test</span></span><br><span class="line">diagnostic.py  lib               p4vasp.log            uninstall.sh</span><br><span class="line">doc            LICENSE           p4v.py                utils</span><br><span class="line">ext            Makefile          README                vinfo.py</span><br><span class="line">FAQS           Makefile.MacOS    README.MacOS          vinfo.pyc</span><br><span class="line">qli@bigbrosci:~/Documents/p4vasp-0.3.30$ sudo apt-get install gcc make</span><br><span class="line">qli@bigbrosci:~/Documents/p4vasp-0.3.30$ sudo apt-get install make</span><br><span class="line">qli@bigbrosci:~/Documents/p4vasp-0.3.30$ sudo apt-get install python2-dev</span><br></pre></td></tr></table></figure>
<h5 id="安装步骤-2："><a href="#安装步骤-2：" class="headerlink" title="安装步骤-2："></a>安装步骤-2：</h5><p><a target="_blank" rel="noopener" href="http://archive.ubuntu.com/ubuntu/pool/universe/p/pygtk/">http://archive.ubuntu.com/ubuntu/pool/universe/p/pygtk/</a></p>
<p>从这个网站下载：python-gtk2 和 python-glade2的deb文件，下载后，双击即可安装。</p>
<p><strong>注意：</strong>先安装gtk2，再安装glade2。</p>
<p><img src="/2020/09/22/A21/A21.png" style="zoom:50%;"></p>
<h5 id="安装步骤-3："><a href="#安装步骤-3：" class="headerlink" title="安装步骤-3："></a>安装步骤-3：</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbrosci:~/Documents/p4vasp-0.3.30$ sudo apt-get install libxft-dev</span><br><span class="line">qli@bigbrosci:~/Documents/p4vasp-0.3.30$ sudo apt-get install libglfw3-dev libgl1-mesa-dev libglu1-mesa-dev</span><br><span class="line">qli@bigbrosci:~/Documents/p4vasp-0.3.30$ bash install/install-ubuntu-dependencies.sh</span><br><span class="line">qli@bigbrosci:~/Documents/p4vasp-0.3.30$ bash install.sh</span><br></pre></td></tr></table></figure>
<h5 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h5><p><code>bash install/install-ubuntu-dependencies.sh</code> 这一步最后可能会出<code>python-epydoc</code>的报错，可以忽略。</p>
<h5 id="反馈："><a href="#反馈：" class="headerlink" title="反馈："></a>反馈：</h5><p>上面的命令是Ubuntu20里面安装用的，如果安装过程出现问题，或者有更好的安装方法，欢迎交流讨论：</p>
<p>QQ：122103465</p>
<p>E-mail：lqcata@gmail.com</p>
<p>至于其他的Linux系统，本人没有测试，如果你有比较好的安装方法，也欢迎分享讨论。</p>
<h5 id="打赏"><a href="#打赏" class="headerlink" title="打赏"></a>打赏</h5><p>如果感觉本文对你的相关研究有帮助，欢迎打赏，支持作者的热心付出。如果你也有自己的骚操作，热烈欢迎无私分享，可以通过QQ（122103465）或者邮件（lqcata@gmail.com）联系。</p>
<p><img src="/2020/09/22/A21/打赏码.jpg" style="zoom:25%;"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2020/09/19/A20/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/19/A20/" class="post-title-link" itemprop="url">ASE的骚操作系列（SMILES-To-XYZ）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-09-19 20:30:16" itemprop="dateCreated datePublished" datetime="2020-09-19T20:30:16-04:00">2020-09-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2020/09/19/A20/" class="post-meta-item leancloud_visitors" data-flag-title="ASE的骚操作系列（SMILES-To-XYZ）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/09/19/A20/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/09/19/A20/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>今天我们介绍ASE的另一个骚操作：结合Openbabel自动搭分子结构。与其说是ASE的骚操作，不如把这个骚字放在Openbabel头上。Openbabel是一款功能极其强大的结构转化工具。如果你在用它，我就不在这里啰嗦了。如果你没听过，可以通过这个链接来初步了解一下。（<a target="_blank" rel="noopener" href="http://openbabel.org/wiki/Main_Page）">http://openbabel.org/wiki/Main_Page）</a></p>
<p>鉴于Openbabel的安装比较蛋疼，先送一波福利（Mac，Linux用户）。下面是本人通过Anaconda（已经路转粉）创建虚拟环境，并且安装这些软件的一些命令。通过它们可以让你安全顺利，麻溜滴地安装Openbabel, RDkit, Ase，和pymatgen。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">conda create --name qrobot</span><br><span class="line">conda activate qrobot</span><br><span class="line">conda install -c conda-forge openbabel</span><br><span class="line">conda install -c conda-forge rdkit</span><br><span class="line">conda install -c conda-forge ase</span><br><span class="line">conda install --channel conda-forge pymatgen</span><br></pre></td></tr></table></figure>
<p>RDkit也是一款功能及其强大地软件，尤其是化学信息学，生物化学相关的领域。如果不了解，点击这个官网学习。（<a target="_blank" rel="noopener" href="https://www.rdkit.org/）顺便吐槽一下，百度里面你搜索一堆RDkit的使用，大部分都是把官网例子复制过来，然后贴个二维码要钱的。交不交智商税决定权在你手上，如果手痒，请跳到文末最后，把钱打赏给我。">https://www.rdkit.org/）顺便吐槽一下，百度里面你搜索一堆RDkit的使用，大部分都是把官网例子复制过来，然后贴个二维码要钱的。交不交智商税决定权在你手上，如果手痒，请跳到文末最后，把钱打赏给我。</a></p>
<p>废话不多说，转到我们今天的主题： SMILES to XYZ。又是一个新知识，什么是SMILES？ </p>
<p>SMILES是<strong>simplified molecular-input line-entry system</strong> 的缩写，旨在用ASCII字符串来标识，描述分子的结构。如果你不了解，可以通过下面两个链接初步了解一下：</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system">https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system</a></p>
<p><a target="_blank" rel="noopener" href="https://www.daylight.com/dayhtml/doc/theory/theory.smiles.html">https://www.daylight.com/dayhtml/doc/theory/theory.smiles.html</a></p>
<p>通过SMILES我们可以将一个分子用字符串来标识出来，比如我们后面练习中的：</p>
<p>乙醇（CCO），甲烷（C），甲基（[CH3]）, 苯（c1ccccc1）。</p>
<p>所以，在操作之前，你需要知道所搭结构的SMILES字符串。通过上面两个链接，耐心钻研一下，应该不到1天就可以搞定大部分的分子。将SMILES转化为3D的结构，可以通过Openbabel，也可以通过RDkit。今天我们就介绍前者。下面是脚本内容（smiles_to_xyz.py）以及使用的效果。最后，我们再详细解释这个脚本是怎么工作的。</p>
<h5 id="脚本内容"><a href="#脚本内容" class="headerlink" title="脚本内容"></a>脚本内容</h5><p>下载链接：<a target="_blank" rel="noopener" href="https://github.com/BigBroSci-LVTHW/LVTHW/tree/master/source/_posts/A20">https://github.com/BigBroSci-LVTHW/LVTHW/tree/master/source/_posts/A20</a> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3 </span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">convert SMILES to xyz</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> openbabel <span class="keyword">import</span> pybel</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> ase</span><br><span class="line"><span class="keyword">import</span> ase.io</span><br><span class="line"><span class="keyword">from</span> ase <span class="keyword">import</span> Atoms</span><br><span class="line"><span class="keyword">from</span> ase.constraints <span class="keyword">import</span> FixAtoms</span><br><span class="line"> </span><br><span class="line">smiles, out_name = sys.argv[<span class="number">1</span>:<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Introduction to SMILES:</span></span><br><span class="line"><span class="string">https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system</span></span><br><span class="line"><span class="string">https://www.daylight.com/dayhtml/doc/theory/theory.smiles.html</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Use openbabel to convert SMILES to xyz. </span></span><br><span class="line">mol = pybel.readstring(<span class="string">&quot;smi&quot;</span>, smiles)</span><br><span class="line">mol.make3D(forcefield=<span class="string">&#x27;mmff94&#x27;</span>, steps=<span class="number">100</span>)</span><br><span class="line"><span class="comment"># mol.write(&quot;xyz&quot;, filename=out_name+&#x27;_pybel.xyz&#x27;, overwrite=True)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># USE ase to make POSCAR</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; https://wiki.fysik.dtu.dk/ase/ase/atoms.html&#x27;&#x27;&#x27;</span></span><br><span class="line">geo = Atoms()</span><br><span class="line">geo.set_cell(np.array([[<span class="number">16.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>],[<span class="number">0.0</span>, <span class="number">17.0</span>, <span class="number">0.0</span>],[<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">18.0</span>]]))</span><br><span class="line">geo.set_pbc((<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>))</span><br><span class="line"><span class="keyword">for</span> atom <span class="keyword">in</span> mol:</span><br><span class="line">    atom_type = atom.atomicnum</span><br><span class="line">    atom_position = np.array([<span class="built_in">float</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> atom.coords])</span><br><span class="line">    geo.append(atom_type)</span><br><span class="line">    geo.positions[-<span class="number">1</span>] = atom_position</span><br><span class="line">geo.center()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;https://wiki.fysik.dtu.dk/ase/ase/constraints.html&#x27;&#x27;&#x27;</span></span><br><span class="line">c = FixAtoms(indices=[atom.index <span class="keyword">for</span> atom <span class="keyword">in</span> geo <span class="keyword">if</span> atom.symbol == <span class="string">&#x27;XX&#x27;</span>])</span><br><span class="line">geo.set_constraint(c)</span><br><span class="line"></span><br><span class="line">ase.io.write(out_name + <span class="string">&#x27;_ase.xyz&#x27;</span>, geo, <span class="built_in">format</span>=<span class="string">&#x27;xyz&#x27;</span>)</span><br><span class="line">ase.io.write(out_name + <span class="string">&#x27;_POSCAR&#x27;</span>, geo, <span class="built_in">format</span>=<span class="string">&#x27;vasp&#x27;</span>, vasp5=<span class="string">&#x27;True&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="脚本运行"><a href="#脚本运行" class="headerlink" title="脚本运行"></a>脚本运行</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> (qrobot) qli@MacBook-Pro test_openbabel % python3 smiles_to_xyz.py <span class="string">&#x27;[CH3]&#x27;</span> Methyl</span><br><span class="line"> (qrobot) qli@MacBook-Pro test_openbabel % python3 smiles_to_xyz.py <span class="string">&#x27;CCO&#x27;</span> ET</span><br><span class="line"> (qrobot) qli@MacBook-Pro test_openbabel % python3 smiles_to_xyz.py <span class="string">&#x27;C&#x27;</span> Methane</span><br><span class="line"> (qrobot) qli@MacBook-Pro test_openbabel % python3 smiles_to_xyz.py <span class="string">&#x27;c1ccccc1&#x27;</span> BZ</span><br><span class="line"> (qrobot) qli@MacBook-Pro test_openbabel % ls</span><br><span class="line">BZ_POSCAR         BZ_ase.xyz        ET_POSCAR         ET_ase.xyz        Methane_POSCAR    Methane_ase.xyz   Methyl_POSCAR     Methyl_ase.xyz    smiles_to_xyz.py</span><br></pre></td></tr></table></figure>
<h5 id="结果展示"><a href="#结果展示" class="headerlink" title="结果展示"></a>结果展示</h5><p><img src="/2020/09/19/A20/BZ.png" alt=""></p>
<p><img src="/2020/09/19/A20/ET.png" alt="ET"></p>
<p><img src="/2020/09/19/A20/Methane.png" alt="Methane"></p>
<p><img src="/2020/09/19/A20/Methyl.png" alt="Methyl"></p>
<h5 id="内容详解"><a href="#内容详解" class="headerlink" title="内容详解"></a>内容详解</h5><ol>
<li>Openbabel部分其实就三行代码，非常简单。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mol = pybel.readstring(<span class="string">&quot;smi&quot;</span>, smiles)</span><br><span class="line"><span class="number">2</span> mol.make3D(forcefield=<span class="string">&#x27;mmff94&#x27;</span>, steps=<span class="number">100</span>)</span><br><span class="line"><span class="number">3</span> <span class="comment"># mol.write(&quot;xyz&quot;, filename=out_name+&#x27;_pybel.xyz&#x27;, overwrite=True)</span></span><br></pre></td></tr></table></figure>
<p>1) 读取SMILES，并创建一个mol的对象（object）。</p>
<p>2) <code>make3D</code> 通过MMFF94力场对生成的3D结构优化了100步。 </p>
<p>3) 保存结构，这里我把它注释掉了，因为后面我们要通过ASE来生成xyz和POSCAR。</p>
<ol>
<li>ASE部分，代码多一些，可能本人水平有限吧。不管怎么样，这里主要告诉大家的一点就是：我们可以将Openbabel和ASE无缝连接起来。同样，你也可以把ASE与你自己写的一些东西关联，这样就可以调用ASE的功能来快速实现一些小目标了。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> geo = Atoms()</span><br><span class="line"><span class="number">2</span> geo.set_cell(np.array([[<span class="number">16.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>],[<span class="number">0.0</span>, <span class="number">17.0</span>, <span class="number">0.0</span>],[<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">18.0</span>]]))</span><br><span class="line"><span class="number">3</span> geo.set_pbc((<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>))</span><br><span class="line"><span class="number">4</span> <span class="keyword">for</span> atom <span class="keyword">in</span> mol:</span><br><span class="line"><span class="number">5</span>    atom_type = atom.atomicnum</span><br><span class="line"><span class="number">6</span>    atom_position = np.array([<span class="built_in">float</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> atom.coords])</span><br><span class="line"><span class="number">7</span>    geo.append(atom_type)</span><br><span class="line"><span class="number">8</span>    geo.positions[-<span class="number">1</span>] = atom_position</span><br><span class="line"><span class="number">9</span> geo.center()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;https://wiki.fysik.dtu.dk/ase/ase/constraints.html&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">10</span> c = FixAtoms(indices=[atom.index <span class="keyword">for</span> atom <span class="keyword">in</span> geo <span class="keyword">if</span> atom.symbol == <span class="string">&#x27;XX&#x27;</span>])</span><br><span class="line"><span class="number">11</span> geo.set_constraint(c)</span><br><span class="line"></span><br><span class="line"><span class="number">12</span> ase.io.write(out_name + <span class="string">&#x27;_ase.xyz&#x27;</span>, geo, <span class="built_in">format</span>=<span class="string">&#x27;xyz&#x27;</span>)</span><br><span class="line"><span class="number">13</span> ase.io.write(out_name + <span class="string">&#x27;_POSCAR&#x27;</span>, geo, <span class="built_in">format</span>=<span class="string">&#x27;vasp&#x27;</span>, vasp5=<span class="string">&#x27;True&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>1）创建一个ASE的Atom空对象；</p>
<p>2）设置放分子的格子大小，这里我们用的是16x17x18 $\AA^3$的。如果嫌小，自己改大一下就可以了。</p>
<p>3）设置周期性；</p>
<p>4-8）将<code>Openbabel</code>的<code>mol</code>对象中的原子添加到<code>ASE</code>的<code>Atom</code>对象里面。</p>
<p>9）将分子放到格子的中心。</p>
<p>10-11）固定或者放开原子，这里我们打算放开所有的原子，所以用到了一个<code>XX</code> 。如果原子符号是<code>XX</code>，那么就固定住。其实世界上根本就没有<code>XX</code>原子，因此所有的原子就会被放开了。</p>
<p>12-13） 保存xyz和VASP的POSCAR。</p>
<h5 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h5><p>通过SMILES来搭建结构非常方便，当然也可以通过数据库下载，可视化程序例如GaussianView等自己手动搭建。</p>
<p>值得注意的是，不管通过什么方式搭建的结构，提交任务之前，都要尽可能保证结构的合理性。所以不要搭建完结构就立刻提交任务，先认真检查一遍，没有任何问题之后再提交。</p>
<h5 id="打赏"><a href="#打赏" class="headerlink" title="打赏"></a>打赏</h5><p>如果感觉本文对你的相关研究有帮助，欢迎打赏，支持作者的热心付出。如果你也有自己的骚操作，热烈欢迎无私分享，可以通过QQ（122103465）或者邮件（lqcata@gmail.com）联系。</p>
<p><img src="/2020/09/19/A20/打赏码.jpg" style="zoom:25%;"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2020/09/11/A19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/11/A19/" class="post-title-link" itemprop="url">ASE的骚操作系列（扩胞）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-09-11 20:30:16" itemprop="dateCreated datePublished" datetime="2020-09-11T20:30:16-04:00">2020-09-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2020/09/11/A19/" class="post-meta-item leancloud_visitors" data-flag-title="ASE的骚操作系列（扩胞）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/09/11/A19/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/09/11/A19/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>本节介绍一下ASE的另一个骚操作—-扩胞。说到扩胞，这个大家都不陌生，可以有很多种方式来实现，本教程中就介绍了p4vasp的一种操作，今天就看一下ASE的骚操作吧。废话不多说，直接上例子和脚本。</p>
<h4 id="例子："><a href="#例子：" class="headerlink" title="例子："></a>例子：</h4><p>本例子中，主要把优化好的一个(1x1)-Ru(0001)的slab 扩胞为（4x4）的slab。为什么这样做呢？因为直接优化刚刚切好的（4x4)slab会有些费时间。先优化（1x1)的，在CONTCAR的基础上扩展为（4x4）的，再优化会相对来说快一些。但现在大家服务器一般都很给力，从刚切好的（1x1) slab直接扩展到（4x4），然后再优化也可以的。不管怎么样，扩胞这个操作都是必须的。如果你硬要抬扛说，我可以直接从bulk切出来（4x4)的，不用扩胞这么麻烦。OK，这也是可以的。但等你需要扩胞操作的时候，记得回来看这个骚操作就行。</p>
<p>先展示一下效果吧： </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbro:~/Desktop/A19$ ls</span><br><span class="line">CONTCAR  expand.py </span><br><span class="line">qli@bigbro:~/Desktop/A19$ python3 expand.py  CONTCAR  4 4 1 </span><br><span class="line">qli@bigbro:~/Desktop/A19$ ls</span><br><span class="line">CONTCAR  expand.py  POSCAR</span><br><span class="line">qli@bigbro:~/Desktop/A19$ ase gui <span class="string">&quot;-R -90x&quot;</span> CONTCAR </span><br><span class="line">qli@bigbro:~/Desktop/A19$ ase gui <span class="string">&quot;-R -90x&quot;</span> POSCAR </span><br></pre></td></tr></table></figure>
<p>扩胞前：（CONTCAR）</p>
<p><img src="/2020/09/11/A19/1x1.png" alt=""></p>
<p>扩胞后：（POSCAR）</p>
<p><img src="/2020/09/11/A19/4x4.png" alt=""></p>
<h4 id="脚本："><a href="#脚本：" class="headerlink" title="脚本："></a>脚本：</h4><p>脚本可以通过git-hub下载，链接：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/BigBroSci-LVTHW/LVTHW/tree/master/source/_posts/A19">https://github.com/BigBroSci-LVTHW/LVTHW/tree/master/source/_posts/A19</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Created on Wed Oct  2 10:54:36 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@author: qli</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> sys, os</span><br><span class="line"><span class="keyword">import</span> ase.io.vasp</span><br><span class="line"></span><br><span class="line">file_read = sys.argv[<span class="number">1</span>]</span><br><span class="line">x,y,z     = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> sys.argv[<span class="number">2</span>:<span class="number">5</span>]]</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    cell = ase.io.vasp.read_vasp(<span class="string">&quot;CONTCAR&quot;</span>)</span><br><span class="line">    ase.io.vasp.write_vasp(<span class="string">&quot;POSCAR&quot;</span>,cell*(x, y, z), direct=<span class="literal">True</span>,sort=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(os.getcwd())</span><br></pre></td></tr></table></figure>
<p>前面的扩胞命令：<code>expand.py  CONTCAR  4 4 1</code></p>
<p><code>CONTCAR</code> 对应的为 <code>sys.argv[1]</code></p>
<p><code>4 4 1</code> 分别为在<code>x,y,z</code> 三个方向扩胞的倍数。</p>
<h4 id="打赏"><a href="#打赏" class="headerlink" title="打赏"></a>打赏</h4><p>如果感觉本文对你的相关研究有帮助，欢迎打赏，支持作者的热心付出。如果你也有自己的骚操作，热烈欢迎无私分享，可以通过QQ（122103465）或者邮件（lqcata@gmail.com）联系。</p>
<p><img src="/2020/09/11/A19/打赏码.jpg" style="zoom:25%;"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2020/09/08/A18/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/08/A18/" class="post-title-link" itemprop="url">Pymatgen的骚操作系列（计算离子电导率）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-09-08 20:30:16" itemprop="dateCreated datePublished" datetime="2020-09-08T20:30:16-04:00">2020-09-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2020/09/08/A18/" class="post-meta-item leancloud_visitors" data-flag-title="Pymatgen的骚操作系列（计算离子电导率）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/09/08/A18/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/09/08/A18/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>ASE 在 DFT 计算中的骚操作令人印象深刻。类似 ASE 的科研工具还有很多，比如 VASPKIT 和 QVASP。熟练使用这些科研工具肯定会助力大家快速完成科研任务，发出更好更高质量的文章。</p>
<p>此次，本文向大家隆重介绍另一款出色的科研工具：Pymatgen。</p>
<p>Pymatgen 是 python materials genomics 的缩写，它是一款基于 python 的、开源的、强大的材料分析软件（<a target="_blank" rel="noopener" href="https://pymatgen.org/）。">https://pymatgen.org/）。</a></p>
<p>Pymatgen 包含一系列能够表示元素（Element）、位点（Site）、分子（Molecule）、和结构（Structure）的类（Class）。它具有为很多计算软件提供前处理和后处理的能力。这些计算软件包括VASP，ABINIT，exciting，FEFF，QCHEM，LAMMPS，ADF，AIIDA，ASE，Gaussian，Lobster，Phonopy，Shengbte，Pwscf，和Zeo++等等。它能实现科研狗的众多后处理需求，包括生成相图（Phase diagram）和布拜图（Pourbaix diagrams），分析态密度和能带等等。</p>
<p>Pymatgen 还提供了很多数据库（Materials Project REST API，Crystallography Open Database，and other external data sources）的接口，方便大家从数据库中查询结构和其他数据。</p>
<p>真是科研狗快乐科研之利器呀！</p>
<blockquote>
<p>以下是Pymatgen官网提供的后处理的例子：</p>
</blockquote>
<p><img src="/2020/09/08/A18/examples.png" alt=""></p>
<p><em>Top: (left) Phase and (right) Pourbaix diagram from the Materials API. Bottom left: Calculated bandstructure plot using pymatgen’s parsing and plotting utilities. Bottom right: Arrhenius plot using pymatgen’s DiffusionAnalyzer.</em></p>
<p><strong>此次，本文就介绍一下如何使用 Pymatgen 的 DiffusionAnalyzer 类去计算锂离子固态电解质中锂离子电导率。</strong></p>
<h2 id="计算离子电导率的理论与公式"><a href="#计算离子电导率的理论与公式" class="headerlink" title="计算离子电导率的理论与公式"></a>计算离子电导率的理论与公式</h2><p>目前，比较准确的计算离子电导率的方法是先用NVT系综第一性原理分子动力学（<strong>AIMD</strong>，<em>ab initio</em> molecular dynamics）模拟材料中离子在不同温度下的运动，然后计算出离子的平均（average）均方位移（<strong>MSD</strong>，mean square displacement），再计算出自扩散系数（D$_s$，self-diffusion coefficient），最后求得离子在某温度下的电导率（$\sigma$，conductivity）。</p>
<h3 id="如何进行AIMD计算"><a href="#如何进行AIMD计算" class="headerlink" title="如何进行AIMD计算"></a>如何进行AIMD计算</h3><p>AIMD计算通常非常耗时，所以，为了减少计算成本，我们可以适当放宽计算精度。如果用 VASP 进行计算，具体的，大家可以</p>
<ul>
<li>采用较小的截断能。氧化物用 400 eV，硫化物用 280 eV，硒化物用 270 eV</li>
<li>采用Gamma点作为K点设置，并使用gam版本的 VASP 进行计算</li>
<li>采用单胞计算，如果材料的单胞包含比较多的原子</li>
<li>采用合适的步长，比如2 fs，即 POTIM = 2</li>
</ul>
<h3 id="后处理的基本公式"><a href="#后处理的基本公式" class="headerlink" title="后处理的基本公式"></a>后处理的基本公式</h3><p>一旦AIMD计算完成，大家就可以着手计算离子电导率了。本文首先先介绍以下计算过程中使用的公式，方便有兴趣的同学自己开发脚本。</p>
<blockquote>
<p>平均均方位移（average MSD）可以通过以下公式计算：</p>
<script type="math/tex; mode=display">
averageMSD=\langle[\, \mathbf r(t)]^2\,\rangle=\frac{1}{N}\sum_{i}^{N}\langle[\,  \mathbf r_i(t+t_0)]\,^2 - [\,  \mathbf r_i(t_0)]\,^2\rangle</script><p>$\mathbf r_i(t)$ 是第 $i$ 个离子在 $t$ 时刻的位移。</p>
<p>自扩散系数（$D_s$）可以通过以下公式计算：</p>
<script type="math/tex; mode=display">
D_s=\frac{averageMSD}{2dt}</script><p>$d$ 是离子在材料中的扩散维度（一般地，$d=3$），$t$ 是离子扩散的时间。</p>
<p>最后，离子电导率（$\sigma$）可以这样计算：</p>
<script type="math/tex; mode=display">
\sigma=\frac{ne^2Z^2}{k_BT}D_s</script><p>$n$ 是材料中的离子密度，$e$ 是元电荷，$Z$ 是离子的价态，$k_B$ 是玻尔兹曼常数，$T$ 是温度。</p>
</blockquote>
<h2 id="电导率计算的例子"><a href="#电导率计算的例子" class="headerlink" title="电导率计算的例子"></a>电导率计算的例子</h2><p>现在我们通过一个 Li_Sn_S 材料的例子来详细了解一下整个计算和处理的过程。该材料的结构显示如下：</p>
<p><img src="/2020/09/08/A18/Li_Sn_S.jpg" alt=""></p>
<p>本例中采用单胞做计算，INCAR 设置如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[test@ln0%tianhe2 li_sn_s]$ vi INCAR</span><br><span class="line"></span><br><span class="line">ISTART = <span class="number">0</span></span><br><span class="line">ICHARG = <span class="number">2</span></span><br><span class="line">IBRION = <span class="number">0</span></span><br><span class="line">ISIF = <span class="number">2</span></span><br><span class="line">NPAR = <span class="number">8</span></span><br><span class="line">NSW = <span class="number">30000</span></span><br><span class="line">TEBEG = <span class="number">900</span> <span class="comment">#还要设置成 1500K 等等</span></span><br><span class="line">PREC = N</span><br><span class="line">POTIM = <span class="number">2</span></span><br><span class="line">SMASS = <span class="number">0.0</span></span><br><span class="line">NELMIN = <span class="number">4</span></span><br><span class="line">LWAVE = F</span><br><span class="line">LCHARG = F</span><br><span class="line">IALGO = <span class="number">48</span></span><br><span class="line">LREAL = A</span><br></pre></td></tr></table></figure>
<p>AIMD 计算结束之后会得到 XDATCAR 文件。很多时候，由于超算的时间限制，一个完整的AIMD计算需要提交两三次，从而产生两三个 XDATCAR 文件，这时，我们只要把它们按顺序通过 cat 命令合并在一起就行。例如我们有三个 XDATCAR 文件，分别命名成 XDATCAR01，XDATCAR02，和 XDATCAR03。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[test@ln0%tianhe2 li_sn_s]$ cat XDATCAR01 XDATCAR02 XDATCAR03 &gt; XDATCAR </span><br></pre></td></tr></table></figure>
<p><strong>新得到的XDATCAR文件，注意删掉重复的与晶格信息相关的行</strong>，一般续算的次数也不多，在使用上面命令的时候，手动把<code>XDATCAR02</code>, <code>XDATCAR03</code> 中的删除即可。</p>
<h3 id="Pymatgen-大显身手"><a href="#Pymatgen-大显身手" class="headerlink" title="Pymatgen 大显身手"></a>Pymatgen 大显身手</h3><h4 id="安装pymatgen"><a href="#安装pymatgen" class="headerlink" title="安装pymatgen"></a>安装pymatgen</h4><p>首先让我们安装 pyamtgen，推荐大家参考官网，使用 anaconda 安装，否则会出现问题。安装好了anaconda之后，不管是 linux 还是 windows, 安装 pyamtgen 的指令是一样的。下面以吕梁天河超算为例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[test@ln0%</span><span class="bash">tianhe2 li_sn_s]$ conda install --channel conda-forge pymatgen</span></span><br></pre></td></tr></table></figure>
<p>安装完成后，我们可以试着运行 python，导入 Pyamtgen 模块，如果像下面一样没有出错，就是安装成功了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[test@ln0%tianhe2 li_sn_s]$ python</span><br><span class="line">Python <span class="number">3.7</span><span class="number">.3</span> (default, Mar <span class="number">27</span> <span class="number">2019</span>, <span class="number">22</span>:<span class="number">11</span>:<span class="number">17</span>) </span><br><span class="line">[GCC <span class="number">7.3</span><span class="number">.0</span>] :: Anaconda, Inc. on linux</span><br><span class="line"><span class="type">Type</span> <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> <span class="keyword">or</span> <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pymatgen</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span></span><br></pre></td></tr></table></figure>
<h4 id="查看-DiffusionAnalyzer-的类"><a href="#查看-DiffusionAnalyzer-的类" class="headerlink" title="查看 DiffusionAnalyzer 的类"></a>查看 DiffusionAnalyzer 的类</h4><p>大家可以通过官方文档（<a target="_blank" rel="noopener" href="https://pymatgen.org/pymatgen.analysis.diffusion_analyzer.html）查看接下来要使用的类，熟悉一下代码的用法。">https://pymatgen.org/pymatgen.analysis.diffusion_analyzer.html）查看接下来要使用的类，熟悉一下代码的用法。</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DiffusionAnalyzer</span>(<span class="params">MSONable</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, structure, displacements, specie, temperature,</span></span></span><br><span class="line"><span class="params"><span class="function">                 time_step, step_skip, smoothed=<span class="string">&quot;max&quot;</span>, min_obs=<span class="number">30</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">                 avg_nsteps=<span class="number">1000</span>, lattices=<span class="literal">None</span></span>):</span></span><br></pre></td></tr></table></figure>
<p>这段代码显示，运行这个类需要一系列的输入信息，包括材料结构（structure），位移（displacements），要研究的离子（specie），温度（temperature）等等。</p>
<p>但是这个类提供了很多方法让大家可以通过读取 XDATCAR 或者 vasprun 文件的方式来实例化，例如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">from_structures</span>(<span class="params">cls, structures, specie, temperature,</span></span></span><br><span class="line"><span class="params"><span class="function">                        time_step, step_skip, initial_disp=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">                        initial_structure=<span class="literal">None</span>, **kwargs</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Convenient constructor that takes in a list of Structure objects to</span></span><br><span class="line"><span class="string">        perform diffusion analysis.</span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            structures ([Structure]): list of Structure objects (must be</span></span><br><span class="line"><span class="string">                ordered in sequence of run). E.g., you may have performed</span></span><br><span class="line"><span class="string">                sequential VASP runs to obtain sufficient statistics.</span></span><br><span class="line"><span class="string">        ... ...</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>好了，废话不多说，直接上代码，开始进行后处理。</p>
<h4 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h4><p>新建一个文件，名字为<code>li_conductivity.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">分析AIMD结果，计算MSD 和 conductivity</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> pymatgen.core.trajectory <span class="keyword">import</span> Trajectory</span><br><span class="line"><span class="keyword">from</span> pymatgen.io.vasp.outputs <span class="keyword">import</span> Xdatcar</span><br><span class="line"><span class="keyword">from</span> pymatgen <span class="keyword">import</span> Structure</span><br><span class="line"><span class="keyword">from</span> pymatgen.analysis.diffusion_analyzer <span class="keyword">import</span> DiffusionAnalyzer</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这一步是读取 XDATCAR，得到一系列结构信息</span></span><br><span class="line">traj = Trajectory.from_file(<span class="string">&#x27;XDATCAR&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这一步是实例化 DiffusionAnalyzer 的类</span></span><br><span class="line"><span class="comment"># 并用 from_structures 方法初始化这个类； 900 是温度，2 是POTIM 的值，1是间隔步数</span></span><br><span class="line"><span class="comment"># 间隔步数（step_skip）不太容易理解，但是根据官方教程:</span></span><br><span class="line"><span class="comment"># dt = timesteps * self.time_step * self.step_skip</span></span><br><span class="line"></span><br><span class="line">diff = DiffusionAnalyzer.from_structures(traj,<span class="string">&#x27;Li&#x27;</span>,<span class="number">900</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以用内置的 plot_msd 方法画出 MSD 图像</span></span><br><span class="line"><span class="comment"># 有些终端不能显示图像，这时候可以调用 export_msdt() 方法，得到数据后再自己作图</span></span><br><span class="line">diff.plot_msd()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接下来直接得到 离子迁移率， 单位是 mS/cm</span></span><br><span class="line">C = diff.conductivity</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;result.dat&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&#x27;# AIMD result for Li-ion\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">&#x27;temp\tconductivity\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">&#x27;%d\t%.2f\n&#x27;</span> %(<span class="number">900</span>,C))</span><br></pre></td></tr></table></figure>
<p>在终端运行该文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[test@ln0%tianhe2 li_sn_s]$ python li_conductivity.py</span><br></pre></td></tr></table></figure>
<p>一段时间后就会得到MSD图像和离子电导率</p>
<p><img src="/2020/09/08/A18/MSD.png" alt=""></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[test@ln0%tianhe2 li_sn_s]$ vi result.dat</span><br><span class="line"></span><br><span class="line"># AIMD result for Li-ion</span><br><span class="line">temp	conductivity</span><br><span class="line">900	884.05</span><br></pre></td></tr></table></figure>
<p>可见，该材料在 900K 时的锂离子电导率为 884.05 mS/cm。</p>
<h4 id="例子下载："><a href="#例子下载：" class="headerlink" title="例子下载："></a>例子下载：</h4><p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1WGzOVJBoe6Ym8mvR1uWanA">https://pan.baidu.com/s/1WGzOVJBoe6Ym8mvR1uWanA</a><br>提取码：jhc5</p>
<h4 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h4><ul>
<li>简短几行代码就可以计算出离子电导率，那么如何得出材料在300K下的电导率呢？</li>
<li>如何计算离子在材料中的迁移势垒？</li>
<li>如何可视化离子在材料中的扩散路径？</li>
</ul>
<p>本文只是浅谈离子电导率的计算，欢迎大家指出计算过程中的不足之处。</p>
<h4 id="打赏"><a href="#打赏" class="headerlink" title="打赏"></a>打赏</h4><p>如果感觉本文对你的相关研究有帮助，欢迎打赏，支持作者的热心付出。如果你也有自己的骚操作，热烈欢迎无私分享，可以通过QQ联系（122103465）</p>
<p><img src="/2020/09/08/A18/打赏码.jpg" style="zoom:25%;"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2020/08/31/A17/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/31/A17/" class="post-title-link" itemprop="url">ASE的骚操作系列</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-31 20:30:16" itemprop="dateCreated datePublished" datetime="2020-08-31T20:30:16-04:00">2020-08-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2020/08/31/A17/" class="post-meta-item leancloud_visitors" data-flag-title="ASE的骚操作系列" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/08/31/A17/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/08/31/A17/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>对科研狗们来说，ASE不是Automotive Service Excellence的缩写，而是Atomic Simulation Environment。<br>是一款基于Python语言的工具软件，可以方便地处理DFT计算中结构搭建，准备输入文件准备，读取输出文件，既可以可视化，又可以用来转换文件格式。本文主要介绍ASE在DFT计算中的骚操作。这个”骚”字让我想起来小学的时候，同桌读了屈原的《离骚》，然后转过头来用这个字来笑话我，说我真骚。我被憋的满脸通红却不知如何反驳。骚就骚吧，骚前面加个<code>离</code>可以千古流传，那么我相信，它后面加个<code>操作</code>也可以对大家日常的计算有所帮助。<br>首先声明：本教程具有自动过滤功能。每次过滤的时候，我都会提醒一下，以防你被滤纸卡住。但如果你读完教程却不能顺利进行操作，请不要找我，请分解自己让自己滤下去。</p>
<p><strong>滤纸-1</strong>： ASE成功安装了没？ （<a target="_blank" rel="noopener" href="https://wiki.fysik.dtu.dk/ase/install.html）被卡住就不要继续喽！">https://wiki.fysik.dtu.dk/ase/install.html）被卡住就不要继续喽！</a></p>
<p>今天我们讲的骚操作就是用ASE来进行格式转换。这也是本人日常用的最多的一个，最稳定也最方便的一个操作。既然是操作，那么就举个栗子吧：</p>
<p>例子1）：将mol文件转化为xyz。 </p>
<p>首先在Chemspider数据库中，下载一个乙烷3D构型的mol文件。</p>
<p><strong>滤纸-2</strong>：Chemspider 是啥玩意，怎么下载mol文件？ 之前教程有讲过，不会的找百度。被卡住就不要继续喽！</p>
<p>操作过程： </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbro:~/Downloads$ ls</span><br><span class="line">6084.mol</span><br><span class="line">qli@bigbro:~/Downloads$ head -n 13 6084.mol </span><br><span class="line">6324</span><br><span class="line">  Marvin  12300703363D          </span><br><span class="line"></span><br><span class="line">  8  7  0  0  0  0            999 V2000</span><br><span class="line">    0.7686    0.0000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0</span><br><span class="line">   -0.7686   -0.0000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0</span><br><span class="line">    1.1430    1.0253    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0</span><br><span class="line">    1.1430   -0.5127    0.8880 H   0  0  0  0  0  0  0  0  0  0  0  0</span><br><span class="line">    1.1430   -0.5127   -0.8880 H   0  0  0  0  0  0  0  0  0  0  0  0</span><br><span class="line">   -1.1430   -1.0253    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0</span><br><span class="line">   -1.1430    0.5127   -0.8880 H   0  0  0  0  0  0  0  0  0  0  0  0</span><br><span class="line">   -1.1430    0.5127    0.8880 H   0  0  0  0  0  0  0  0  0  0  0  0</span><br><span class="line">  1  2  1  0  0  0  0</span><br><span class="line">qli@bigbro:~/Downloads$ ase gui 6084.mol  -o C2H6.xyz </span><br><span class="line">/home/qli/.local/lib/python3.8/site-packages/ase/gui/ag.py:85: UserWarning: You should be using &quot;ase convert ...&quot; instead!</span><br><span class="line">  warnings.warn(&#x27;You should be using &quot;ase convert ...&quot; instead!&#x27;)</span><br><span class="line">(qrobot) qli@bigbro:~/Downloads$ cat C2H6.xyz </span><br><span class="line">8</span><br><span class="line">Properties=species:S:1:pos:R:3 pbc=&quot;F F F&quot;</span><br><span class="line">C        0.76860000       0.00000000       0.00000000</span><br><span class="line">C       -0.76860000      -0.00000000       0.00000000</span><br><span class="line">H        1.14300000       1.02530000       0.00000000</span><br><span class="line">H        1.14300000      -0.51270000       0.88800000</span><br><span class="line">H        1.14300000      -0.51270000      -0.88800000</span><br><span class="line">H       -1.14300000      -1.02530000       0.00000000</span><br><span class="line">H       -1.14300000       0.51270000      -0.88800000</span><br><span class="line">H       -1.14300000       0.51270000       0.88800000</span><br><span class="line">qli@bigbro:~/Downloads$ ase gui C2H6.xyz </span><br><span class="line">qli@bigbro:~/Downloads$ </span><br></pre></td></tr></table></figure>
<p>我们成功用ase gui 将mol转化为了xyz文件。</p>
<p>1） 每次运行都会出现那行警示信息，让你用ase convert转化。命令如下：</p>
<p>ase convert -i mol -o xyz 6084.mol  C2H6.xyz </p>
<p>这个命令比较长，输入起来烦人，远远不如ase gui 干脆利落。警告信息就用你那高度近视镜自行滤过吧。</p>
<p>2)  <code>-o</code>  中的字母<code>o</code>是out的缩写，意思是输出。  </p>
<p>3） ase gui 后面跟一个文件，可以直接可视化。</p>
<p>学会了<code>ase gui</code>的命令操作，下面我们需要进一步分解自己，以便透过更多的滤纸。</p>
<p><strong>滤纸-3</strong>： </p>
<p>DFT计算中有很多的文件格式，VASP有POSCAR(CONTCAR)，Gaussian有gjf或者com，Material Studio导出来可以有cif啥的。这些格式之间转换着实让一些新手头疼。以至于经常在群里看到有人询问类似的问题。如果你没有用文本编辑器打开这些格式的文件，并认真分析下它们的数据结构，那么你被滤纸卡住了。请把自己变小一些再继续阅读。</p>
<p>分析一下上面的操作：<code>ase gui  6084.mol -o C2H6.xyz</code></p>
<p>6084.mol 是我们读取的对象，C2H6.xyz 是输出的文件。回到大家常用的VASP计算上来，cif文件文件都不陌生，那么我们就转化一下它吧。</p>
<p><strong>例子-2： 将CIF转化为XYZ，POSCAR</strong></p>
<p>首先从Materials Project 下载一个干冰的cif文件。</p>
<p><strong>滤纸-4</strong>：如果你不知道啥是MP。打开这个网址：<a target="_blank" rel="noopener" href="https://materialsproject.org，注册，随便下载个cif文件。">https://materialsproject.org，注册，随便下载个cif文件。</a></p>
<p>操作过程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbro:~/Downloads$ ls</span><br><span class="line">6084.mol  C2H6.xyz  CO2_mp-20066_conventional_standard.cif</span><br><span class="line">qli@bigbro:~/Downloads$ head -n 5 CO2_mp-20066_conventional_standard.cif </span><br><span class="line"></span><br><span class="line"># generated using pymatgen</span><br><span class="line"></span><br><span class="line">data_CO2</span><br><span class="line">_symmetry_space_group_name_H-M   &#x27;P 1&#x27;</span><br><span class="line">_cell_length_a   5.80269900</span><br><span class="line">_cell_length_b   5.80269900</span><br><span class="line">qli@bigbro:~/Downloads$ ase gui CO2_mp-20066_conventional_standard.cif -o CO2_mp-20066.xyz </span><br><span class="line">/home/qli/.local/lib/python3.8/site-packages/ase/gui/ag.py:85: UserWarning: You should be using &quot;ase convert ...&quot; instead!</span><br><span class="line">  warnings.warn(&#x27;You should be using &quot;ase convert ...&quot; instead!&#x27;)</span><br><span class="line">qli@bigbro:~/Downloads$ ls</span><br><span class="line">6084.mol  C2H6.xyz  CO2_mp-20066_conventional_standard.cif  CO2_mp-20066.xyz</span><br><span class="line">qli@bigbro:~/Downloads$ cat CO2_mp-20066.xyz </span><br><span class="line">12</span><br><span class="line">Lattice=&quot;5.802699 0.0 0.0 0.0 5.802699 0.0 0.0 0.0 5.802699&quot; Properties=species:S:1:pos:R:3 spacegroup=&quot;P 1&quot; unit_cell=conventional pbc=&quot;T T T&quot;</span><br><span class="line">C        0.00000000       0.00000000       0.00000000</span><br><span class="line">C        2.90134950       0.00000000       2.90134950</span><br><span class="line">C        2.90134950       2.90134950       0.00000000</span><br><span class="line">C        0.00000000       2.90134950       2.90134950</span><br><span class="line">O        0.67853280       0.67853280       0.67853280</span><br><span class="line">O        2.22281670       5.12416620       3.57988230</span><br><span class="line">O        3.57988230       2.22281670       5.12416620</span><br><span class="line">O        5.12416620       3.57988230       2.22281670</span><br><span class="line">O        5.12416620       5.12416620       5.12416620</span><br><span class="line">O        3.57988230       0.67853280       2.22281670</span><br><span class="line">O        2.22281670       3.57988230       0.67853280</span><br><span class="line">O        0.67853280       2.22281670       3.57988230</span><br><span class="line">qli@bigbro:~/Downloads$ ase gui CO2_mp-20066_conventional_standard.cif -o POSCAR </span><br><span class="line">/home/qli/.local/lib/python3.8/site-packages/ase/gui/ag.py:85: UserWarning: You should be using &quot;ase convert ...&quot; instead!</span><br><span class="line">  warnings.warn(&#x27;You should be using &quot;ase convert ...&quot; instead!&#x27;)</span><br><span class="line">qli@bigbro:~/Downloads$ cat POSCAR </span><br><span class="line"> C  O </span><br><span class="line"> 1.0000000000000000</span><br><span class="line">     5.8026989999999996    0.0000000000000000    0.0000000000000000</span><br><span class="line">     0.0000000000000000    5.8026989999999996    0.0000000000000000</span><br><span class="line">     0.0000000000000000    0.0000000000000000    5.8026989999999996</span><br><span class="line">   4   8</span><br><span class="line">Cartesian</span><br><span class="line">  0.0000000000000000  0.0000000000000000  0.0000000000000000</span><br><span class="line">  2.9013494999999998  0.0000000000000000  2.9013494999999998</span><br><span class="line">  2.9013494999999998  2.9013494999999998  0.0000000000000000</span><br><span class="line">  0.0000000000000000  2.9013494999999998  2.9013494999999998</span><br><span class="line">  0.6785328048660000  0.6785328048660000  0.6785328048660000</span><br><span class="line">  2.2228166951340000  5.1241661951339994  3.5798823048659996</span><br><span class="line">  3.5798823048659996  2.2228166951340000  5.1241661951339994</span><br><span class="line">  5.1241661951339994  3.5798823048659996  2.2228166951340000</span><br><span class="line">  5.1241661951339994  5.1241661951339994  5.1241661951339994</span><br><span class="line">  3.5798823048659996  0.6785328048660000  2.2228166951340000</span><br><span class="line">  2.2228166951340000  3.5798823048659996  0.6785328048660000</span><br><span class="line">  0.6785328048660000  2.2228166951340000  3.5798823048659996</span><br><span class="line">qli@bigbro:~/Downloads$ ase gui POSCAR </span><br><span class="line">qli@bigbro:~/Downloads$ </span><br></pre></td></tr></table></figure>
<p>OK，大功告成。可以拖到服务器提交任务了。值得注意的是，ASE输出的POSCAR总是把元素行放在第一行的位置，类似于VASP4的POSCAR格式，如果不爽的话，</p>
<p>1） 自行修改为VASP5/6的POSCAR格式。</p>
<p>2） 也可以修改ASE的源代码，</p>
<p>2.1） 找到ASE的安装目录，打开 <code>ase/io</code> 目录下的<code>vasp5.py</code> 文件；</p>
<p>2.2） 将<code>vasp.py</code>中<code>vasp5 = False</code> 全部改为<code>vasp5 = True</code>；</p>
<p>2.3） 保存<code>vasp.py</code> 即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbro:~/anaconda3/lib/python3.8/site-packages/ase/io$ pwd</span><br><span class="line">/home/qli/anaconda3/lib/python3.8/site-packages/ase/io</span><br><span class="line">qli@bigbro:~/anaconda3/lib/python3.8/site-packages/ase/io$ grep vasp5 vasp.py</span><br><span class="line">    vasp5 = True</span><br><span class="line">        vasp5 = True</span><br><span class="line">    if not vasp5:</span><br><span class="line">               symbol_count=None, long_format=True, vasp5=True,</span><br><span class="line">    if vasp5:</span><br><span class="line">qli@bigbro:~/anaconda3/lib/python3.8/site-packages/ase/io$ cd ~/Downloads/</span><br><span class="line">qli@bigbro:~/Downloads$ ls</span><br><span class="line">6084.mol  C2H6.xyz  CO2_mp-20066_conventional_standard.cif  CO2_mp-20066.xyz  POSCAR</span><br><span class="line">qli@bigbro:~/Downloads$ ase gui CO2_mp-20066_conventional_standard.cif  -o POSCAR</span><br><span class="line">/home/qli/.local/lib/python3.8/site-packages/ase/gui/ag.py:85: UserWarning: You should be using &quot;ase convert ...&quot; instead!</span><br><span class="line">  warnings.warn(&#x27;You should be using &quot;ase convert ...&quot; instead!&#x27;)</span><br><span class="line">qli@bigbro:~/Downloads$ head -n 6 POSCAR</span><br><span class="line"> C  O</span><br><span class="line"> 1.0000000000000000</span><br><span class="line">     5.8026989999999996    0.0000000000000000    0.0000000000000000</span><br><span class="line">     0.0000000000000000    5.8026989999999996    0.0000000000000000</span><br><span class="line">     0.0000000000000000    0.0000000000000000    5.8026989999999996</span><br><span class="line">   C   O</span><br></pre></td></tr></table></figure>
<p>如果有其他的需求，可以继续研究ASE或者等后面的骚操作。再继续分解自己：怎么才能把其他格式的文件转化成我需要的格式呢？</p>
<p>上文中的例子已经给你足够的启发了。</p>
<p>妹妹你大胆地往前走<br>往前走 莫回呀头<br>通天的大路 九千九百<br>九千九百九呀<br>……</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2019/12/22/ex85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/12/22/ex85/" class="post-title-link" itemprop="url">ex85 中间体的优化</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-12-22 20:30:16" itemprop="dateCreated datePublished" datetime="2019-12-22T20:30:16-05:00">2019-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2019/12/22/ex85/" class="post-meta-item leancloud_visitors" data-flag-title="ex85 中间体的优化" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2019/12/22/ex85/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/12/22/ex85/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>本节主要给大家介绍一下中间体计算的具体流程。</p>
<p>计算中间体前的准备：</p>
<p>1）催化剂表面模型的结构以及性质自己多多了解；表面原子排列，谁带正电荷，谁带负电荷，原子间距等等，这些基本的东西自己心里要有数；没事可以整理到表格或者ppt里面，方便以后写文章用；</p>
<p>2） 表面上可能发生的反应路径，各个基元反应，自己列举出来，整理归类方便以后分析。</p>
<p>3）反应路径中各种可能分子的吸附结构先优化完成，通过这些基本分子的吸附能，吸附结构，对体系大体了解一下，一方面参考文献中别人提到的反应路径，另一方面添加自己认为可能的情况。</p>
<p>关键点：</p>
<p>中间体的优化和前面我们讲到的分子或者原子在表面上的优化是一样的。意思就是计算分子吸附的时候，基本的操作同样适用于中间体的优化。可以分布算，先从粗糙的精度出发，然后慢慢提高精度。注意的一点：</p>
<p>对于计算速度的影响：</p>
<p>1） KPOINTS：先把slab固定住，用（1x1x1）的K点对刚刚搭建的中间体结构预优化一下（基本上跑个NSW = 60就差不多了）得到一个理想的初始结构，然后再增加K点密度，放开slab的表层原子，继续优化；</p>
<p>2）EDIFF，EDIFFG：这两个参数主要影响电子步和离子步的步数，当我们用低密度的K点进行计算的时候，电子步很快收敛，离子步收不收敛我们也不在乎，所以在这一步的时候，不用对这两个参数太较真；关键在于增加K点后，我们选取一个什么样的标准，既得到理想的结构和能量，也避免了服务器做无意义的计算；</p>
<p>3）ISPIN：体系需要考虑磁性的话，粗优化的时候，可以先关掉。后面提高精度后，记得加上就可以了。</p>
<p>4）NCORE等并行参数也不要忘记加上，详细参考：</p>
<p>熟练掌握不同精度下这几个参数的使用，可以极大地提高你的计算效率，节省机时。前面说的这些，基本上试用大部分的体系，但还是要靠大家自己多多测试，摸索一下最适合自己体系的方法。</p>
<p>本节主要取表面上：CH3OH —&gt; CH3O —&gt; CH2O 这两步来简单介绍，下图中圈出来的两步；其他的路径照着葫芦画瓢就行了。<img src="/2019/12/22/ex85/ex85.png" alt=""></p>
<p> 第一步：CH3OH —&gt; CH3O + H </p>
<p>1）反应产物为表面上的甲氧基（CH3O*）和氢原子（H*)， CH3O* 可以继续进行C—H键断裂，或者C—O键断裂，生成CH3*+O<em> 或者CH2O\</em> + H*。</p>
<p>注意：这里你应该可以想象到反应网络的复杂性，从一个反应物出发可以有多个不同类型的基元反应，产物作为下一步的反应物，也会有不同类型的反应，导致整个反应网络变得越来越复杂，最后交叉合并，汇总到最基本的分解产物上来。这里我们用的是甲醇，当分子C链增长的时候，基元反应的数目就会急剧增加，增加到我们挨个算不能完成的情况，这也是我们为啥要研究BEP关系的原因。另一个原因就是，成千上万个反应，整天瞎算过渡态，有时候你并不会学到太多新鲜事物，只是重复搬砖的工作，对我们以后的成长不利。</p>
<p>2）H原子的吸附，我们就跳过吧，相信大家经过前面的学习，应该都会了。计算CH3O的结构，我们可以从CH3OH的POSCAR出发，进行下面几点思考：</p>
<p>A) 删除POSCAR中对应H原子的坐标，保存为新的POSCAR，即表面上只有CH3O，提交任务进行优化；</p>
<p>B) CH3OH的结构中，O是在一个top的位置上，但O—H 键断裂之后，O的成键能力增强了，还会继续呆在top位置上么？所以，我们要把OCH3挪到bridge, hcp, fcc 位点上，得到几个不同的结构，提交任务进行优化；</p>
<p>C) 前面我们的结构OCH3是斜着在表面上；会不会有直立的结构？ OCH3是通过O与表面结合，我们是不是可以参考O原子在表面的吸附结构；搭建OCH3直立的吸附结构？</p>
<p>D）前面说的这几点，我们都可以通过前面所说的关键点，用一个粗糙的模型扫描一遍。然后大致分析下结果，然后进行下一步的计算，最终得到稳定的OCH3在表面上的稳定结构。</p>
<p>第二步：CH3O —&gt; CH2O + H</p>
<p>这一步，从甲氧基进行了一步C—H反应，得到了甲醛和H。H的话继续跳过；甲醛的话，这里我们应该也需要跳过；因为甲醛是一个分子，在计算中间体前的准备这一步中，我们应该已经完成。安全起见，我们也列举一下几点需要注意的结构搭建工作：</p>
<p>1） 甲醛分子以C，以O还是C=O双键与表面结合？</p>
<p>2） 以不同部分与表面结合的时候，会在哪个位点上？</p>
<p>3）垂直？斜着，还是平行吸附？</p>
<p>总之，尽可能多思考不同的表面结合方式，采用粗糙的模型快速进行筛选，也要实时思考，粗糙模型会不会对这样的快速筛选产生影响？会不会漏掉什么可能的结构？</p>
<p>后面的过程依次类推，直至甲醇分子分解为最基本的化学单元(H，C, O)。</p>
<hr>
<p>下面介绍另外一种中间体模型，首先回顾一下上面搭建CH$_3$OH—&gt; CH$_3$O + H这一个反应中间体的过程：（这里我们先定义这个中间体模型为：A）</p>
<p>1) 从CH$_3$OH的POSCAR出发，</p>
<p>i) 删除POSCAR中与O相连的H原子的坐标，此时表面上只有CH$_3$O的结构，且CH$_3$O位于top位上；</p>
<p>ii) 稍微修改一下OCH$_3$的结合位点，尝试一下附近的hcp，fcc，或者bridge位点上CH$_3$O的结构，并分别保存到不同文件夹里面；</p>
<p>iii) 提交任务计算，并对比不同OCH3结构的能量，取最低的那个。</p>
<p>iV) 第ii）步中我们暴力直接删掉H原子，基于的假设是一旦O—H键断裂后，产物之间（CH$_3$O<em>, H</em>）互不影响。</p>
<p>另外一种中间体模型（设为：B）长什么样子呢？</p>
<p>1） OCH$_3$的结构与前面A的模型一样，有top，fcc，hcp，bri各种尝试的结构；</p>
<p>2） 除此之外，CH$_3$OH 中与O相连的H也在OCH$_3$ 附近。</p>
<p>也就是说，在A 模型中，我们直接删掉H原子，而在B模型中，我们只是断开O—H 键，H还留在表面上。也即是B模型保持了与反应物分子相一致的原子种类以及数目。</p>
<p>这两个办法有什么区别呢？哪个更好些?</p>
<p>我们先分析下B)的模型：它比A模型多了一个H，可以认为H 吸附在A模型上；因此A中CH$_3$O的存在会对H的吸附能产生影响，一方面来源CH$_3$O对催化剂电子结构的影响，另一方面来自与空间的影响，类似于前面我们学习过的覆盖度对O原子吸附的影响。因此我们可以计算并对比H在纯净slab和A上面的吸附能。 </p>
<p>$\Delta E<em>{ads}$ =$E</em>{ads}^{slab}$ -$E<em>{ads}^{A}$  = [$E</em>{H<em>}$  - $E<em>{Slab}$ - $E</em>{H<em>2}/2$]  -  [$E</em>{CH_3O</em>+H<em>}$  - $E_{CH_3O</em>}$ - $E_{H_2}/2$] </p>
<p>= ($E<em>{H*}$ + $E</em>{CH<em>3O*}$) - ($E</em>{Slab}$ + $E_{CH_3O<em>+H</em>}$)</p>
<p>A和B模型的区别为： 将$CH_{3}O$ 和 H 分离到无穷远时候的体系能量的变化。</p>
<p>再看一下A和B两个模型中反应热的计算：</p>
<p>A)模型：$\Delta$E(A) =  $E<em>{CH_3O*}$ + $E</em>{H<em>}$ - $E_{CH_3OH</em>}$ -  $E_{slab}$</p>
<p>B)模型：$\Delta$E(B) =  $E<em>{CH_3O<em> + H</em>}$ - $E</em>{CH_3OH*}$ </p>
<p>反应热的差：</p>
<p>$\Delta$E(A) - $\Delta$E(B) = $E<em>{CH_3O*}$ + $E</em>{H<em>}$  - ($E<em>{Slab}$ + $E</em>{CH_3O</em>+H*}$) = $\Delta E_{ads}$</p>
<p>通过上面的分析，我们得到同样的结果，即两个体系模型的区别主要在于产物之间的相互作用。如果产物之间相互作用弱，可以认为彼此相差甚远，互不影响，也就是A模型，这也是大部分人在计算过程中常常采用的方法。例子有很多，就不一一介绍了，随便取一个： <em>ACS Catal.</em> 2014, 4, 11, 4178–4188。有兴趣的可以去看看。</p>
<p>对于B模型，可以从表面覆盖度对反应的影响这一角度来分析，在键断裂后，如果产物与催化剂结合较强，来不及扩散至互不影响，那么局部的覆盖度就会增加，从而对后面的反应产生影响。有兴趣的可以参考一下这两篇文章：</p>
<p><em>ACS Catal.</em> 2015, 5, 1, 104–112； <em>ACS Catal.</em> 2014, 4, 6, 1991–2005。</p>
<p>覆盖度对表面反应的影响很复杂，一般人也不愿意碰，但是在计算过渡态相关的操作过程中，B模型却发挥着重要的作用。可以从下面2个角度来分析：1）过渡态插点的技术角度 以及2）获取合理过渡态的角度。这些将会在下一节分析。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2019/12/22/ex84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/12/22/ex84/" class="post-title-link" itemprop="url">Ex84 计算模型的注意事项</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-12-22 15:30:16" itemprop="dateCreated datePublished" datetime="2019-12-22T15:30:16-05:00">2019-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2019/12/22/ex84/" class="post-meta-item leancloud_visitors" data-flag-title="Ex84 计算模型的注意事项" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2019/12/22/ex84/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/12/22/ex84/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>上一节我们简单介绍了一下搬砖的原则性问题。这一节，我们主要分析下搬什么砖的问题。继续采用甲醇在金属表面上分解的这个例子。物化书中我们学过表面反应的基本步骤： 1）反应物分子的吸附；2）表面反应； 3） 产物脱附。</p>
<p>甲醇分解反应第一步是先从气相吸附到催化剂金属表面。 对于这一步， 我们自然需要从甲醇的气相分子出发，研究甲醇分子在表面上的吸附结构。其中涉及到一些基本的计算细节：</p>
<p>1） 如何优化气相分子的结构，计算频率呢？</p>
<p>2）如何优化体相结构，切面，优化，计算表面相关性质：比如表面能、功函数等。</p>
<p>这些我们前面也已经讲过了，所以直接跳过。</p>
<p>这里还有一个问题在于，你去用什么表面去模拟催化剂？ 比如说Cu，可以有(111), (110), (100), (211)….等各种不同的指数面，你选哪个来算？为什么选这个来算？这涉及到：我们的研究对象是什么？通过研究这一对象，我们要解释什么？期望获得什么样的结果？对于催化反应来说，我们的研究对象有2个：催化剂和它所催化的反应。</p>
<p>如何获得催化剂的合理模型就是一个至关重要的问题了。一般来说，有下面几个供大家参考的办法：</p>
<p>1）选稳定的表面，也就是表面能低的那个，对于纳米颗粒来说，尺寸如果够大，那么表面能低的表面原子在所有暴露的表面原子中的比例会高，那么可以近似用这个面来模拟催化剂的情况；那么尺寸多大才算足够大呢？</p>
<p>我们可以尝试着从两个极端来进行思考：我们的催化剂如果是金属的话，如果采用一个单金属原子作为催化剂模型，可以想象吸附能肯定很大。当原子慢慢堆积成团簇，团簇再慢慢长到无穷大的时候，吸附能也随之发生变化。我们取无穷大时（最稳定的表面）的吸附能（E0）作为参考，看看金属团簇多大尺寸的时候，吸附能跟E0接近。那么该尺寸以及更大的纳米颗粒就可以用无穷大的催化剂模型来模拟，也就是最稳定的表面。一般来说，纳米颗粒的直径大于2nm（胆儿肥的）的时候，可以用最稳定的表面来模拟催化剂。保守些，直径大约3nm的时候可以放心地去用，不会有什么问题。</p>
<p>下面推荐一本书： Fundamental Concepts in Heterogeneous Catalysis 。书中第21页， 作者用O在Pt(111)表面的吸附能作为参考，测试了不同纳米颗粒尺寸时的吸附能，发现直径在2nm的时候，已经非常接近了。前面说的那个2nm，也是从这里来的。如果你想问我这本书从哪里可以下载，可以关注公众号：BigBroScience，然后回复：ex84 。</p>
<p><img src="/2019/12/22/ex84/ex84-1.png" alt=""></p>
<p>2）对于前面的一番说法， 也会有人说，催化剂的活性位不一定在平坦的表面上，边边角角，台阶上可能更容易发生反应。如果你单纯把工作聚集在最稳定的表面上，肯定会遗漏些什么？这也是很多审稿人喜欢折腾我们这些小白鼠的地方。一个金属有很多不同的指数面，单纯考虑最稳定的是一个保险折中的办法。因为不管你的体系搞的再复杂，跟真实情况相比，模型终究是简单的。我们只是尽自己可能去尝试着理解，解释实验的现象，描述下体系的性质，以及进行一些比较简单直接的预测。但是，如果你要深究这些，兴趣也恰好落在在这一块，那么可以对体系的各个相关结构进行一个全面的计算，分析不同表面结构，性质，反应活性有什么不同。在这个全面的计算体系中，</p>
<p>除了各种台阶面，最稳定的表面你还是要算的，这样才能有个对比。原则上说，只要你力气足够，资源充足，可以选任何你想要的表面来计算；但问题是你总会有吐的时候，如果想多算几个面的时候，要留意下面的几点：</p>
<p>注意-1：开放的表面在计算表面能，slab优化或者吸附的时候，层数的影响会很大，这个前期的测试工作要做好；</p>
<p>注意-2：生存法则：</p>
<p>A）灌水第一条：同一个反应， 这个指数面算一下发一篇文章，换个面再发篇文章，再换个面继续发文章….</p>
<p>B）灌水第二条：同一个面： 算一个反应发一篇文章，换个反应算一下再发一篇文章，再换反应；</p>
<p>C）灌水第三条：反应，表面和反应交替，排列组合式发文章。</p>
<p>3）还有一种情况，就是我们手上有实验数据，想模拟一下实验的结果。这个时候，就可以参考下催化剂的表征结果，有针对性地选取催化剂的模型，使其尽可能地去描述催化剂的结构。</p>
<p>注意的有以下几点：</p>
<p>A) 如果做实验的人找你帮忙算个东西，能推掉就推掉，别在上头浪费自己的功夫，顶死也就是个共同一作，国内基本不认可，做无用功；如果刚开始推不掉，就看看他的实验表征结果，一般般的表征以模型搭不出来为由直接拒掉；好的模型是成功的重要因素。前面我们说了，模型再复杂也是简单的。再考虑到实验表征的结果不确定性，你有很大的几率是跟实验上对不上的，到头还是白忙活。很多人会拿工作要冲子刊，杰克斯，俺狗娃为由诱惑你上船，要掂掂自己的分量，别头脑发热用屁股做决定。</p>
<p>B) 对于做实验的人来说，99%会低估计算的复杂性，总以为鼠标点点就OK的事情，其中也不乏一些所谓的大牛们。话虽然难听，却也是大实话：不要瞎几把评论自己不懂的领域。真想找人算一下，要找个靠谱的合作伙伴，找到不靠谱的瞎算，投文章更会给整个工作拉分。</p>
<p>4）最后一个及其重要的就是，认真进行文献调研。看看前人都是怎么选取的，为什么这样选？根据什么依据来选？最终确定自己的计算模型。</p>
<p>关于模型的一些就先到这儿， 本篇的工作主要是重复一遍前人已经算烂的反应，然后在此基础上，分析BEP和TSS线性关系。就直接拿各个金属最稳定的表面来计算了。那么， 什么是BEP线性关系？ 这里的BEP的全称是：Bell–Evans–Polanyi principle. 指的是对于同一类型的N个反应，这些反应的能垒和反应热之间存在的一个线性关系: $E_a$= $\alpha \Delta E$ + $\beta$ 。更详细点的介绍，参考维基百科搜索：Bell–Evans–Polanyi principle。起初这个关系是基于均相反应来说的。在2000年的时候，Neurock将这个关系引入多相催化体系，发现表面反应也存在这一关系。随后，经过了Norskov等人的继续研究，相关的文章就越来越多了。有兴趣的可以通过下面的几篇经典文献开始接触，然后再逐渐深入：J. Catal. 191, 301 (2000)，  J. Catal. 197, 229 (2001)， J. Chem. Phys. 114, 8244 (2001)</p>
<p>BEP关系有啥用呢？主要有两点:</p>
<p>关键的一点就是用来节约机时：过渡态不是一个稳定的结构，它的优化需要的计算时间比直接优化反应物种的要多得多。插8个点，也就是8倍的单个优化。再加上计算还经常容易失败。因此我们可以通过BEP关系，跳过TS的优化，直接预测反应的能垒，从而达到节约机时和生命的作用。这个方法简单粗暴，与直接进行反应路径扫描相比，在时间成本上具有压倒性的优势，但精度和准确度上就会稍逊一筹。</p>
<p>另外一点是来预测反应的能垒，这个其实和上面的有些重复，但角度不同。比如一个复杂的催化体系，基元反应数目成千上万，我们挨个算过渡态显然不可行。但是中间体的数目明显少的多，那么我们通过中间体获取反应热之后，通过BEP关系得到反应能垒，也就有了动力学的一些基本数据，从此出发，可以做一些机器学习以及微观反应动力学的模拟工作。从而跨越理论计算的原子分子尺度来到达一个更为宏观的尺寸和时间的尺度，也就是所谓的多尺度模拟。</p>
<p>继续前面的分析，如果中间体的数目也很多，算都算不完，那该怎么办？这个也可以通过一些线性组合，数据分析的方法来进行预测。比如通过Group Additivity的方法，可以将对分子中不同group的能量的求和来获得。具体的内容在后面其他章节再慢慢进行介绍。由于篇幅关系，本节（ex84的上半部分）主要是让大家对自己的研究对象有一个明确的认识，为什么研究它？为什么不研究别的？下半部分介绍中间体计算的一些注意事项。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2019/10/15/S06/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/10/15/S06/" class="post-title-link" itemprop="url">高阶弹性常数计算的一点建议</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-10-15 19:30:16" itemprop="dateCreated datePublished" datetime="2019-10-15T19:30:16-04:00">2019-10-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:29:58" itemprop="dateModified" datetime="2021-12-27T22:29:58-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Share/" itemprop="url" rel="index"><span itemprop="name">Share</span></a>
        </span>
    </span>

  
    <span id="/2019/10/15/S06/" class="post-meta-item leancloud_visitors" data-flag-title="高阶弹性常数计算的一点建议" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2019/10/15/S06/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/10/15/S06/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在线弹性理论中，体系被施加一个无穷小的应变，从而体系应变后的能量可以以小应变为自变量泰勒展开，并忽略二阶导以上的高阶项。通过对不同特定的独立的应变模式求解能量应变方程或者应力应变方程，我们可以获得材料所有的二阶弹性常数（SOECs）。SOECs反映了体系的简谐弹性特征。通过SOECs，一方面我们可以获得体系的基于Vogit-Reuss-Hill平均的多晶力学性能，包括杨氏模量，剪切模量，体积模量，泊松比和维氏硬度等，以及在此基础之上的各向异性系数等等特征；另一方面，我们也可以通过SOECs获得单晶力学性能在空间中的具体分布，并将其用图的模式直观的表示出来。</p>
<p><img src="/2019/10/15/S06/share06/share061.png" alt=""></p>
<p>图中我们展示了某种金属的杨氏模量和剪切模量（每个面的平均值）的空间分布图，感兴趣的读者可以猜猜这是哪种布拉维晶型的金属。</p>
<p>在实际负载下，材料承受的往往是有限形变，这时候材料的非简谐弹性将称为不可忽视的因素。很多实验数据有去测量体系的三阶弹性常数（TOECs），甚至四阶弹性常数（FOECs）。注意到TOECs和FOECs相对比SOECs在实验中更加受到实验精度的影响，具体的测量非常困难。如果我们能在理论上对其进行预测，将变得非常有意义。实际上已经有若干文献进行了相关研究，笔者也抱着好奇的态度尝试进行了TOECs和FOECs的计算。原理上来说相对简单，我们只需要将能量对应变进行泰勒展开，将阶次保留到四次，即可同时获得SOECs，TOECs和FOECs。</p>
<p><img src="/2019/10/15/S06/share06/share062.png" alt=""></p>
<p>将所有的应变η设为同一个数值，我们就可以用一个包含四次，三次和二次项的多项式来拟合计算的数据，获得包含各个弹性常数的多元一次方程组。求解这个这个方程组即可获得所有的弹性常数。</p>
<p>不过实际操作起来并没有这么简单。即使是最简单的立方体系，其TOECs也达到了6个，而FOECs更是达到了11个。对于更低对称性的体系，其计算量更是一个天文数字（开玩笑的，天文倒不至于，很大就是了）。一种避让的方法就是，我们可以用应力对应变进行展开，这样相对需要的独立应变数少一些。笔者使用Au作为测试体系，根据文献对体系施加了11种独立应变，如下图。</p>
<p><img src="/2019/10/15/S06/share06/share063.png" alt=""></p>
<p>感兴趣的童鞋可以直接阅读文末给的参考文献。笔者通过测试发现，首先，体系的应变量必须足够大。笔者一开始犯上了计算SOECs的习惯，使用的很小的应变，计算结果简直南辕北辙。后来将应变加到15%后，获得的TOECs相对理想。细想也是，应变很小时，体系还处于线弹性阶段，这时候的非谐弹性非常微弱，极容易被数值误差干扰。将应变加大到非谐区后，数值就非常稳定了。同时，尽管我们使用了大应变条件，但是实际上高阶弹性常数的具体数值依旧会对数值精度的波动非常敏感。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Au/GPa</th>
<th>C111</th>
<th>C112</th>
<th>C123</th>
<th>C144</th>
<th>C155</th>
<th>C456</th>
</tr>
</thead>
<tbody>
<tr>
<td>exp</td>
<td>-1730</td>
<td>-922</td>
<td>-233</td>
<td>-13</td>
<td>-648</td>
<td>-12</td>
</tr>
<tr>
<td>mine</td>
<td>-1207</td>
<td>-847</td>
<td>-275</td>
<td>7</td>
<td>-616</td>
<td>62</td>
</tr>
</tbody>
</table>
</div>
<p>同文献一样，笔者使用了非常高精度的k点半径和截断能。随着精度的提高，结果趋于较好的收敛。笔者在此展示了笔者自己算的TOECs与实验的比较，两者相对来说还是比较接近的（相对实验的误差与文献差不多）。总的来说，如果有小伙伴需要计算材料的TOECs或者FOECs，笔者建议一定要对应变，k点，截断能三者都要做仔细地收敛测试。</p>
<p>Wang,Hao, and Mo Li. “Ab initio calculations of second-, third-, andfourth-order elastic constants for single crystals.” <em>PhysicalReview B</em> 79.22 (2009): 224102.</p>
<p>本文经ponychen授权发布，版权属于ponychen。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2019/10/14/S05/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/10/14/S05/" class="post-title-link" itemprop="url">浅谈Hall Petch关系(二)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-10-14 18:30:16" itemprop="dateCreated datePublished" datetime="2019-10-14T18:30:16-04:00">2019-10-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:29:41" itemprop="dateModified" datetime="2021-12-27T22:29:41-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Share/" itemprop="url" rel="index"><span itemprop="name">Share</span></a>
        </span>
    </span>

  
    <span id="/2019/10/14/S05/" class="post-meta-item leancloud_visitors" data-flag-title="浅谈Hall Petch关系(二)" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2019/10/14/S05/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/10/14/S05/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在上文中，我们介绍了用于解释Hall Petch关系的位错阻塞模型和晶界位错源模型。两种理论都是较为早期出现的模型，原理上相对简单，因此文章中仔细介绍了相对应的推导过程。本文将继续介绍剩下的相关模型，由于推理过程相对复杂，读者如果对具体推导过程有兴趣可以阅读对应参考文献。</p>
<p>上文介绍的两种模型都未在公式中直接体现材料变形中塑性应变对Hall Petch系数的影响。因此，位错阻塞模型和晶界位错源模型仅仅只能描述多晶材料在屈服极限之下的情况。我们知道，当多晶材料所受应变超过其屈服极限，材料由于位错的交截和阻碍出现了加工硬化。加工硬化势必会影响Hall Petch系数的数值。在Meakin和Petch（文献1）提出的work haraening（加工硬化）模型中，Hall Petch系数被看成是一个与应变有关的因变量。</p>
<p><img src="/2019/10/14/S05/share05/share051.png" alt=""></p>
<p>由于Hall Petch系数中包含了应变，该模型同时成功预测了材料中的加工硬化行为。如果我们将晶粒尺寸d固定，可以发现该模型描述了一种应力与应变成抛物线形状的加工硬化关系，这与很多实验是相符合的。</p>
<p>目前为止介绍的所有模型都默认认为位错来自于位错源的开动。然而实际上，当晶体被弯曲，或者在晶粒之间的交叠以及孔洞处，由于非均匀变形，晶体为了降低变形带来的巨大应力，会自发形成一些几何必须位错来释放应力。下图展示:</p>
<p><img src="/2019/10/14/S05/share05/share052.png" alt=""></p>
<p>当晶体被弯曲时，晶体中自发在易滑移面上出现的几何必须位错林。在Ashby（文献2）等提出的几何必须位错模型中，作者认为晶界作为晶体中的应力协调区，其上的位错类型主要为几何必须位错主导，并且晶体中绝大部分的几何必须位错都位于晶界上，因此材料的强度由晶界上的几何必须位错密度决定。而平衡位错密度又由晶粒尺寸决定，通过结合加工硬化模型，作者获得了如下的Hall Petch关系式。</p>
<p><img src="/2019/10/14/S05/share05/share053.png" alt=""></p>
<p>位错阻塞模型将材料的强度归功于晶粒内部位错源开动的位错受阻，而目前介绍的其他模型则都将材料的强度归功于晶界处的位错密度受阻。在这两种极端情况的基础上，Meyersm（文献3）等人认为（复合模型），一个多晶材料应该被分为两部分：连续的拥有较高流变强度的晶界部分以及被晶界包围的离散的拥有较低流变强度的块体部分（见下图4，t为晶界厚度）。</p>
<p><img src="/2019/10/14/S05/share05/share054.png" alt=""></p>
<p>当材料承受外力时，晶界部分首先发生变形，形成大量几何必须位错；随着进一步变形，晶界首先发生局部屈服形成加工硬化层，并形核大量位错向晶粒内运动；最后，随着晶粒内位错密度的上升，晶粒部分发生屈服。至此，材料整体完成了整个塑性变形过程。基于这一过程假设，作者得出了如下关系。</p>
<p><img src="/2019/10/14/S05/share05/share055.png" alt=""></p>
<p>可以发现，该关系式并非符合正常的Hall Petch关系，式子中同时出现了一次方和二次方项。作者进一步假设随着晶粒尺寸的增大，其容纳几何必须位错的数量也在上升，因此其厚度t也在上升。基于这一假设，作者得到了下图的强度与晶粒尺寸的关系。</p>
<p><img src="/2019/10/14/S05/share05/share056.png" alt=""></p>
<p>可以发现，复合模型在晶粒尺寸较大的时候可以较好的匹配Hall Petch关系，而当晶粒尺寸小到纳米级的时候，复合模型成功预测了超细晶材料的强度反常降低现象的存在。这是之前所有的理论模型都无法给出的结果。</p>
<p>实际上，在复合模型之后材料学家依旧提出了大量的理论模型，其目的也不仅仅是在于解释Hall Petch关系。由于篇幅所限，本文仅仅介绍了一些具有代表性的模型。实际上，从实验的角度来说，很多材料也并非严格遵循Hall Petch关系中-1/2指数，该指数存在一个很大的范围。对于我们来说，-1/2只是代表材料强度与晶粒尺寸联系的一个优美符号。</p>
<ol>
<li>Meakin, J., and N. J. Petch. “Report ASD-TDR-63-324.” <em>Symposium on the Role of Substructure in the Mechanical Behavior of Metals,(ASD-7DR-63-324, Orlando, 1963) pp</em>. 1963.</li>
<li>Ashby, M. F. “The deformation of plastically non-homogeneous materials.” <em>The Philosophical Magazine: A Journal of Theoretical Experimental and Applied Physics</em>21.170 (1970): 399-424.</li>
<li>Meyersm, Marc A., and E. Ashworth. “A model for the effect of grain size on the yield stress of metals.” <em>Philosophical Magazine A</em> 46.5 (1982): 737-759.</li>
<li>Kato, Masaharu. “Hall–Petch relationship and dislocation model for deformation of ultrafine-grained and nanocrystalline metals.” <em>Materials Transactions</em> 55.1 (2014): 19-24.</li>
</ol>
<p>本文经ponychen授权发布，版权属于ponychen。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">By BigBro(a)s</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"OWE4jcfK8IWkx4zaWuOloxKU-gzGzoHsz","app_key":"MRBwViAFCsPSOnnRF9LW7bdo","server_url":null,"security":true}</script>
  <script src="/js/third-party/statistics/lean-analytics.js"></script>


  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"bigbrosci-com","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({{ JSON.stringify(config) }});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="{{ src }}">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

</body>
</html>
