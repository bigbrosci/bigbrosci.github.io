<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.bigbrosci.com","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.8.2","exturl":false,"sidebar":{"position":"right","width":240,"display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta property="og:type" content="website">
<meta property="og:title" content="Learn VASP The Hard Way">
<meta property="og:url" content="http://www.bigbrosci.com/page/4/index.html">
<meta property="og:site_name" content="Learn VASP The Hard Way">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="By BigBro(a)s">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://www.bigbrosci.com/page/4/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/4/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Learn VASP The Hard Way</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Learn VASP The Hard Way</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">The 2nd edition</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">By BigBro(a)s</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">127</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">166</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/10/07/ex59/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/07/ex59/" class="post-title-link" itemprop="url">Ex59 吸附能的计算（四）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-07 02:06:48" itemprop="dateCreated datePublished" datetime="2018-10-07T02:06:48-04:00">2018-10-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/10/07/ex59/" class="post-meta-item leancloud_visitors" data-flag-title="Ex59 吸附能的计算（四）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/10/07/ex59/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/10/07/ex59/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>丑话说在前头，本节内容有点多，大家慢慢消化。掌握本节的核心思想，对于后面提高你的工作效率，节省时间有着很大的帮助。前面一节，我们在扩展练习中提到了扩胞后，原子坐标的后面T T T 和 F F F 修改的问题。因为扩展后原子坐标是按照单胞为顺序排列的，如果想要将表面的原子快速固定或者放开，那么我们就需要知道表面原子所在的行数。</p>
<h2 id="方法一：找规律-sed命令"><a href="#方法一：找规律-sed命令" class="headerlink" title="方法一：找规律+sed命令"></a>方法一：找规律+sed命令</h2><p><img src="/2018/10/07/ex59/ex59-1.png" alt=""></p>
<p>上图中，p(2x2)的POSCAR命名为POSCAR-2x2，最表层原子所在的行数为：13，17， 21， 25，次表层的原子所在的行数为： 12， 16， 20， 24。仔细分析下，你会发现，表层原子的行数为： 9 + 4<em>n ；次表层的行数为：8 + 4 </em> n，其中n = 1-4，4表示在扩完后的slab模型里面有4个(1x1)的单元。有了这个关系，我们就可以通过sed命令任意固定这两层的原子了, 命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for i in &#123;1..4&#125;; do sed -i &quot;$((8+4*$i)), $((9+4*$i))s/T T T/F F F/g&quot; POSCAR</span><br></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for i in &#123;1..4&#125;; do sed -i &quot;$((8+4*$i)), $((9+4*$i))s/T/F/g&quot; POSCAR</span><br></pre></td></tr></table></figure>
<p>效果如下图：通过sed命令快速将表层原子批量固定住。</p>
<p><img src="/2018/10/07/ex59/ex59-2.png" alt=""></p>
<p>我们还可以只放开最表层的原子，使用sed命令快速将最表层的原子批量放开！</p>
<p>在前面结果的基础上可以使用命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for  i  in &#123;1..4&#125;; do sed -i &quot;$((9+4*$i))s/ F F F/ T T T/g&quot; POSCAR</span><br></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for  i  in &#123;1..4&#125;; do sed -i &quot;$((9+4*$i))s/F/T/g&quot; POSCAR</span><br></pre></td></tr></table></figure>
<p><img src="/2018/10/07/ex59/ex59-3.png" alt=""></p>
<p>Soooo Easy！！！再也不用挨行修改T T T 或者F F F 了。</p>
<h2 id="方法二：分层处理-sed命令"><a href="#方法二：分层处理-sed命令" class="headerlink" title="方法二：分层处理+sed命令"></a>方法二：分层处理+sed命令</h2><p>什么，原来还有第二种方法？ 这种方法是本人常用的。前面我们提到，在p(2x2)的slab模型中，原子坐标是按照p(1x1)的单元排列的。既然我们想根据层数固定原子，那么我们可以先将原子按照层数来排列，这样就可以方便的选择同一层的原子了。</p>
<p>那么该怎么将它们按照层数排列呢？ 这时候你应该想到，不同层之间的原子，它们的坐标在z方向是不同的。有了这个依据，我们就可以根据z方向坐标的大小来排列原子了。</p>
<p>首先我们先用一个笨方法实现所预想的小目标。</p>
<p><strong>第一步：</strong>将坐标复制到excel表格里面。本人用的是libre office(Linux下面的Microsoft)。不过功能大同小异，Windows用户按照做就可以了。</p>
<p><strong>第二步：</strong>选中所复制的数据，然后根据图中的D列来排序。</p>
<p><img src="/2018/10/07/ex59/ex59-4.png" alt=""></p>
<p>排序完的结果, 如下图：</p>
<p><img src="/2018/10/07/ex59/ex59-5.png" alt=""></p>
<p>从图中，我们可以看出，原子根据在z方向上的坐标分成了4部分。</p>
<p><strong>注意：</strong>这里我们所有原子都是Cu原子，因此可以全部选中然后直接排序。如果你的体系中有好几种不同的原子，你需要按照元素，逐一进行排序。 比如体系中有C H O，我们先将C原子按照Z方向坐标排序，然后再排H原子的，最后再排O原子的。要保持和POSCAR前面元素顺序一致。</p>
<p>排序完成之后，将POSCAR中的坐标替换为Excel中的数据。</p>
<p><img src="/2018/10/07/ex59/ex59-6.png" alt=""></p>
<p>这样的话，我们的模型就搞定了。剩下的就是使用sed命令批量替换T T T和 F F F了</p>
<p>但是，师兄等等，上图看起来坐标很乱啊，结构能用吗？ 放心，绝对可以用。</p>
<p>如果不放心的话，可以用p4vasp打开一下，然后重新保存成POSCAR即可。最终我们的POSCAR如下图：</p>
<p><img src="/2018/10/07/ex59/ex59-7.png" alt=""></p>
<p><img src="/2018/10/07/ex59/ex59-8.png" alt=""></p>
<p>从图中可以看出来，次表层的原子在18-21行，最表层的原子在22-25行。所以可以这样使用sed命令来快速实现表层原子的固定与弛豫。</p>
<p><img src="/2018/10/07/ex59/ex59-9.png" alt=""></p>
<p><img src="/2018/10/07/ex59/ex59-10.png" alt=""></p>
<h2 id="方法三：-使用脚本分层"><a href="#方法三：-使用脚本分层" class="headerlink" title="方法三： 使用脚本分层"></a>方法三： 使用脚本分层</h2><p>师兄，这个问题竟然还可以使用脚本来解决？</p>
<p>当然了，使用鼠标拖拖点点的事情，一般都可以用脚本来实现。脚本是用python写的，本人给它起了一个高大上的响亮名字：sortcar.py。（适用于python2.6以及以上的版本，低于2.6或者python3可能会出错。）</p>
<p>由于p(2x2)的slab坐标前面已经用过了，下面我们用p(3x3)的slab来演示一下脚本的使用。</p>
<p><img src="/2018/10/07/ex59/ex59-11.png" alt=""></p>
<p>新鲜出炉的，等待被sort的p(3x3)slab的POSCAR。被sort过的POSCAR如下图：</p>
<p><img src="/2018/10/07/ex59/ex59-12.png" alt=""></p>
<p>使用sortcar.py 将坐标按照z方向大小排列。输出文件为XXX_sorted，其中 XXX为我们想要排列的POSCAR或者CONTCAR。如果你的VASP坐标结构文件名字为：BigBro，那么被sort之后，输出文件就是: BigBro_sorted。</p>
<p>脚本这么神奇，内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python </span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sys </span><br><span class="line"></span><br><span class="line">in_file = sys.argv[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">### READ input file ###</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_inputcar</span>(<span class="params">in_file</span>):</span></span><br><span class="line">    f = <span class="built_in">open</span>(in_file, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    lines = f.readlines()</span><br><span class="line">    f.close()</span><br><span class="line">    ele_name  = lines[<span class="number">5</span>].strip().split()</span><br><span class="line">    ele_num = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> lines[<span class="number">6</span>].strip().split()]</span><br><span class="line">    dict_contcar =  &#123;ele_name[i]:ele_num[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ele_name))&#125; </span><br><span class="line">    dict_contcar2 = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> ele_name: </span><br><span class="line">        indice  = ele_name.index(element)</span><br><span class="line">        n_start = <span class="built_in">sum</span>(ele_num[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, indice+<span class="number">1</span>)) - dict_contcar.get(element) +<span class="number">1</span></span><br><span class="line">        n_end = <span class="built_in">sum</span>(ele_num[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, indice+<span class="number">1</span>)) +<span class="number">1</span></span><br><span class="line">        dict_contcar2[element].append(<span class="built_in">range</span>(n_start, n_end)) </span><br><span class="line">    <span class="keyword">return</span> lines, ele_name, ele_num, dict_contcar2, dict_contcar</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_elements</span>(<span class="params">ele</span>):</span></span><br><span class="line">    lines, ele_name, ele_num, dict_contcar2, dict_contar = read_inputcar(in_file)</span><br><span class="line">    coord_total = []</span><br><span class="line">    my_list = []</span><br><span class="line">    my_dict = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dict_contcar2.get(ele)[<span class="number">0</span>]:</span><br><span class="line">        coord_list = lines[j+<span class="number">8</span>].strip().split()[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">        tf_list = lines[j+<span class="number">8</span>].strip().split()[<span class="number">3</span>:]</span><br><span class="line">        my_list.append(coord_list)</span><br><span class="line">        dict_key = <span class="string">&#x27;-&#x27;</span>.join(coord_list)</span><br><span class="line">        my_dict[dict_key] = tf_list</span><br><span class="line">       </span><br><span class="line">    data = np.array(my_list)</span><br><span class="line">    data=data[np.argsort(data[:,<span class="number">2</span>])]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> data:</span><br><span class="line">         coord = <span class="string">&#x27;  &#x27;</span>.join(k)</span><br><span class="line">         tf = <span class="string">&#x27;  &#x27;</span>.join(my_dict.get(<span class="string">&#x27;-&#x27;</span>.join(k)))</span><br><span class="line">         coord_total.append(coord + <span class="string">&#x27;  &#x27;</span> + tf )</span><br><span class="line">    <span class="keyword">return</span> coord_total</span><br><span class="line"></span><br><span class="line"><span class="comment">## Generate the New POSCAR file</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Get_and_Save_lines</span>(<span class="params">file_name, start_line, end_line</span>):</span></span><br><span class="line">    f = <span class="built_in">open</span>(file_name)</span><br><span class="line">    lines =  f.readlines()</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines[<span class="built_in">int</span>(start_line):<span class="built_in">int</span>(end_line)]:</span><br><span class="line">        file_out.write(line.rstrip()+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">out_name = in_file + <span class="string">&#x27;_sorted&#x27;</span></span><br><span class="line">file_out = <span class="built_in">open</span>(out_name, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">Get_and_Save_lines(in_file, <span class="number">0</span>, <span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">ele_name = read_inputcar(in_file)[<span class="number">1</span>]</span><br><span class="line">dict_contcar = read_inputcar(in_file)[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ele_name:</span><br><span class="line">    <span class="keyword">if</span> dict_contcar.get(i) &gt; <span class="number">1</span> :</span><br><span class="line">        file_out.write(<span class="string">&#x27;\n&#x27;</span>.join(get_elements(i)))</span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        file_out.write(<span class="string">&#x27;\n %s \n&#x27;</span> %(<span class="string">&#x27;  &#x27;</span>.join(get_elements(i))))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>注意事项：</strong></p>
<p>1） 这里我们用的是Cu(111)的例子，比较简答，脚本的威力展示不出来。<br>2） 如果你的体系有很多不同的原子，脚本首先会将同一种元素原子的坐标排列，然后依次类推。<br>3） 有些地方可能有些冗余。但本人一直在用，效果还不错。<br>4） 本人建议，只针对表面使用这个脚本。也就是吸附前的slab模型。如果你放了吸附物种，不建议使用，因为吸附物种间不同原子之间的连接顺序可能会被打乱。<br>5） 在放吸附物种之前，最好将表面先排序完，怎么做，前面三种方法任选。<br>6） 脚本的话已经上传，大家可以通过链接下载：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1X5xLRsvRmFfNE8IlKwvbFQ）">https://pan.baidu.com/s/1X5xLRsvRmFfNE8IlKwvbFQ）</a></p>
<p>7）如果使用脚本出错的话，可能是因为你的python版本太低。这个脚本只适用于python2.6及以上的。Python3可能也不适用。出现错误，直接放弃，掌握了这个方面的思想就足够了。</p>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>本节讨论的内容与科研关系说大不大，说小也不小，主要是在解决工作效率和时间上。想象一下，如果你的slab中有很多原子（金属氧化物，硫化物等），而且还不是同一种的，你用前两种方法的时候，就得十分小心了，此时脚本的作用就显示出来了。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/10/05/ex58/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/05/ex58/" class="post-title-link" itemprop="url">Ex58 吸附能的计算（三）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-05 15:30:16" itemprop="dateCreated datePublished" datetime="2018-10-05T15:30:16-04:00">2018-10-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/10/05/ex58/" class="post-meta-item leancloud_visitors" data-flag-title="Ex58 吸附能的计算（三）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/10/05/ex58/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/10/05/ex58/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前面一节我们将Cu的slab表面扩展成p(2x2), 然后放了一个O原子在上面吸附。最后发现与p(1x1)表面上吸附相比，O原子的吸附能从+1.2 降低到0.2 eV. 说明覆盖度高的时候，O原子的吸附很差。吸附能受覆盖度的影响很大。</p>
<p>那什么是覆盖度？ Surface coverage（θ）</p>
<p>从字面上理解，就是表面被吸附物(原子或分子等)覆盖的程度。一个固定大小的表面，如果上面某一吸附物越多，那么说它的覆盖度也就越大。也可以理解为：该吸附物在表面上的浓度也就越大。在多相催化的过程中，吸附是第一步。而在催化剂表面上，其活性位点数量是有限的（N个），如果N1个活性位点被吸附物种占据了，那么此时的覆盖度：θ= N1/N。如果所有的活性位点都被占据了，那么覆盖度就是1。 这个相信学过物理化学，以及相关多相催化基础知识的都能理解。 如果不知道的，请自己查找相关参考书学习，主要是在Langmuir 吸附那一部分。</p>
<hr>
<p>在表面计算中，覆盖度我们通常使用原子数目的比来表示。首先，在p(2x2)的Cu(111)表面上，有4个Cu原子，我们可以认为活性位点是4个。当我们放一个O上去后，占据了一个Cu，那么此时的覆盖度是1/4。前面我们在p(1x1)的表面上放了一个O，可以认为是Monolayer的O吸附，也就是覆盖度为1。</p>
<p>1）之所以用原子数来表示，而不用表面积。是因为吸附的物种往往不像O原子这么简单，比如甲醇，乙醇，等等。这些表面上吸附物种的面积很难算，将它们的面积除以表面的面积，可行性不大。</p>
<p>2）师兄，如果我的吸附分子很大，比如苯环。 1个Cu原子上面放不下，那该怎么表示?</p>
<hr>
<p>首先你需要扩胞，如上一节所讲的，将表面扩大到能容得下苯环为止。</p>
<p>1）比如我们将表面扩展成p(3x3)后才能放上去一个苯环，那么此时的覆盖度就是1/9。虽然数值很小，但对于苯环来说，Monolayer的吸附，按照这个定义，其覆盖度就是1/9。</p>
<p>2） 如果我们知道一个苯环可以占据9个表面的原子，那么我们将这9个原子看做一个活性位点，那么覆盖度就是 1/1。第一个1指的是1个苯环，第二个1指的是1个活性位点（9个原子）。</p>
<p>大家在计算的时候，一方面参考专业书，文献中的表示，另一方面根据自己的体系需要，只要将问题描述清楚就可以了。</p>
<p>继续回到上一节留的另一个问题：扩胞时有什么需要注意的事项。</p>
<p>1）扩胞的操作已经展示给大家了，相信这不再是什么难事了；</p>
<p>扩胞后的结果见下图： </p>
<p><img src="/2018/10/05/ex58/ex58-1.png" alt=""></p>
<p>2）扩胞后计算，我们需要注意的主要是KPOINTS这个文件。前面p(1x1)-Cu(111)，我们用的K点是：13x13x1。那我们扩完胞后，晶格变大了，还能继续用$13\times13\times1$吗？</p>
<p>答：可以用来计算。但结果不能用来和其他K点的进行比较。</p>
<hr>
<p>什么意思呢？</p>
<p>这里大师兄想要表达的是：如果你想要对比两个计算结果，首先要保证它们在一个计算的等级上， 即两个计算K点的网格密度是一样的，或者差不多的。在Reciprocal space中，晶胞的长度为$2\pi/a$。然后我们将这个长度分割成k段。每一段长度为：$2\pi/ka$</p>
<p>我们扩胞后，晶胞长度变为2a，则在Reciprocal Space中，晶胞的长度为$2\pi/2a$ =$\pi/a$。</p>
<p>如果我们用之前的KPOINTS，那么就会将π/a分成k段，每段长：$\pi/a$， 由于分的更细，这会导致扩胞后K点的密度更大。</p>
<p>为了保持和扩胞前的密度一致，我们需要将$\pi/a$分割成 k/2 段，这样每段长为$2\pi/ka$。</p>
<hr>
<p>因此当我们扩胞后，KPOINTS如果保持不变，会导致前后两个计算的K点密度不一致时，从而计算的精度也不一样，所以两个结果没有可比性。</p>
<p>师兄，你说了这么多废话。那我们该怎么办呢？</p>
<p>很简单，将K点数目减小就可以了。 前面p(1x1)我们使用的是$13\times13\times1$，那么扩胞成p(2x2)后，K点就需要相应的减小到$7\times7\times1$。更简单一点，回想我们前面说到的那个经验选择。<code>K * a</code> 的取值范围。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.fysik.dtu.dk/gpaw/exercises/surface/surface.html">https://wiki.fysik.dtu.dk/gpaw/exercises/surface/surface.html</a></p>
<p><img src="/2018/10/05/ex58/ex58-2.png" alt=""></p>
<p>我们只要保证所有计算中： K * a 的数值差不多就OK了。所以，当你看到这里，你就可以随便扩胞了，什么p(2x2),  p(3x3),  p(4x4)啦，扩胞后都知道该怎么选择K点并修改KPOINTS了。</p>
<hr>
<p>那对于其他输入文件呢？</p>
<p>INCAR：</p>
<p>此时，对于Cu体系来说，可以保持不变。但有些与原子数目相关的参数，你还是需要在INCAR里面修改，保持与新的POSCAR对应。比如： </p>
<ul>
<li><p>MAGMOM, 但如果你的体系是具有磁性，需要重新设置MAGMOM。</p>
</li>
<li><p>更复杂点的体系，如果你的体系是不仅有磁性，还是反铁磁，当你扩胞后，你还要给不同的原子设置磁矩的方向。</p>
</li>
</ul>
<p>POTCAR： 保持不变</p>
<p>提交任务的脚本： 扩胞后，由于体系变大， 计算会变慢，为了加快速度，我们可能会需要增加节点数目。</p>
<hr>
<p>计算步骤：</p>
<p><strong>老实人的做法：</strong></p>
<p>扩胞后，很多人问计算吸附能的步骤，不清楚该怎么样进行。</p>
<p>第一步：优化扩胞后的Slab 模型： 因为扩抱前已经relax过了，所以这一步很快就会结束；得到新的slab能量。</p>
<p>第二步：在第一步优化的基础上搭建吸附模型； 然后优化，得到slab+吸附物的能量。</p>
<p>第三步：套公式，计算吸附能。</p>
<p>老司机的做法</p>
<p>当然了，如果你经验丰富，计算的够多了，可以尝试这样做：</p>
<p>第一步：优化扩胞后的Slab 模型： 因为扩抱前已经relax过了，所以这一步很快就会结束；得到新的slab能量：</p>
<p>同时：在扩胞后的slab模型上（没有优化）直接搭建吸附模型，然后优化，得到slab+吸附物的能量。</p>
<p>第二步：套公式，计算吸附能。</p>
<p>这两种做法，最后的结果应该是一样的，如果有差别，也是微乎其微，可以忽略不计。<strong>注意：</strong>在计算纯的slab能量时，表面应该是放开的。</p>
<hr>
<p>另一个很常见的问题是，slab的表面我应该放开还是固定呢？</p>
<p>严格来说，slab的表层原子应该是弛豫的，也就是坐标后对应的是 T T T，这样更符合物理化学意义，因为催化剂表面的原子不可能会不动。厉害的时候，吸附物还会导致表面重构。所以你在阅读文献，会发现理论部分都会写：Top two layers 放开来模拟表面，底部的原子固定来模拟体相等等这样类似的话。</p>
<p>但是，将表面原子放开后，会导致结构优化步数的增加，从而引起计算量的增加。如果你的模型很大，吸附结构很多，可以先从小模型，低K点出发，先固定住表面，算一遍吸附，大体有个感觉后，再一步一步增加计算的精度。</p>
<p>如果体系太大了，可以尝试着固定表面来算吸附能，步骤如下：</p>
<ul>
<li>1）先优化slab模型，这一步表面原子是要放开的；</li>
<li>2）固定表面原子，</li>
<li>3）放吸附物种优化。</li>
</ul>
<p>目前计算能力基本上可以完全满足放开表面原子的计算。所以，大家不要纠结这个问题。表面的原子能放开，尽量放开。如果实在是不放心，那么就找一篇和你工作很相近，体系类似的计算文章，看看别人怎么设置的，照猫画虎就可以了。</p>
<hr>
<h2 id="参考阅读："><a href="#参考阅读：" class="headerlink" title="参考阅读："></a>参考阅读：</h2><p>Density Functional Theory：A Practical Introduction, <strong>Chapter 3</strong>：Nuts and bolts of DFT calculations</p>
<p><img src="/2018/10/05/ex58/ex58-3.png" alt=""></p>
<hr>
<h2 id="扩展练习："><a href="#扩展练习：" class="headerlink" title="扩展练习："></a>扩展练习：</h2><p>另一个无关痛痒，但对后面工作效率会造成影响的问题就是：</p>
<p><img src="/2018/10/05/ex58/ex58-4.png" alt=""></p>
<p>当扩展完之后，你会看到，Cu原子的坐标，是按照每个单胞中的坐标来排列的。在p(2x2)中有4个p(1x1)的单胞，先列出来第一个(1x1)中4个原子的坐标，然后再列出来第二个(1x1)的，以此类推。但是，比如我们想仅仅放开表面的第一层原子（也就是纵坐标为6.26的所有原子），就得把纵坐标为4.189的原子挨个由T T T 改成 F F F （图中箭头所指的部分）。这样会很麻烦，还浪费很多时间。</p>
<p>怎么解决这个问题，快速将表层，次表层原子固定或者放开呢 ? 看下一节的内容。</p>
<hr>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/10/04/ex57/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/04/ex57/" class="post-title-link" itemprop="url">Ex57 吸附能的计算（二）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-04 15:30:16" itemprop="dateCreated datePublished" datetime="2018-10-04T15:30:16-04:00">2018-10-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/10/04/ex57/" class="post-meta-item leancloud_visitors" data-flag-title="Ex57 吸附能的计算（二）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/10/04/ex57/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/10/04/ex57/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>$\require{mediawiki-texvc}$</p>
<p>本节我们简单讨论一下覆盖度对吸附能的影响。首先回顾一下，前面我们讲到的内容。</p>
<ul>
<li><p>吸附能为初态和末态的能量差：</p>
<ul>
<li>初态为纯净的slab 和 O$_2$分子或者O原子</li>
<li>末态为O吸附的slab</li>
</ul>
</li>
<li><p>O$_2$分子优化计算的时候，要注意: </p>
<ul>
<li>从数据库获取O$_2$分子的键长，作为初始值；</li>
<li>ISPIN = 2  </li>
<li>ISMEAR = 0; SIMGA = 0.05 </li>
<li>IBRION= 2; POTIM = 0.1</li>
<li>用gamma点。</li>
</ul>
</li>
<li>O 原子优化计算的时候，注意的计算细节与前面相同。额外注意的是：<ul>
<li>O 原子再怎么优化还是一个O原子，所以上一行表述是不恰当的，应该是O原子的单点计算；</li>
<li>Box的尺寸为：$13\times14\times15~\AA^3$  或者$13.1\times13.2\times13.3 \AA^3$ 但绝对不能为$13\times13\times13$这种正方体的</li>
</ul>
</li>
<li>怎么优化Bulk的结构，扫晶格拟合和ISIF = 3直接优化（ENCUT要大，不妨取个700~eV）</li>
<li>slab怎么优化，Selective 和 坐标后面 T F 的关系</li>
<li>O吸附模型怎么搭建，如何得到合理的初始模型（有实验值优先使用，没有的话用粗精度的初算一下）。</li>
<li>此外，还要学会怎么判断计算结束，不同类型任务结束的特征是什么？</li>
</ul>
<hr>
<h2 id="打个比方"><a href="#打个比方" class="headerlink" title="打个比方"></a>打个比方</h2><p>回到上一节我们留的问题，为什么O在p-(1x1)-Cu(111)表面上的吸附能是正的呢？在解释这个问题先，我们先看下面一组照片：</p>
<p><img src="/2018/10/04/ex57/ex57-1.jpeg" alt=""></p>
<p><img src="/2018/10/04/ex57/ex57-2.jpeg" alt=""></p>
<p><img src="/2018/10/04/ex57/ex57-3.jpeg" alt=""></p>
<hr>
<p>第一张里面，地铁车厢里面是空的，这时候你上去，座位随便挑。</p>
<p>第二张里面，有些人了已经占了，但还是有座位的，你的选择并没有那么多了。</p>
<p>第三张里面，人太多，能不能出来都是个问题，有没有座位想都不敢想了。</p>
<p>那么回到我们的这个问题，我们把O的吸附结构在xy平面上重复一下：</p>
<p><img src="/2018/10/04/ex57/ex57-4.png" alt=""></p>
<p>你会发现，表面上密密麻麻全是O原子（绿色的为Cu原子）！空间这么小，如果你是O原子，你愿意在这上面挤么？ 你是选择空旷的车厢还是人满为患的呢？如果我是氧原子，我肯定不愿意。所以，如果非得在这个表面上挤的话。我们就需要一些外力的作用，比如下图中的这俩年轻力壮的小伙子协警。</p>
<p><img src="/2018/10/04/ex57/ex57-5.jpeg" alt=""></p>
<p>这俩人使的劲就是O原子的吸附能。正值的意思表明我们需要额外的力才能将其吸附在表面上。表面越挤，正值越大。</p>
<hr>
<p>如果你还是不理解的话，我们看另外一个例子：</p>
<p><img src="/2018/10/04/ex57/ex57-6.jpeg" alt=""></p>
<p>早上，开学了。老师有1个苹果，需要将这个苹果分给教室里面的学生。而学生还没有来齐，当你第一个到达教室时，发现整个苹果都是你的。开心程度 100%。正要吃的时候，小明进来了，老师说你俩要分一下，你只能得到一半了，开心程度 50%; 你俩正要吃的时候，小红和小白也进来了，老师说，打住，你们四个分，于是每人只能拿1/4，你的开心程度掉到 25%了。</p>
<p>表面就是这个苹果，O原子就是学生，总共就这一个苹果，学生越多，平均分到的就越少。学生之间可能还会因为分的不均匀而打架（相互排斥），导致开心程度越来越低。当开心程度成负的时候，老师就需要施展神通费心思（额外的功）逗你们开心。</p>
<hr>
<p>看完这两个例子，你也许就明白了，为什么这个时候O原子的吸附能这么大了。太他妈挤了或者人太多，分不到苹果吃了，心里肯定不爽！下面，我们把车厢清空，学生数目控制一下，看看心情能不能好点。</p>
<hr>
<h2 id="搭建p-2x2-Cu-111-表面"><a href="#搭建p-2x2-Cu-111-表面" class="headerlink" title="搭建p-(2x2)-Cu(111)表面"></a>搭建p-(2x2)-Cu(111)表面</h2><p>1 用p4vasp打开p-(1x1)-Cu(111)的CONTCAR</p>
<p>2 选择Edit —&gt; Multiply cell</p>
<p><img src="/2018/10/04/ex57/ex57-7.png" alt=""></p>
<p>3 弹出的窗口，如图填入扩展的倍数：</p>
<p><img src="/2018/10/04/ex57/ex57-8.png" alt=""></p>
<p>这代表我们在x和y方向上分别扩展到原来的2倍。点击Multiply，效果如下图：</p>
<p><img src="/2018/10/04/ex57/ex57-9.png" alt=""></p>
<p>4 关闭Multiply这个窗口，p4vasp主界面左上角选择：<code>File</code> —&gt; <code>Save system as</code></p>
<p>5 在弹出的窗口，选择目录，保存成POSCAR，点击OK即可。</p>
<p><img src="/2018/10/04/ex57/ex57-10.png" alt=""></p>
<p>6 这样我们就有了一个p-(2x2)的slab模型了。</p>
<hr>
<h2 id="搭建O在p-2x2-Cu-111-上的吸附结构"><a href="#搭建O在p-2x2-Cu-111-上的吸附结构" class="headerlink" title="搭建O在p-(2x2)-Cu(111)上的吸附结构"></a>搭建O在p-(2x2)-Cu(111)上的吸附结构</h2><p>1 我们可以用之前计算的结果搭建这个初始结构,O吸附优化的CONTCAR：</p>
<p><img src="/2018/10/04/ex57/ex57-11.png" alt=""></p>
<p>O原子在$z$方向的坐标为8.0928$\AA$。先记住这个数字。</p>
<hr>
<p>p-(2x2)的Slab坐标（在p-(1x1)基础上扩展的）:</p>
<p><img src="/2018/10/04/ex57/ex57-12.png" alt=""></p>
<p>在这个坐标上面修改，搭建结构：</p>
<p><img src="/2018/10/04/ex57/ex57-13.png" alt=""></p>
<p>1）添加O原子元素</p>
<p>2）添加O原子数目</p>
<p>3）添加O原子坐标</p>
<p>4）弄完后，保存成POSCAR</p>
<p>到现在，p-(2x2)的slab以及O原子的吸附模型都有了，准备INCAR,KPOINTS,POTCAR以及任务脚本，提交这两个结构的优化计算。等待结束。</p>
<hr>
<p>计算吸附能：</p>
<p>公式1： </p>
<script type="math/tex; mode=display">
E_{ads1}(O) = E_{slab+O} – E_{slab} – E_{O_2}/2</script><p>公式2： </p>
<script type="math/tex; mode=display">
E_{ads2}(O) = E_{slab+O} – E_{slab} – E_{O}</script><p>带入数据：</p>
<script type="math/tex; mode=display">
E_{ads1}(O) = -60.61682891~eV – (-55.96049190~eV )- (-9.85498627~eV)/2 = 0.271~eV</script><script type="math/tex; mode=display">
E_{ads2}(O) = -60.61682891~eV – (-55.96049190~eV )- (-1.89237882~eV)= -2.764~eV</script><p>发现吸附能$E_{ads1}(O)$从正的1.216降低到0.271 eV了。看来空间对O原子的吸附影响很大。</p>
<hr>
<p>地铁里面空间稍微大了些，现在不需要年轻小伙子暴力推搡了，大妈指挥下就可以了。</p>
<p><img src="/2018/10/04/ex57/ex57-14.jpeg" alt=""></p>
<p>分的苹果稍微多了些，虽然还是有些不情愿，稍微诱导一下，就开心了。</p>
<p><img src="/2018/10/04/ex57/ex57-15.png" alt=""></p>
<hr>
<p>前面的解释只是用现实的例子瞎扯一顿。但发表文章的时候不能这样说啊，我们就需要一些科学和专业的解释。而在实际表面上，覆盖度影响吸附能的因素有很多。体相中电子的分布转移，与吸附物种的成键，吸附物种之间的排斥和吸引等等。如果你想了解的更多，更专业！阅读下面这篇文献：</p>
<p><img src="/2018/10/04/ex57/ex57-16.png" alt=""></p>
<p>谷歌上可以下载免费的，有权限的也可以直接下载。类似这样已经注明的文献，请不要花时间找我要，自己去下载。</p>
<p>（每设一道坎，就会把很多懒家伙挡住！跨过一道又一道坎，你就把别人远远甩在后面了。所以，请自己主动起来！）</p>
<hr>
<h2 id="扩展训练："><a href="#扩展训练：" class="headerlink" title="扩展训练："></a>扩展训练：</h2><p>1 重复p-(2x2)-Cu(111)的练习，心里面默念一遍INCAR, KPOINTS, POTCAR, POSCAR。看看都有些什么需要注意的。</p>
<p>2 阅读推荐的文献，学习表面物种之间的相互作用，覆盖度是怎么影响吸附能的。有哪几方面？</p>
<p>3 本文提到了一个专业名词：覆盖度，查找相关的文献，了解这个名词是怎么回事，文献报道的覆盖度都是怎么算出来的。</p>
<hr>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>本节，大师兄带你做了趟地铁，当了回幼儿园的小朋友。来体验下人多的感觉。覆盖度高的时候吸附能很小或者是正值，说明物种在表面不稳定，需要额外的力来促使它们老老实实待在表面上。表面就那么大点的地方，空间有限，p-(1x1)上吸附的时候，表面太挤了，O原子不愿意待在上面。而表面扩成p-(2x2)后，空间明显大了很多，O原子虽然不情愿，但明显不像在(1x1)上那么不爽了。从吸附能就可以看出来，降低了1~eV左右。从另一个角度来看，这明显就是一场O原子争夺表面资源的战争。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/10/03/ex56/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/03/ex56/" class="post-title-link" itemprop="url">Ex56 吸附能的计算（一）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-03 15:30:16" itemprop="dateCreated datePublished" datetime="2018-10-03T15:30:16-04:00">2018-10-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/10/03/ex56/" class="post-meta-item leancloud_visitors" data-flag-title="Ex56 吸附能的计算（一）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/10/03/ex56/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/10/03/ex56/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>我们已经优化完成了O原子在Cu(111)表面上的吸附。总结并数一下，到目前为止我们从前面的计算中可以获取哪些能量。</p>
<ul>
<li>Cu(111) slab 的能量</li>
<li>slab上有O吸附时，体系优化完的能量</li>
</ul>
<p>再往前想一下，我们也计算了</p>
<ul>
<li><p>O$_2$分子的能量</p>
</li>
<li><p>以及O原子在气相中的能量。</p>
<p>有了这几个能量，我们就可以计算O在p(1x1)的Cu(111)表面上的吸附能了。这也是本节的主要内容。</p>
</li>
</ul>
<h2 id="1-什么是吸附能？"><a href="#1-什么是吸附能？" class="headerlink" title="1 什么是吸附能？"></a>1 什么是吸附能？</h2><p><img src="/2018/10/03/ex56/ex56-1.png" alt=""></p>
<p>从字面上不难理解，就是分子或者原子从气相中吸附到表面上所释放的能量。计算吸附能的时候，需要注意的有两点：起始和终态。</p>
<p>1）  <strong>终态：</strong>这里说的终态就是O原子在表面吸附，并且优化完的构型。我们标记为 slab+O，它的能量为  E(slab+O)。</p>
<p>2）  <strong>初态：</strong>我们计算O的吸附能，起始状态是O$_2$ 和 纯净的slab表面。因为在实际反应中，O$_2$在气相中解离成2个O原子，然后再吸附，这种可能性微乎其微。前面我们讲了O$_2$分子的优化，这里我们直接把O$_2$分子的能量拿来用。起始的两个结构能量分别标记为：E(O$_2$) 和 E(slab)。</p>
<p>由于在终态的吸附结构上面，我们只有1个氧原子， 所以初始态我们要用O$_2$能量的一半:  E(O$_2$)/2。</p>
<p>3）  注意：文献报道里面，也有很多人用O原子在气相中的能量来计算O的吸附能。这样做的话，其物理意义为：O$_2$需要先解离成O原子，然后O原子再吸附。此时，初始状态为分解的O原子，因此O$_2$分子解离的能量没有考虑在内。由于O$_2$解离是吸热反应，忽略掉解离能，会导致O的吸附能很强。单个O原子的能量标记为：E(O)。</p>
<p>4）  所以，大家在计算的时候，一定要把自己的计算公式标出来，此外，大家看到直接用O原子能量计算出来的吸附能，不要用O$_2$作为参考能量的结果进行对比。</p>
<p>5） 这两个计算方法，哪个对，哪个错呢？ 答：都是对的。因为O$_2$的解离能是一个常数，加上去（用O$_2$能量作为起始）或者忽略掉（用O原子能量作为起始）得到的结果之间的区别无非也是这个常数。看下面的计算。</p>
<hr>
<h2 id="2-计算吸附能（单个O原子）"><a href="#2-计算吸附能（单个O原子）" class="headerlink" title="2 计算吸附能（单个O原子）"></a>2 计算吸附能（单个O原子）</h2><p>公式1: </p>
<script type="math/tex; mode=display">
E_{ads1}(O) = E_{slab+O} – E_{slab} – E_{O_2}/2</script><p>公式2: </p>
<script type="math/tex; mode=display">
E_{ads2}(O) = E_{slab+O} – E_{slab} – E_{O}</script><p>$E_{slab+O}$ ：O 在Slab上，优化完结构的能量；</p>
<p>$E_{slab}$: 优化的slab的能量；</p>
<p>$E_{O_2}$: O$_2$ 分子在气相中的能量；</p>
<p>$E_{O}$: O原子在气相中的能量；</p>
<p>带入数据后：</p>
<script type="math/tex; mode=display">
E_{ads1}(O) =  -17.68238420~eV – (-13.97082922~eV) – (-9.85498627~eV) = 1.216~eV</script><script type="math/tex; mode=display">
E_{ads2}(O) =  -17.68238420~eV – (-13.97082922~eV) – (-1.89237882~eV) = -1.819~eV</script><hr>
<p>前面我们说了，如果直接用O原子在气相中的能量，则忽略了O$_2$分子解离的能量（或者是O原子结合能）。</p>
<p>我们知道O$_2$ 分子解离是一个吸热反应，那么，解离能可以通过以下两个方式来获取：</p>
<p>1)     两个吸附能量相减来得到：</p>
<script type="math/tex; mode=display">
E_{ads1}(O) - E_{ads2}(O) = 1.216~eV – (-1.819~eV) = 3.035~eV</script><p>2)    直接通过O$_2$分子和O原子的能量得到。单个O原子的结合能为：</p>
<script type="math/tex; mode=display">
E_{binding} = [ E_{O_2} – E_O * 2] /2，</script><p>代入数据后得到：</p>
<script type="math/tex; mode=display">
E_{binding} =[ -9.85498627~eV – (-1.89237882~eV *2) ] / 2 = -3.035~eV</script><hr>
<h2 id="3-思考问题："><a href="#3-思考问题：" class="headerlink" title="3 思考问题："></a>3 思考问题：</h2><p>1）  前面我们计算的$E_{ads1}(O)$ = 1.216 eV 是一个正值，为什么会这样？ 算错了吗？还是有其他物理意义？</p>
<p>2）  如何计算H，CO，CH$_4$, CH$_3$OH 等的吸附能，把计算的公式列出来。每个能量计算的细节，注意部分有哪些？</p>
<p>3） 如何计算脱附能？</p>
<hr>
<h2 id="4-扩展练习："><a href="#4-扩展练习：" class="headerlink" title="4 扩展练习："></a>4 扩展练习：</h2><p>1）  推荐阅读下面这两篇文章（本人的，当然喜欢大家多多引用了。）讲的是关于甲醇，乙醇，乙二醇，以及甘油在Cu, Ru, Pd以及Pt的(111)上面的解离。Ex系列的后续文章，表面反应的优化，过渡态的计算等，基本都以这两篇文章的内容为主。希望大家能够好好学习，并多多引用。此外，计算的很多细节都在支持信息里面，大家不要错过。一时半会看不完没有关系，下载后结合本书慢慢看。</p>
<p><img src="/2018/10/03/ex56/ex56-2.png" alt=""></p>
<p>链接：<a target="_blank" rel="noopener" href="https://pubs.acs.org/doi/abs/10.1021/cs501698w">https://pubs.acs.org/doi/abs/10.1021/cs501698w</a></p>
<p><img src="/2018/10/03/ex56/ex56-3.png" alt=""></p>
<p><strong>链接：</strong><a target="_blank" rel="noopener" href="https://www.nature.com/articles/s41467-018-02884-y"><strong>https://www.nature.com/articles/s41467-018-02884-y</strong></a> </p>
<hr>
<p>2）  回顾并重复本节所涉及到的计算，以及注意细节部分。</p>
<p>A.      单个O原子的能量；</p>
<p>B.      O$_2$分子优化；</p>
<p>C.      Cu bulk的优化；</p>
<p>D.      p(1x1)-Cu(111)表面的搭建及优化；</p>
<p>E.       O原子在p(1x1)-Cu(111)的top位吸附的模型搭建及优化；</p>
<p>G.      不满半年的新手，建议从Ex0 从头学习。</p>
<hr>
<h2 id="5-总结："><a href="#5-总结：" class="headerlink" title="5 总结："></a>5 总结：</h2><p>本节我们主要介绍了O原子在p(1x1)-Cu(111)表面top位上的吸附能的计算公式。顺便带大家回顾一下整个计算流程。如果你从头跟着学过来的话，每个流程中的细节，需要注意的部分肯定都已经掌握了，后面举一反三，就慢慢渐入佳境了。也就是所谓的开始入門了。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/10/02/ex55/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/02/ex55/" class="post-title-link" itemprop="url">Ex55 简单粗暴地获取初始构型（二）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-02 15:30:16" itemprop="dateCreated datePublished" datetime="2018-10-02T15:30:16-04:00">2018-10-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/10/02/ex55/" class="post-meta-item leancloud_visitors" data-flag-title="Ex55 简单粗暴地获取初始构型（二）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/10/02/ex55/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/10/02/ex55/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前面一节，我们通过一个简单的方法获取了一个Cu-O键的键长。因为我们固定了Cu的坐标，当计算完成之后，O原子初始构型的坐标可以直接将计算后的结果复制过来。此时需要注意<code>Direct</code>和<code>Cartesian</code>的坐标问题。</p>
<h2 id="1-搭建合理的O吸附模型"><a href="#1-搭建合理的O吸附模型" class="headerlink" title="1 搭建合理的O吸附模型"></a>1 搭建合理的O吸附模型</h2><p>1）取Cu(111)表面模型的POSCAR (Cartesian坐标)</p>
<p><img src="/2018/10/02/ex55/ex55-1.png" alt=""></p>
<hr>
<p>2) 复制快速获取初始构型计算(Cu-O dimer)的结果</p>
<p><img src="/2018/10/02/ex55/ex55-2.png" alt=""></p>
<center>上图中的最后一行。</center>

<hr>
<p>3) 构建O的吸附模型：</p>
<p><img src="/2018/10/02/ex55/ex55-3.png" alt=""></p>
<p>当然了,我们也可以根据键长或者O在z方向的坐标直接在Cu(111)表面基础上搭建。</p>
<p><img src="/2018/10/02/ex55/ex55-4.png" alt=""></p>
<hr>
<p>这个简单粗暴的方法到此就讲解完了。有以下几个需要注意的地方：</p>
<p>A）这里我们用的是Cu(111)的 p(1x1) slab模型,表面只有一个原子。一般来说，大家计算吸附的时候，模型都比这个大，我们可以取一层原子。记住，要固定住这层原子。</p>
<p>B）这个方法基于的是气相中的计算，因此偶极矫正不要加！因为加上去之后，收敛会变得很困难。这个大家可以用自己测试测试。</p>
<p>下面我们讲一个基于slab模型的方法，虽然比这个计算量大，但也异常的快，相对于后面的计算，花费的时间也可以忽略不计。</p>
<hr>
<h2 id="2-快速获取初始构型方法（二）"><a href="#2-快速获取初始构型方法（二）" class="headerlink" title="2 快速获取初始构型方法（二）"></a>2 快速获取初始构型方法（二）</h2><p>1）在这个方法中，第一步我们先取slab模型的结构，这里就不讲了。</p>
<p>2） 搭建一个初始的吸附模型。此时我们要根据原子半径，大体确认一下键长的合理范围，前面也讲过了，就不再细说了。 由于前面一节我们已经有了一个O原子的坐标数据，可以直接拿过来。如下：</p>
<p><img src="/2018/10/02/ex55/ex55-5.png" alt=""></p>
<p>注意：实际操作的时候，这个方法可以使用前面一节的方法的出来的结果；也可以直接设置初始值，这两个方法之间联系不太大。</p>
<hr>
<p>3） 固定slab模型中的所有原子！所有原子！所有原子！</p>
<p>重要的事情说三遍，是把slab模型中的原子全部固定!只放开吸附的分子。这里大师兄在vim里面操作，使用了下面的命令：<code>:12,13s/T/F/g</code>  意思是把12和13行中的T全部替换成F。当然也可以使用sed进行操作，相信大家经过这么长时间的练习，已经掌握基本的Vim和sed操作，就不浪费时间了。效果如下：</p>
<p><img src="/2018/10/02/ex55/ex55-7.png" alt=""></p>
<hr>
<p>4）  设置INCAR，这里是slab模型，把之前Cu(111)表面优化计算的INCAR直接拿过来了。</p>
<p>EDIFF、EDIFFG 可以适当放宽，下图大师兄懒得改了。</p>
<p><img src="/2018/10/02/ex55/ex55-8.png" alt=""></p>
<hr>
<p>5）  生成对应的POTCAR，K点只用gamma点！K点只用gamma点！K点只用gamma点！</p>
<p><img src="/2018/10/02/ex55/ex55-9.png" alt=""></p>
<p>这里需要注意的有两点：</p>
<p>A）  计算前一定要检查POTCAR和POSCAR是否对应，养成这个好习惯</p>
<p>B）  一定要用gamma点。因为我们知道，K点越多，计算量越大。</p>
<hr>
<p>6）  提交任务等待结束。</p>
<p>O原子的坐标，从最初的7.950优化到了8.009。</p>
<p>到此，另外一种快速获取稳定构型的方法，也介绍完了。希望大家可以举一反三，运用到自己实际的课题计算中。</p>
<hr>
<h2 id="3-正式优化O的吸附"><a href="#3-正式优化O的吸附" class="headerlink" title="3 正式优化O的吸附"></a>3 正式优化O的吸附</h2><p>前面我们已经获取的初始的一个合理的构型，下面就开始正常计算了。想一想，在上一步的基础上，正式计算的时候，我们有哪几个需要修改的部分。</p>
<p>1） 结构 </p>
<p>这个是必须要想到的。怎么做呢？ 直接将CONTCAR 复制成 POSCAR即可。</p>
<p>PS： 怎么完成复制这一步还不会的话，请从头开始学。</p>
<p>2） 复制完了并不代表完事，前面一步我们还固定了表层的原子，此时我们需要放开。使用sed命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;12,13s/F/T/g&#x27; POSCAR</span><br></pre></td></tr></table></figure>
<p>3）KPOINTS：使用前面Cu slab优化时用的 13x13x1</p>
<p>4） INCAR中，如果前面一步的计算精度较低，这时，我们就要提高一下了。</p>
<p>5）POTCAR 不变</p>
<p>6）提交任务的脚本：由于前面的计算量很小，一般可以使用小队列进行计算，如果计算量增大了，这时我们也需要稍微修改下脚本。</p>
<p><img src="/2018/10/02/ex55/ex55-12.png" alt=""></p>
<p>7)   提交任务，等待结束，查看结果。</p>
<p><img src="/2018/10/02/ex55/ex55-13.png" alt=""></p>
<p>O原子的坐标从8.009 优化到了8.093。键长从1.75 Å 优化到 1.80 Å，变化很小，这说明我们的初始构型已经很接近优化结果了。</p>
<h2 id="4-扩展练习："><a href="#4-扩展练习：" class="headerlink" title="4 扩展练习："></a>4 扩展练习：</h2><p>1)   本节的实例中，使用了 <code>&amp;&amp;</code> 这个连接前后的命令，大家学习下是怎么回事</p>
<p>2)   重复本节练习，掌握其中的关键点。</p>
<h2 id="5-小结"><a href="#5-小结" class="headerlink" title="5 小结"></a>5 小结</h2><p>一个合理的初始构型可以极大地降低我们的工作量，这一点是大家务必要记在心里的。而获取合理的初始构型，一方面需要我们用化学的知识去搭建结构，另一方面，也需要配合一些简单的低精度的计算去完成。希望大家可以掌握这两节的精髓，运用到自己的课题中，提高自己的计算效率。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/10/01/ex54/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/01/ex54/" class="post-title-link" itemprop="url">Ex54 简单粗暴地获取初始构型（一）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-01 15:30:16" itemprop="dateCreated datePublished" datetime="2018-10-01T15:30:16-04:00">2018-10-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/10/01/ex54/" class="post-meta-item leancloud_visitors" data-flag-title="Ex54 简单粗暴地获取初始构型（一）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/10/01/ex54/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/10/01/ex54/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>$\require{mediawiki-texvc}$</p>
<p>Ex54-Ex56主要介绍一下如何计算：单个氧原子在p(1x1)-Cu(111)表面top位上的吸附。在实际的计算过程中，一个好的初始结构会极大地加快并节约你的计算时间，这不仅仅体现在服务器运行的时间上，也会避免很多错误的结果，因为这些错误结果的纠正耗时费力，通常折磨得新手们心力交瘁。可以回顾下前面我们O$_2$ 分子的优化过程：不合理的初始结构导致的错误结果以及计算时间的增加。本节主要介绍一个快速获取优化初始构型的方法。该方法简单粗暴，可以让你在极短的时间内快速获得一个化学的feeling。</p>
<hr>
<h2 id="1-Top-site-的构型"><a href="#1-Top-site-的构型" class="headerlink" title="1 Top site 的构型"></a>1 Top site 的构型</h2><p>在Cu(111)表面上，top位指的是直接吸附在Cu原子上方。其他的位点是什么，先不要着急，后面会慢慢学。如果一个O原子吸附在Cu原子上方，在空间坐标上，大家很容易想到，O和Cu在xy方向的坐标应该是差不多的，z方向O的坐标为：Cu的z坐标 + Cu-O键的键长。如下图：</p>
<p><img src="/2018/10/01/ex54/ex54-1.png" alt=""></p>
<hr>
<h2 id="2-确定O原子在z方向上的坐标"><a href="#2-确定O原子在z方向上的坐标" class="headerlink" title="2  确定O原子在z方向上的坐标"></a>2  确定O原子在z方向上的坐标</h2><p>知道了前面的基本原理，O原子的坐标我们就可以通过Cu-O的键长来初步获得了。那么Cu-O的键长怎么获得呢？这里列举了一下几个常用的方法。</p>
<p>1）查数据库：</p>
<p>2）查文献：自己去查，不要在QQ群里让别人给你发文献。</p>
<p><img src="/2018/10/01/ex54/ex54-2.png" alt=""></p>
<p>这两条主要考验的是大家查询资料的能力，这里暂且不详细介绍了。有兴趣的可以加入大师兄文献互助超级群，跟众多文献检索大牛学习。(群号:<strong>157099073</strong>)</p>
<hr>
<p>3）自己估算</p>
<p>估算的话，可以根据Cu和O原子的半径：Cu和O成键，键长肯定要小于两者的半径之和。搜一下维基百科，Cu的半径为1.35 Å，O的为0.60 Å。(<a target="_blank" rel="noopener" href="https://www.wikipedia.org/">维基百科</a>，搜索<code>Atomic Radius</code>就可以得到下面这个表)</p>
<p><img src="/2018/10/01/ex54/ex54-4.png" alt=""></p>
<p>从上面的数据我们可以得出：Cu-O键要小于1.95 Å。在吸附构型搭建的时候设置比1.95 Å小点的值作为初始，进行优化。一般来说，原子半径之和减去0.1-0.3 Å都是可以的。但是不能太小，否则第一步优化的时候排斥力太大，会导致计算出错。</p>
<hr>
<p>4）自己初算：</p>
<p>初算就是初步采用一个小的模型，简单优化一下，得到一个合理的键长数值。小的模型主要指2个方面： </p>
<ul>
<li><p>结构简单；</p>
</li>
<li><p>计算参数简单。</p>
</li>
</ul>
<p>下面我们主要在估算的基础上，介绍一个初算的方法：直接优化一下气相中Cu-O双原子分子的结构。</p>
<p>这个结构不难搭建，将前面练习中O$_2$分子中的一个O原子换成Cu进行优化即可。</p>
<p>为了加深大家对搭建模型的印象，我们从<code>p(1x1)-Cu(111)</code>表面的结构出发，然后一步一步搭建CuO的气相结构模型，并计算。</p>
<hr>
<h2 id="3-搭建初算的模型-Cu-O双原子结构"><a href="#3-搭建初算的模型-Cu-O双原子结构" class="headerlink" title="3  搭建初算的模型(Cu-O双原子结构)"></a>3  搭建初算的模型(Cu-O双原子结构)</h2><p>1）p(1x1)-Cu(111)表面的结构</p>
<p><img src="/2018/10/01/ex54/ex54-5.png" alt=""></p>
<p>将前面几节计算的一个真空层为15 $\AA$的例子直接拿过来。表层原子在z方向的坐标为6.259 (第十二行)。</p>
<hr>
<p>2）修改格子大小(3-5行)</p>
<p>这里修改的很随意，第三行中直接把2.571改成了12.571；</p>
<p>第四行中把2.227改成了12.227。</p>
<p>第五行中将21.299改成了12.299</p>
<p><img src="/2018/10/01/ex54/ex54-6.png" alt=""></p>
<p>效果如下:</p>
<p><img src="/2018/10/01/ex54/ex54-7.png" alt=""></p>
<p>注意：</p>
<p>A）当然也可以用其他大小的格子；(例如：8x8x8 $\AA^3$)</p>
<p>B）格子大小直接影响计算量和时间。(回顾下前面所学)</p>
<hr>
<p>3）保留表层的Cu原子，删除其他的Cu原子。</p>
<p><img src="/2018/10/01/ex54/ex54-8.png" alt=""></p>
<p>注意：</p>
<p>A）我们这里将表层以下的三个原子删掉了，只保留z坐标为6.259的这个原子；</p>
<p>B） 第7行中原子数目也要相应的改变。从4 改成1。</p>
<p>C） 效果如下图：</p>
<p><img src="/2018/10/01/ex54/ex54-9.png" alt=""></p>
<hr>
<p>4）加入O原子</p>
<p><img src="/2018/10/01/ex54/ex54-10.png" alt=""></p>
<p>注意：</p>
<p>A）第6行中，在Cu的后面加上了一个O，不是数字0；</p>
<p>B）Cu 和 O 之间用1个或者几个空格隔开，不要用<code>Tab</code>；</p>
<p>C）第7行中，记得加上O原子的数目</p>
<p>D）最后一行添加O原子的坐标，这里我们直接把Cu原子的复制过来了。</p>
<p><img src="/2018/10/01/ex54/ex54-11.png" alt=""></p>
<p>由于两个原子坐标一样，Cu和O堆在一起了。</p>
<hr>
<p>5）修改O原子坐标</p>
<p><img src="/2018/10/01/ex54/ex54-12.png" alt=""></p>
<p>注意:</p>
<p>A）这里我们把Cu固定住了;为了方便下一步的计算。</p>
<p>B）Cu-O之间的键长，设置的为1.8 Å；</p>
<p>C）O的z坐标为：6.259 + 1.8 = 8.059。</p>
<p><img src="/2018/10/01/ex54/ex54-13.png" alt=""></p>
<hr>
<p>6）到这里，Cu-O双原子分子的气相结构就搭建完毕了，保存成POSCAR即可。</p>
<p>上面的效果图是本人每一步打开展示给大家的。实际操作中，完全没有必要。我们需要学习的是：</p>
<p>A）怎么将脑子中的模型转化为VASP的POSCAR文件；</p>
<p>B）格子大小怎么修改；</p>
<p>C）怎么添加原子，添加或者删除原子后，原子数目怎么弄；</p>
<p>D）怎么添加原子坐标。</p>
<p>E）怎么通过改坐标修改原子位置。</p>
<hr>
<h2 id="4-INCAR检查"><a href="#4-INCAR检查" class="headerlink" title="4 INCAR检查"></a>4 INCAR检查</h2><p><img src="/2018/10/01/ex54/ex54-14.png" alt=""></p>
<p>注意:</p>
<p>1）算的是气相中的：ISMEAR = 0；SIGMA = 0.05 (本书前面就讲过了)</p>
<p>2）IBRION = 2；POTIM = 0.1；NSW =100 是优化的参数</p>
<p>3）EDIFF和EDIFFG是电子步和离子步的收敛标准。</p>
<hr>
<p>师兄，磁性呢？对称性呢？</p>
<p>因为本例子是一个初算，几步算完，看下键长。这个任务的使命就完成了。</p>
<p>很多细节的东西可以暂时不用考虑。这里EDIFFG用的也有点小，本人忘了修改了。大家可以设置为 -0.05或者直接使用能量作为标准，这些都可以的。</p>
<p>虽然本节我们很多地方都没有考虑，这是由于任务的性质所决定的。我们对其定位就是瞎算下，得到一个初始的构型。这也是一个课题中为数不多的，可以为所欲为的计算了。但你正儿八经开始算的时候，各种细节问题都要考虑进去。而这一步的计算，也可以作为一个缓冲期，让你有充足的时间去思考一下正式计算时其他需要的注意事项。</p>
<hr>
<h2 id="5-POTCAR、KPOINTS检查"><a href="#5-POTCAR、KPOINTS检查" class="headerlink" title="5  POTCAR、KPOINTS检查"></a>5  POTCAR、KPOINTS检查</h2><p>A) 根据POSCAR获取对应的POTCAR：见附录自动生成POTCAR的脚本。</p>
<p>B) 使用gamma点计算。<code>cat POTCAR</code></p>
<p><strong>注意：</strong></p>
<p>在提交一个任务前，一定要将INCAR、KPOINTS、POSCAR、POTCAR以及脚本在心里默念一遍。然后对应的检查一下，是否有些遗漏的地方。否则等算完了，发现错了，又得浪费很多时间重新计算了。</p>
<hr>
<h2 id="6-检查结果"><a href="#6-检查结果" class="headerlink" title="6 检查结果"></a>6 检查结果</h2><p><img src="/2018/10/01/ex54/ex54-16.png" alt=""></p>
<p>1）上个厕所的功夫，任务就结束了，共算了6步。(其实是切换电脑系统的功夫)<img src="/2018/10/01/ex54/ex54-17.gif" alt=""></p>
<p>2）Cu—O 的键长：7.95-6.26 = 1.69 Å</p>
<p><strong>注意：</strong> </p>
<p>此时的键长只作为下一步的初始猜测，如果和文献去比有点差异，也不要太较真。</p>
<h2 id="7-总结"><a href="#7-总结" class="headerlink" title="7 总结:"></a>7 总结:</h2><p>本节，你会学到：</p>
<p>1）如何通过原子半径，估算一个初始的键长值。</p>
<p>2）如果搭建一个简单的模型，初算一个键长值。</p>
<p>3）复习气相中的优化。</p>
<p>4）复习下计算前准备工作：INCAR、POSCAR、POTCAR、KPONTS的检查。</p>
<p>如果本节的内容，你有不理解的地方；想获取脚本等信息；请查阅前面讲的以及附录中的内容。搭建几何模型，无非就是按照软件的格式，修改原子坐标罢了。这里我们强调的是几何模型。但，几何模型所具有或者要表达的物理、化学意义，这才是最关键的。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/09/30/ex53/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/09/30/ex53/" class="post-title-link" itemprop="url">Ex53 表面吸附以及模型的搭建思想</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-30 02:06:48" itemprop="dateCreated datePublished" datetime="2018-09-30T02:06:48-04:00">2018-09-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/09/30/ex53/" class="post-meta-item leancloud_visitors" data-flag-title="Ex53 表面吸附以及模型的搭建思想" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/09/30/ex53/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/09/30/ex53/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>吸附这个词，对于做表面化学的人来说，是一个普通的不能再普通的名词了。从今天这一节开始，我们将逐步进入表面化学相关计算领域。</p>
<p><img src="/2018/09/30/ex53/ex53-1.jpeg" alt=""> </p>
<h2 id="1-我们先看一下维基百科的解释"><a href="#1-我们先看一下维基百科的解释" class="headerlink" title="1) 我们先看一下维基百科的解释:"></a>1) 我们先看一下维基百科的解释:</h2><p>a）吸附是指某种气体，液体或者被溶解的固体的原子，离子或者分子附着在某表面上。这一过程使得表面上产生由吸附物构成的膜。吸附不同于吸收，吸收是指作为吸附物的液体浸入或者溶解于另一液体或固体中的过程。吸附仅限于固体表面，而吸收同时作用于表面和内部。</p>
<p>b) 吸附也属于一种传质过程，物质内部的分子和周围分子有互相吸引的引力，但物质表面的分子，其中相对物质外部的作用力没有充分发挥，所以液体或固体物质的表面可以吸附其他的液体或气体，尤其是表面面积很大的情况下，这种吸附力能产生很大的作用，所以工业上经常利用大面积的物质进行吸附，如活性炭、水膜等。吸附过程有两种情况:</p>
<p>一种是物理吸附，在吸附过程中物质不改变原来的性质，因此吸附能小，被吸附的物质很容易再脱离，如用活性炭吸附气体，只要升高温度，就可以使被吸附的气体逐出活性炭表面。</p>
<p>另一种是化学吸附，在吸附过程中不仅有引力，还运用化学键的力，因此吸附能较大，要逐出被吸附的物质需要较高的温度，而且被吸附的物质即使被逐出，也已经产生了化学变化，不再是原来的物质了，一般催化剂都是以这种吸附方式起作用。</p>
<p><img src="/2018/09/30/ex53/ex53-2.jpeg" alt=""></p>
<h2 id="2-IPUAC-GoldBook中的定义"><a href="#2-IPUAC-GoldBook中的定义" class="headerlink" title="2) IPUAC GoldBook中的定义:"></a>2) IPUAC GoldBook中的定义:</h2><p>Adsorption: An increase in the concentration of a dissolved substance at the interface of a condensed and a liquid phase due to the operation of surface forces. Adsorption can also occur at the interface of a condensed and a gaseous phase.</p>
<p><a target="_blank" rel="noopener" href="https://goldbook.iupac.org/html/A/A00155.html">https://goldbook.iupac.org/html/A/A00155.html</a></p>
<h2 id="3-参考书"><a href="#3-参考书" class="headerlink" title="3) 参考书"></a>3) 参考书</h2><p>吸附在物理化学中也是一个非常重要的概念，只要学过物理化学，肯定不会错过这一部分的内容。主要列举有关吸附的几本参考书，具体内容本节则不再详细介绍，这也超出了本书所包含的范围。</p>
<p>a) Atkins’ Physical Chemistry </p>
<p>(链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hsJ95sg">https://pan.baidu.com/s/1hsJ95sg</a> 密码:nfxw)</p>
<p>b) Concepts of Modern Catalysis and Kinetic  (By I. Chorkendorff）</p>
<p>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hrA5LHi">https://pan.baidu.com/s/1hrA5LHi</a> 密码:aqvq)</p>
<p>c) 南大物理化学(傅献彩主编)</p>
<h1 id="吸附在催化研究中的地位"><a href="#吸附在催化研究中的地位" class="headerlink" title="吸附在催化研究中的地位"></a>吸附在催化研究中的地位</h1><p>催化剂发挥催化作用的前提是:反应物需要和催化剂有接触（也就是反应物吸附到催化剂表面上并且得到活化）。写这句话的意思就是:研究一个催化反应，第一步我们需要搞懂的就是反应物在表面的吸附情况。个人计算的心得就是：反应的初始态，过渡态以及末态，它们都是表面的吸附物种。这句话的意思是：在我们的计算中，吸附贯穿着我们对催化现象的整个研究过程中。吸附不仅仅是把反应物放到表面上就完事了，更与后面的反应息息相关。切记不要在思考的时候把后面我们要学习的过渡态和吸附隔离开。</p>
<h1 id="吸附模型的搭建"><a href="#吸附模型的搭建" class="headerlink" title="吸附模型的搭建"></a>吸附模型的搭建</h1><p>前面我们已经讲过slab模型了，搭建吸附模型的本质就是在slab模型基础上，再添加吸附分子的xyz坐标。搭建的模型无非就是一个xyz的坐标文件。需要注意的有3个方面:</p>
<p>1) 熟悉VASP的POSCAR格式: 每一行的内容所代表的意思以及它们之间的相互联系:</p>
<ul>
<li>元素行，原子数目以及原子的坐标之间的关系；</li>
<li>Selective Dynamic 行与 T T T， F F F 等原子固定的关系；</li>
<li>Cartesian 坐标和 Direct 坐标的区别等等；</li>
<li>POSCAR与KPOINTS的关系。</li>
</ul>
<p>熟悉POSCAR或者CONTCAR的格式可以使你在搭建模型过程中游刃有余。</p>
<p>2) Slab模型在Z方向上: </p>
<ul>
<li><p>slab的厚度</p>
</li>
<li><p>真空层的厚度，</p>
</li>
</ul>
<p>这两点一方面决定了我们计算量的大小。另一方面，对于不同的体系，我们需要不同厚度的slab模型来保证计算的准确性。例如：对于金属体系来说，越开放的表面往往需要更多的层数。所以，在准确性和计算量上，我们要合理地权衡和取舍。可以通过一些基本的测试工作，以及参考他人发表的计算参数来确定。</p>
<p>3) Slab模型在XY方向上:</p>
<ul>
<li><p>表面的大小：这个主要影响覆盖度，计算的工作量；</p>
</li>
<li><p>表面的吸附位点：比如面心立方金属的111表面，有top(t)，bridge(b)，fcc(f) 和hcp(h)这几个位置，在搭建模型的时候要考虑吸附物种分别在这几个位置上的情况；</p>
</li>
<li><p>吸附物种与表面的结合情况：不同的分子构型?用什么原子?哪一部位和表面接触?初始猜测的键长多少? 等等</p>
</li>
</ul>
<p>这些对于你搭建合理的模型至关重要。一个合理的模型可以极大地降低计算工作量，提高你的计算成功率。当然，这需要一个扎实和良好的化学基本功来作为保障。</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>本节简单介绍了一下吸附的概念，吸附模型搭建的一些基本的思路，大家可以自己主动思考一下:本节提到的相关内容之间的相互关系以及具体的注意事项。在后面具体的实例操作计算中，我们会逐步慢慢展开详细介绍。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/09/06/ex52/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/09/06/ex52/" class="post-title-link" itemprop="url">Ex52 影响功函数计算的因素（二）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-06 02:06:48" itemprop="dateCreated datePublished" datetime="2018-09-06T02:06:48-04:00">2018-09-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/09/06/ex52/" class="post-meta-item leancloud_visitors" data-flag-title="Ex52 影响功函数计算的因素（二）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/09/06/ex52/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/09/06/ex52/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前面功函数的计算流程( VASP 计算细节以及结果分析)，我们已经掌握了。这一节介绍一下影响功函数的主要因素：真空层的厚度。首先个人经验：计算功函数的时候，真空层厚度一定要足够。</p>
<p><img src="/2018/09/06/ex52/ex52-0.png" alt=""></p>
<p>这里有两点：</p>
<ol>
<li>多厚才算足够?具体要根据自己的体系测试下，一般来说 20 Å 左右足以。</li>
<li>是不是越厚越好? 越厚的话，计算出来的结果差别不大，但会增加计算量。前面我们讲过影响计算量的因素。</li>
</ol>
<p>我们以 Cu(111) 表面的例子，简单介绍下真空层厚度对功函数的影响。</p>
<h3 id="1-不同真空层厚度的测试-上一节内容"><a href="#1-不同真空层厚度的测试-上一节内容" class="headerlink" title="1 不同真空层厚度的测试(上一节内容)"></a>1 不同真空层厚度的测试(上一节内容)</h3><p><img src="/2018/09/06/ex52/ex52-1.png" alt=""></p>
<ol>
<li><p>先准备一个真空层为 10 Å 的计算文件夹： POSCAR 如上图；</p>
</li>
<li><p>将前面两节的 INCAR,KPOINTS, POTCAR, 以及提交任务的脚本复制过来；</p>
</li>
<li><p>批量生成测试文件，每个文件夹以真空层的厚度命名。命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for i in $(seq 12 2 36); do cp 10 $i; sed -i &quot;5s/16/$((6+$i))/g&quot;$i/POSCAR ; done</span><br></pre></td></tr></table></figure>
</li>
<li><p>批量提交任务。</p>
</li>
</ol>
<p><strong>注意：</strong></p>
<ol>
<li>这样的批量操作本书刚刚开始的时候就已经讲到了，这里不要再问我。</li>
<li>如果不会用这个办法批量制作输入文件，想其他的办法批量操作，条条大路通罗马，不要死磕在我的这个命令上。</li>
</ol>
<h3 id="2-结果处理"><a href="#2-结果处理" class="headerlink" title="2 结果处理"></a>2 结果处理</h3><p>前面的测试计算中，共有 14 个任务。在 Ex50 这一节中<code>vtotav-v5.2f</code>, <code>vtotav.py</code> 或者 p4vasp 这三种可视化的方法，我们查找真空能级的数值，都必须读取数据文件，比如 VLINE, LOCPOT_Z 或者 p4vasp 导出来的 *dat 文件。所以，我们要分别在这 14 个任务的文件夹中重复 Ex50 的操作14次。手动挨个弄可以完全实现，但本人不想这么做，因为这样弄除了让你的操作更熟练些外，并不会有其他的收获。那就写个脚本批量处理吧。</p>
<p><img src="/2018/09/06/ex52/ex52-2.png" alt=""></p>
<p>首先我们分析下上图： 我们获取的真空能级在图中直线部分中间的一个点或者一个小区间的平均值。大约是真空层一半的高度。比如，我们的表层原子 z 方向坐标为 6，真空层厚度为 16，那么我们可以取 6 + (16/2)= 14 时对于的点来得到真空能级。也可以通过 [14-1, 14+1] 这个区间中所有的真空能级求平均数来获得。下面我们看一下脚本的主要内容：</p>
<ol>
<li><p>注意部分：</p>
<p>使用这个脚本的时候，需要注意的内容。本人写了一堆废话在脚本里面，主要是提醒大家使用脚本的时候，需要注意的一些事项。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Welcome to visit our website: www.bigbrosci.com to get more useful information.</span></span><br><span class="line"> </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Written By Qiang </span></span><br><span class="line"><span class="string">This script has two functions:</span></span><br><span class="line"><span class="string"> 1) workfunction Visualization from LOCPOT_Z file</span></span><br><span class="line"><span class="string"> 2) Roughly estimate the Vaccum Energy</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Please Contact lqcata@gmail.com if you have questions.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Note1: Read POSCAR with Cartesian coordinations! </span></span><br><span class="line"><span class="string">  This means </span></span><br><span class="line"><span class="string">  1) you have to convet the direct to cartesian firstly </span></span><br><span class="line"><span class="string">  2) otherwise you will get an error.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Note2: Read LOCPOT_Z to plot the figure and calculate the vaccum energy</span></span><br><span class="line"><span class="string">  This means </span></span><br><span class="line"><span class="string">  1)1you have to run command:  work.py LOCPOT z firstly to get the LOCPOT_Z file before use this script</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Note3: the idea to calculate the vaccum energy is following:</span></span><br><span class="line"><span class="string">  1) get the middle z value in the plateau: </span></span><br><span class="line"><span class="string">     middle z value = ( coordination of the highest atom + length of the slab in z direction) / 2 </span></span><br><span class="line"><span class="string">  2) selecte the area to calculate the vaccum energy: </span></span><br><span class="line"><span class="string">     from  (middle z  value - 1) to (middle z value + 1)  unit is in angstrom </span></span><br><span class="line"><span class="string">  3) do the average of all points y direction.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Note 4: this is only a rough estimation but useful.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Note 5: Check the figure firstly and then use the numbers calculated from this script. </span></span><br><span class="line"><span class="string">  1) If the midlle z value is far from the plateau in the figure, you have to calculate the energy by hand.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ol>
<li>脚本是谁写的，主要功能是什么；</li>
<li>脚本读取 POSCAR, POSCAR 要为 Cartesian 坐标；</li>
<li>脚本默认读取 LOCPOT_Z 文件，如果没有该文件，你需要做的一些事情(生成以及如何将 VLINE 文件转换为 LOCPOT_Z 文件)</li>
<li>该脚本是如何获取真空能级的；</li>
<li>一定要查看功函数可视化的结果，用来判断我们的这个方法是否试用。</li>
</ol>
<p>写这么多废话，原因主要有 2 个：</p>
<ol>
<li>提醒大家在使用别人脚本的时候，一些需要注意的事项你要清楚。如果不清楚，可以咨询下脚本的作者；</li>
<li>如果你写了一个脚本放到网上供大家使用，请花些时间写清楚脚本的运行原理，以及尽可能详细的注意事项。</li>
</ol>
</li>
<li><p>脚本正文：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line">x = []</span><br><span class="line">y = []</span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;LOCPOT_Z&quot;</span>, mode=<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    first_line = f.readline()</span><br><span class="line">    name_x = first_line.split()[<span class="number">1</span>]</span><br><span class="line">    name_y = first_line.split()[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        xy=line.rstrip().split()</span><br><span class="line">        x.append(<span class="built_in">float</span>(xy[<span class="number">0</span>]))</span><br><span class="line">        y.append(<span class="built_in">float</span>(xy[<span class="number">1</span>]))</span><br><span class="line">        dic.update(&#123;xy[<span class="number">0</span>]:xy[<span class="number">1</span>]&#125;)</span><br><span class="line">plt.plot(x,y) </span><br><span class="line">plt.xlabel(name_x) </span><br><span class="line">plt.ylabel(name_y) </span><br><span class="line">plt.savefig(<span class="string">&#x27;workfunction&#x27;</span> + <span class="string">&#x27;.pdf&#x27;</span>, dpi=<span class="number">400</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment">#%%%%%%%%%%%%%%%%%%%%%%#</span></span><br><span class="line"><span class="comment"># Get the Vaccum Energy</span></span><br><span class="line"><span class="comment">#%%%%%%%%%%%%%%%%%%%%%%#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the total line numbers of POSCAR </span></span><br><span class="line">num_lines = <span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;POSCAR&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read POSCAR </span></span><br><span class="line">pos = <span class="built_in">open</span>(<span class="string">&#x27;POSCAR&#x27;</span>, mode = <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">line = pos.readlines()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get  the  slab length in z direction </span></span><br><span class="line">vaccum = <span class="built_in">float</span>(line[<span class="number">4</span>].split()[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get all atoms&#x27; coordination in z direction and store them in the list</span></span><br><span class="line">z_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>, num_lines): </span><br><span class="line">    z_list.append(<span class="built_in">float</span>(line[i].split()[<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#  max(z_list) is highest atoms&#x27; coordination in z direction</span></span><br><span class="line"><span class="comment"># Get the vaccum lenth: </span></span><br><span class="line">l_vaccum = vaccum - <span class="built_in">max</span>(z_list)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;The Vaccum in this calculation is:\t\t %s&#x27;</span>  %(l_vaccum)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Choose the middle z value in the workfuntion.pdf </span></span><br><span class="line">num_middle = (<span class="built_in">max</span>(z_list) + vaccum) / <span class="number">2</span> </span><br><span class="line"><span class="comment">#print num_middle</span></span><br><span class="line"></span><br><span class="line">middle_y = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dic.keys():</span><br><span class="line">    i = <span class="built_in">float</span>(i)</span><br><span class="line"><span class="comment"># Select the date area within 1 angstrom from the middle point:</span></span><br><span class="line">    <span class="keyword">if</span> i &gt; num_middle -<span class="number">1</span> <span class="keyword">and</span> i &lt;  num_middle + <span class="number">1</span>:</span><br><span class="line">        middle_y.append(<span class="built_in">float</span>(dic.get(<span class="built_in">str</span>(i))))</span><br><span class="line"><span class="comment"># Get the average value in the selected area</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;The Vaccum Energy in this calculation is:\t %s&#x27;</span>  %(np.mean(middle_y))</span><br><span class="line"></span><br><span class="line">pos.close()</span><br></pre></td></tr></table></figure>
<ol>
<li><p><code>plt.show()</code> 之前为我们 Ex50 这一节可视化的脚本： 44 和 53 行中，额外将 LOCPOT_Z 中两列的数据保存到一个字典里面，便于后面根据 z 方向的坐标查找真空能级。</p>
</li>
<li><p>获取 POSCAR 文件总的行数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">num_lines = sum(1 for line in open(&#x27;POSCAR&#x27;))</span><br></pre></td></tr></table></figure>
</li>
<li><p>读取 POSCAR 文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pos = open(&#x27;POSCAR&#x27;, mode = &#x27;r&#x27;)</span><br><span class="line">line = pos.readlines()</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取 slab 在 z 方向的数值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vaccum = float(line[4].split()[2])</span><br></pre></td></tr></table></figure>
</li>
<li><p>将所有原子的 z 坐标保存到 z_list 数列中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">z_list = []</span><br><span class="line">for i in range(9, num_lines): </span><br><span class="line">  z_list.append(float(line[i].split()[2]))</span><br></pre></td></tr></table></figure>
</li>
<li><p>获得真空层的厚度</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">l_vaccum = vaccum - max(z_list)</span><br></pre></td></tr></table></figure>
</li>
<li><p>计算距离表层原子一半真空层厚度的z方向的数值： num_middle</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">num_middle = (max(z_list) + vaccum) / 2 </span><br></pre></td></tr></table></figure>
</li>
<li><p>将 [num_middle-1, num_middle+1] 区间范围内所有的真空能级提取出来，并保存到middle_y 这个数列中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">middle_y = []</span><br><span class="line"></span><br><span class="line">for i in dic.keys():</span><br><span class="line">    i = float(i)</span><br><span class="line"># Select the date area within 1 angstrom from the middle point:</span><br><span class="line">    if i &gt; num_middle -1 and i &lt;  num_middle + 1:</span><br><span class="line">        middle_y.append(float(dic.get(str(i)))</span><br></pre></td></tr></table></figure>
</li>
<li><p>求平均值，并打印出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print &#x27;The Vaccum Energy in this calculation is:\t %s&#x27;  %(np.mean(middle_y))</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>运行脚本：</p>
<p><img src="/2018/09/06/ex52/ex52-3.png" alt=""></p>
<p>图中第一个命令中，输出比较复杂，并且会和前面示例一样，展示功函数可视化的结果。</p>
<p>但这不便于批量提取数据，可注销脚本中一下三行，直接获取真空能级</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#plt.show() </span><br><span class="line">#print &#x27;The Vaccum in this calculation is:\t\t %s&#x27;  %(l_vaccum)</span><br><span class="line">#print &#x27;The Vaccum Energy in this calculation is:\t %s&#x27;  %(np.mean(middle_y))</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用脚本批量获取真空能级</p>
<p>先将脚本复制到bin文件夹中，赋予可执行权限。</p>
<p><img src="/2018/09/06/ex52/ex52-4.png" alt=""></p>
<ol>
<li><p>批量生成 LOCPOT_Z 文件：</p>
<p><img src="/2018/09/06/ex52/ex52-5.png" alt=""></p>
</li>
<li><p>使用脚本批量读取</p>
<p><img src="/2018/09/06/ex52/ex52-6.png" alt=""></p>
</li>
</ol>
</li>
<li><p>批量获得费米能级：</p>
<p><img src="/2018/09/06/ex52/ex52-7.png" alt=""></p>
<p>我们需要的为第 4 列的数据。(图中的冒号也算作一列)</p>
</li>
</ol>
<h3 id="3-数据分析："><a href="#3-数据分析：" class="headerlink" title="3 数据分析："></a>3 数据分析：</h3><p><img src="/2018/09/06/ex52/ex52-8.png" alt=""></p>
<p>真空能级，费米能级以及功函数随真空层厚度的变化</p>
<p><img src="/2018/09/06/ex52/ex52-9.png" alt=""></p>
<p>图中的测试曲线看起来很漂亮，但纵坐标范围太大，我们将功函数随真空层的变化作图如下：</p>
<p><img src="/2018/09/06/ex52/ex52-10.png" alt=""></p>
<p>从图中，可以看出： 20-30 Å 范围内，功函数的波动变化较小，为 4.81 eV。其他的波动值在 4.85-4.87 eV 之间。Cu(111) 表面的功函数为：4.94 eV。参考的是 CRC handbook 中的数值。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Gu</th>
<th style="text-align:center">100</th>
<th style="text-align:center">5.10</th>
<th style="text-align:center">FE</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">110</td>
<td style="text-align:center">4.48</td>
<td style="text-align:center">PE</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">111</td>
<td style="text-align:center">4.94</td>
<td style="text-align:center">PE</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">112</td>
<td style="text-align:center">4.53</td>
<td style="text-align:center">PE</td>
</tr>
</tbody>
</table>
</div>
<p>实验与理论偏差为： -0.13 / 4.94  = 2.63 %</p>
<p>师兄，实验值结果是 4.94 eV， 如果我们采用 30 Å 时的结果 (4.87 eV)，跟实验的差别更小，是不是更好?</p>
<p>可以这么说。但是</p>
<ol>
<li>从我们测试的结果可以看出来，功函数随着真空层的变化，存在一个计算的误差；</li>
<li>实验测量值也会有一定的误差范围。</li>
</ol>
<p>所以，如果你硬要把理论和实验结果完美地吻合，这是很难做到的，这当然也是大家所梦寐以求的终极目标。一般来说，只要在合理的误差范围之内 (5% 的样子)，跟实验值结果一致就可以了，此外，如果你发表文章的时候，为了保证计算的可重复性。计算参数设置，模型尺寸等都要尽可能地详细。</p>
<p>师兄，不是说真空层对功函数的影响很大吗，为什么在 10 Å 的时候，得到的功函数 (4.80 eV) 和 20 Å (4.81 eV) 的时候一样?</p>
<p>这是因为，在当前的体系下，4 层的 p(1x1)-Cu(111) 表面，10 Å 已经可以了。但 10-20 Å 时，误差波动较大。12 Å 的数据也可以用，如同前面所提到的，他们都在一个合理的误差范围之内，但必须注明你的模型尺寸。对于其他的体系，还需要大家自己动手去测试一下。</p>
<p>此外，给大家推荐一篇文章：<a target="_blank" rel="noopener" href="https://pubs.rsc.org/is/content/articlehtml/2016/mh/c5mh00160a">Fermi level, work function and vacuum level</a></p>
<p><img src="/2018/09/06/ex52/ex52-11.png" alt=""></p>
<p>本文刚刚开始的图片就是从这篇文章中偷过来的。</p>
<h3 id="4-扩展练习："><a href="#4-扩展练习：" class="headerlink" title="4 扩展练习："></a>4 扩展练习：</h3><ol>
<li>复习功函数的相关内容；</li>
<li>计算，测试自己研究体系的功函数；</li>
<li>弄清获取真空能级的脚本原理(切记，搞不明白之前，不可乱用！！！)</li>
</ol>
<h3 id="5-总结："><a href="#5-总结：" class="headerlink" title="5 总结："></a>5 总结：</h3><p>到本节为止，功函数的计算就先简单介绍到这里了，计算步骤，可视化以及测试都大体讲解了一下。但我们用的模型例子比较简单，如果你的体系复杂，计算仍有疑问，请在 QQ 群中交流或者发邮件给我 (lqcata@gmail.com) 。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/09/05/ex51/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/09/05/ex51/" class="post-title-link" itemprop="url">Ex51 影响功函数计算的因素（一）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-05 02:06:48" itemprop="dateCreated datePublished" datetime="2018-09-05T02:06:48-04:00">2018-09-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/09/05/ex51/" class="post-meta-item leancloud_visitors" data-flag-title="Ex51 影响功函数计算的因素（一）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/09/05/ex51/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/09/05/ex51/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前面我们通过 Cu(111) 表面作为例子，学会了功函数计算的基本步骤和可视化过程。那么功函数计算的时候，需要注意的事项有哪些呢？</p>
<h3 id="1-INCAR中的参数"><a href="#1-INCAR中的参数" class="headerlink" title="1  INCAR中的参数"></a>1  INCAR中的参数</h3><p>计算功函数的参数：<code>LVHAR =.TRUE.</code></p>
<p>加入这一参数时，VASP 只将静电势能写入 LOCPOT 文件中。</p>
<p>在早期的 VASP 版本中，静电势的写入是通过设置 LVTOT 这个参数的。</p>
<p>在 5.2.12 版本之后，如果你设置 <code>LVTOT= .TRUE.</code>，那么静电势，交换相关势都会写入到 LVTOT 中。由于我们计算功函数的时候，只需要静电势这一部分。所以，如果你用的是 5.2.12 版本之后的 VASP，设置 <code>LVHAR= .TRUE.</code> 即可。</p>
<p>如果有疑惑的话，不妨做个测试，分别设置 LVTOT 和 LVHAR = .TRUE. 然后做个单点计算对比下结果。</p>
<p>设置 <code>LVTOT = .TRUE.</code> 的结果如下：</p>
<p><img src="/2018/09/05/ex51/ex51-2.jpeg" alt=""></p>
<p>设置 <code>LVHAR = .TRUE.</code> 的结果如下：</p>
<p><img src="/2018/09/05/ex51/ex51-3.jpeg" alt=""></p>
<p>我们对比下 13-15 $\AA$范围内纵坐标的大小和平均值</p>
<p><img src="/2018/09/05/ex51/ex51-4.png" alt=""></p>
<p>很显然，两个参数对功函数的影响是不可忽略的。使用 LVTOT 这个参数，由于加入了交换相关势，曲线变得不再那么光滑，并且与 LVHAR 的结果有一定的偏差。所以，在计算功函数的时候，LVHAR 这个参数一定要注意。</p>
<p> 这一点也体现在VASP官网最新的ppt中，如下如：(自己主动根据下图中的关键词找这个 ppt，别问我要，也不要在大师兄群里求助浪费别人的时间。)</p>
<p><img src="/2018/09/05/ex51/ex51-5.jpeg" alt=""></p>
<p><img src="/2018/09/05/ex51/ex51-6.png" alt=""></p>
<p><strong>注意：</strong></p>
<p>在 Hand-on-session (<strong>老版本</strong>的官方教程)中，使用的是 LVTOT 这个参数。老版本就是过时的意思。希望大家的以新版本的计算为准。</p>
<p><img src="/2018/09/05/ex51/ex51-7.png" alt=""></p>
<p>老版本中功函数的计算例子。</p>
<h3 id="2-真空层的厚度及修改"><a href="#2-真空层的厚度及修改" class="headerlink" title="2 真空层的厚度及修改"></a>2 真空层的厚度及修改</h3><p>真空层的厚度：指的是 slab 在 z (或者 c )方向上的长度减去表面原子在 z 方向的坐标。</p>
<p><img src="/2018/09/05/ex51/ex51-8.png" alt=""></p>
<p>Slab 方向的长度，指的是 POSCAR 或者 CONTCAR 中第 5 行中的数值，上图箭头所指的地方。</p>
<p>那么我们怎么修改真空层的厚度呢？</p>
<p>由于 slab 模型中的原子部分就在那边乖乖地待着，我们只需改变 slab 中晶格常数在 z 或者 c 方向的长度即可。</p>
<p>例子1：上图中真空层的厚度为 15 $\AA$，我们需要一个 20 $\AA$  的 slab 模型，也就是在 21.2994 的基础上再加 5 个 $\AA$，等于 26.2994。但这样做，对不对呢？修改之后的 POSCAR：</p>
<p><img src="/2018/09/05/ex51/ex51-9.png" alt=""></p>
<p>结构如下图：</p>
<p><img src="/2018/09/05/ex51/ex51-10.png" alt=""></p>
<p>我们发现 slab 的 Cu 原子部分之间好像也被拉长了。测量了一下两个 Cu 原子之间的距离为： 2.956 Å。</p>
<p><img src="/2018/09/05/ex51/ex51-11.png" alt=""></p>
<p>修改之前为： 2.547 Å。</p>
<p><img src="/2018/09/05/ex51/ex51-12.png" alt=""></p>
<p>所以：我们在前面的操作中，直接修改的 z 方向的数值，<strong>方法是错误的。</strong></p>
<p>原因在于：前面的结构中坐标为分数坐标： Direct</p>
<p>我们修改完成之后，Cu 原子在 c 方向的距离也会发生相应的改变。</p>
<p>所以，如果直接修改 POSCAR 或者 CONTCAR 改变真空层厚度的话，我们一定一定要先将它们转化为 Cartesian 坐标。怎么转化呢？</p>
<p>方法1：用软件操作，比如 p4vasp。</p>
<p><img src="/2018/09/05/ex51/ex51-13.png" alt=""></p>
<p>我们可以切换坐标通过鼠标点一下即可，然后保存成 Cartesian 的 POSCAR。</p>
<p>当然啦，也可以使用其他软件，比如 VESTA 等等，更好的选择，也欢迎留言补充。</p>
<p>方法2：使用脚本转换：</p>
<ol>
<li><p>VASP 官网在 POSCAR 的解释部分，提到了怎么进行坐标切换的公式。</p>
<p>链接如下：<a target="_blank" rel="noopener" href="https://cms.mpi.univie.ac.at/vasp/vasp/POSCAR_file.html">https://cms.mpi.univie.ac.at/vasp/vasp/POSCAR_file.html</a> </p>
<p><img src="/2018/09/05/ex51/ex51-14.png" alt=""></p>
</li>
<li><p>在此基础上，本人写了一个 python 的小脚本，可以实现 Direct 到 Cartesian 的转换。 </p>
<p>运行如下：</p>
<p><img src="/2018/09/05/ex51/ex51-15.png" alt=""></p>
<p>图中流程的解释：</p>
<ol>
<li>将一个计算中的 CONTCAR 复制过来；</li>
<li>使用 head -n 10 看一下这个 CONTCAR 的文件结构。(10 指的是前面 10 行，如果你想看前面 5 行，使用 head -n 5 )；</li>
<li>dire2cart.py CONTCAR  使用脚本进行转换，转换的对象为 CONTCAR；</li>
<li>转换完成后，Cartesian 的保存为 CONTCAR_C 文件；</li>
<li>cat CONTCAR_C 这个命令查看转化后的内容。(当然也可以继续使用前面的 head 命令) </li>
</ol>
<p>本脚本下载链接： <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1eRMJ7m6">https://pan.baidu.com/s/1eRMJ7m6</a>   密码：btsl</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">#Convert direc coordiation to cartesian Writen By Qiang </span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"> </span><br><span class="line">script, file_to_be_converted = sys.argv </span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">###################################</span></span><br><span class="line"><span class="string">#                                 #</span></span><br><span class="line"><span class="string">#for VASP 5.2 or higher versions  #</span></span><br><span class="line"><span class="string">#                                 #</span></span><br><span class="line"><span class="string">###################################</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">file_read = <span class="built_in">open</span>(file_to_be_converted, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">line = file_read.readlines()</span><br><span class="line">a1 = <span class="built_in">float</span>(line[<span class="number">2</span>].split()[<span class="number">0</span>])</span><br><span class="line">a2 = <span class="built_in">float</span>(line[<span class="number">3</span>].split()[<span class="number">0</span>])</span><br><span class="line">a3 = <span class="built_in">float</span>(line[<span class="number">4</span>].split()[<span class="number">0</span>])</span><br><span class="line">b1 = <span class="built_in">float</span>(line[<span class="number">2</span>].split()[<span class="number">1</span>])</span><br><span class="line">b2 = <span class="built_in">float</span>(line[<span class="number">3</span>].split()[<span class="number">1</span>])</span><br><span class="line">b3 = <span class="built_in">float</span>(line[<span class="number">4</span>].split()[<span class="number">1</span>])</span><br><span class="line">z1 = <span class="built_in">float</span>(line[<span class="number">2</span>].split()[<span class="number">2</span>])</span><br><span class="line">z2 = <span class="built_in">float</span>(line[<span class="number">3</span>].split()[<span class="number">2</span>])</span><br><span class="line">z3 = <span class="built_in">float</span>(line[<span class="number">4</span>].split()[<span class="number">2</span>])</span><br><span class="line"> </span><br><span class="line">num_atoms = <span class="built_in">sum</span>([<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> line[<span class="number">6</span>].split()])</span><br><span class="line"> </span><br><span class="line">x_cartesian = []</span><br><span class="line">y_cartesian = []</span><br><span class="line">z_cartesian = []</span><br><span class="line">tf = []</span><br><span class="line"> </span><br><span class="line">start_num = <span class="number">9</span> <span class="comment"># Default: With Selected T T T, coordination starts from line 9</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert</span>():</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start_num, num_atoms + start_num):</span><br><span class="line">        x_cartesian.append(<span class="built_in">float</span>(line[i].split()[<span class="number">0</span>]) * a1 + <span class="built_in">float</span>(line[i].split()[<span class="number">1</span>]) * a2 + <span class="built_in">float</span>(line[i].split()[<span class="number">2</span>]) * a3)</span><br><span class="line">        y_cartesian.append(<span class="built_in">float</span>(line[i].split()[<span class="number">0</span>]) * b1 + <span class="built_in">float</span>(line[i].split()[<span class="number">1</span>]) * b2 + <span class="built_in">float</span>(line[i].split()[<span class="number">2</span>]) * b3)</span><br><span class="line">        z_cartesian.append(<span class="built_in">float</span>(line[i].split()[<span class="number">0</span>]) * z1 + <span class="built_in">float</span>(line[i].split()[<span class="number">1</span>]) * z2 + <span class="built_in">float</span>(line[i].split()[<span class="number">2</span>]) * z3)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(line[i].split()) &gt; <span class="number">3</span>:   <span class="comment"># if  T T T exist, there are more than 3 elements in the list line[i].split()</span></span><br><span class="line">            tf.append((line[i].split()[<span class="number">3</span>]))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tf.append(<span class="string">&#x27; &#x27;</span>)   <span class="comment"># if there is no T T T, use space instead. </span></span><br><span class="line">     </span><br><span class="line">    file_out = <span class="built_in">open</span>(file_to_be_converted+<span class="string">&#x27;_C&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">7</span>):</span><br><span class="line">        file_out.write(line[i].rstrip() + <span class="string">&#x27;\n&#x27;</span>)  <span class="comment"># first 7 lines are kept the same </span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;S&#x27;</span> <span class="keyword">in</span> line[<span class="number">7</span>]:</span><br><span class="line">        file_out.write(line[<span class="number">7</span>].rstrip()+ <span class="string">&#x27;\n&#x27;</span>)  <span class="comment"># if  T T T exists, write the Selective line </span></span><br><span class="line">    file_out.write(<span class="string">&#x27;Cartesian&#x27;</span> + <span class="string">&#x27;\n&#x27;</span>)          <span class="comment"># Coordination system is Cartesian now. </span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(x_cartesian)):</span><br><span class="line">        file_out.write(<span class="string">&quot;%+-3.10f   %+-3.10f   %+-3.10f   %s %s %s\n&quot;</span> </span><br><span class="line">        %(x_cartesian[i], y_cartesian[i], z_cartesian[i], tf[i], tf[i], tf[i]))</span><br><span class="line">     </span><br><span class="line">    file_out.close()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;-----------------------------------------------------\n&#x27;</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;POSCAR with Cartesian Coordiations is named as %s_C\n&#x27;</span> %(file_to_be_converted)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;-----------------------------------------------------\n&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> line[<span class="number">7</span>][<span class="number">0</span>]  == <span class="string">&#x27;S&#x27;</span> <span class="keyword">or</span> line[<span class="number">7</span>][<span class="number">0</span>]  == <span class="string">&#x27;s&#x27;</span>:  <span class="comment"># # With Selected T T T, coordination starts from line 9</span></span><br><span class="line">    start_num = <span class="number">9</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>  line[<span class="number">8</span>][<span class="number">0</span>]  == <span class="string">&#x27;D&#x27;</span> <span class="keyword">or</span> line[<span class="number">8</span>][<span class="number">0</span>]  == <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">This POSCAR has Direct Coordinations, Conversion is starting....</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">              &quot;&quot;&quot;</span></span><br><span class="line">        convert()</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">elif</span>  line[<span class="number">8</span>][<span class="number">0</span>]  == <span class="string">&#x27;C&#x27;</span> <span class="keyword">or</span> line[<span class="number">8</span>][<span class="number">0</span>]  == <span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">This POSCAR has Cartesian Coordinations! Process is aborted!</span></span><br><span class="line"><span class="string">               </span></span><br><span class="line"><span class="string">              &quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">else</span> : </span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">----------------------------------------------------</span></span><br><span class="line"><span class="string">Pay Attetion! There is no TTT in coordinations part!</span></span><br><span class="line"><span class="string">----------------------------------------------------</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">     </span><br><span class="line">    start_num = <span class="number">8</span> <span class="comment"># without Selected, No  T T T , coordination starts from line 8 </span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">if</span>  line[<span class="number">7</span>][<span class="number">0</span>]  == <span class="string">&#x27;D&#x27;</span> <span class="keyword">or</span> line[<span class="number">7</span>][<span class="number">0</span>]  == <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">This POSCAR has Direct Coordinations, Contersion starts....</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">        convert()</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">elif</span>  line[<span class="number">7</span>][<span class="number">0</span>]  == <span class="string">&#x27;C&#x27;</span> <span class="keyword">or</span> line[<span class="number">7</span>][<span class="number">0</span>]  == <span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"><span class="string">This POSCAR has Cartesian Coordinations already! </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">Process is aborted!</span></span><br><span class="line"><span class="string">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">file_read.close()</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>那么怎么把 Cartesian 转化为 Direct 呢？</p>
<ol>
<li>使用 VASP，因为 VASP 的默认输出就是 Direct 坐标，算个单点就可以啦（笑话，别当真！）；</li>
<li>使用 p4vasp 等其他软件；</li>
<li>写个脚本倒着再做一遍，不过本人经常使用的是 Cartesian 坐标，懒得再写了，有兴趣的可以自己试试。</li>
</ol>
<h3 id="3-批量处理POSCAR"><a href="#3-批量处理POSCAR" class="headerlink" title="3 批量处理POSCAR"></a>3 批量处理POSCAR</h3><p>当我们完成转化后，就可以批量处理 Cartesian 坐标的 POSCAR 了。</p>
<ol>
<li><p>先准备一个文件夹，名字为 10，这个文件夹中有一个真空层为：10 Å 的 POSCAR 以及 INCAR, KPOINTS, POTCAR， 任务脚本；</p>
</li>
<li><p>运行命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for i in $(seq 12 2 36); do cp 10 $i ; sed -i &quot;5s/16/$((6+$i))/g&quot; $i/POSCAR; done</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例演示：</p>
<p><img src="/2018/09/05/ex51/ex51-16.png" alt=""></p>
<p>运行完这个命令后,会生成从 12 到 36 的 N 个文件夹，每个文件夹之间间隔为 2。我们通过下面这个命令查看所有文件夹中 POSCAR 中 z 方向的大小：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for i in *; do head -n 5 $i/POSCAR | tail -n 1 ; done</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><strong>解释：</strong></p>
<ul>
<li><p>head -n 5 $i/POSCAR 获取POSCAAR前5行中的内容，</p>
</li>
<li><p>后面跟着一个 |tail -n 1， 这个命令的意思是，显示前面5行中的最后一行。</p>
</li>
<li><p>head 和 tail 这两个命令之间用  |  (pipe) 连在一起，表示将前面 head 命令的结果传递给后面的 tail 命令。</p>
</li>
<li><p>任务准备好之后，批量提交就可以了。(不会的话，请前面自己翻批量操作的介绍。)</p>
</li>
</ul>
<h3 id="4-扩展练习："><a href="#4-扩展练习：" class="headerlink" title="4 扩展练习："></a>4 扩展练习：</h3><ol>
<li>使用 LVTOT 和 LVHAR 测试一下，加深下印象；</li>
<li>使用不同的测试不同真空层对功函数的影响以遍下一节的学习。</li>
</ol>
<h3 id="5-总结："><a href="#5-总结：" class="headerlink" title="5 总结："></a>5 总结：</h3><p>下一节我们讨论一下真空层对计算功函数的影响，以及如何批量获取真空能级。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/09/04/ex50/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/09/04/ex50/" class="post-title-link" itemprop="url">Ex50 功函数（work function）的计算（二）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-04 02:06:48" itemprop="dateCreated datePublished" datetime="2018-09-04T02:06:48-04:00">2018-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/09/04/ex50/" class="post-meta-item leancloud_visitors" data-flag-title="Ex50 功函数（work function）的计算（二）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/09/04/ex50/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/09/04/ex50/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="/2018/09/04/ex50/ex50-1.png" alt=""></p>
<p>前面一节我们介绍了计算功函数的具体流程，以及用p4vasp获取真空能级的方法。</p>
<p>本节我们介绍另外两个方法，从本质上来说，这些方法是一样的，都是基于对 LOCPOT 中数据的处理。</p>
<h3 id="1-使用-vtotav-v5-2f-脚本"><a href="#1-使用-vtotav-v5-2f-脚本" class="headerlink" title="1 使用 vtotav-v5.2f 脚本"></a>1 使用 vtotav-v5.2f 脚本</h3><p>操作流程如下：</p>
<p><img src="/2018/09/04/ex50/ex50-2.jpeg" alt=""></p>
<p><strong>注意：</strong></p>
<ol>
<li><p><code>gfortran -o vtotav.x vtotav-5.2f</code></p>
<p>这个命令将 <code>vtotav-5.2f</code> 这 个脚本编译成可执行文件 <code>vtotav.x</code>。</p>
<p>gfortran 不管用的话可以试试<code>ifort -o vtotav.xvtotav-5.2f</code>这个命令。</p>
</li>
<li><p>./vtotav.x 在当前目录下运行这个可执行文件;会让你选择计算的方向，这里我们 slab 的真空层是在 z 方向，所以我们输入 3  (回想一下，上一节，我们在 p4vasp 中选择z方向的鼠标操作，它们是一样的)，都是讲 LOCPOT 文件处理，然后生成z方向的相关数据。</p>
</li>
<li><p>运行完毕后，当前目录下会多出来一个 VLINE 文件。这个文件就是 p4vasp 中选择 z 方向之后所显示的红线数据，(不过横坐标有些不同)。</p>
</li>
<li><p>我们看一下 VLINE 文件的数据内容，第一行中 224 代表有 224 个点，3 代表 z 方向。</p>
</li>
<li><p>VLINE 文件中横坐标为当前点的序号，从 1-224，而 p4vasp 中导出来的文件，横坐标为 z 方向的坐标，不过这个不影响我们对真空能级的计算。</p>
</li>
</ol>
<p>上图中最后的两行命令，</p>
<ol>
<li>从上一级目录下拷贝了一个 python 脚本，名为：<code>wplot-f.py</code>；</li>
<li>运行这个 python 脚本，效果如下：</li>
</ol>
<p><img src="/2018/09/04/ex50/ex50-3.jpeg" alt=""></p>
<p>我们又得到了前面一节的功函数的图像。真空能级，大家从 150 前后取个值即可，也可以在一段直线的区间范围内求个平均数。</p>
<p>对比下前面一节和本节中的数据：</p>
<p><img src="/2018/09/04/ex50/ex50-4.png" alt=""></p>
<p>左图为本节的，右图为上节的。</p>
<p>Python 脚本这么神奇，是怎么写出来的呢？脚本内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># Written By Qiang for workfunction Visualization from VLINE file</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">x = []</span><br><span class="line">y = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;VLINE&quot;</span>, mode=<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">next</span>(f)</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        xy=line.rstrip().split()</span><br><span class="line">        x.append(<span class="built_in">float</span>(xy[<span class="number">0</span>]))</span><br><span class="line">        y.append(<span class="built_in">float</span>(xy[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">plt.plot(x,y) </span><br><span class="line">plt.savefig(<span class="string">&#x27;workfunction&#x27;</span> + <span class="string">&#x27;.pdf&#x27;</span>, dpi=<span class="number">400</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>思路如下：</p>
<ol>
<li>读取 VLINE 文件；</li>
<li>第一行画图的时候用不着，需要跳过，next(f)；</li>
<li>将剩下的那些行中，第一个数存到 x 列表里面，第二个数存到 y 列表里面；</li>
<li>使用 matplotlib 中的 pyplot 读取 x， y 列表中的数据，进行画图： plt.plot(x,y)；</li>
<li>将生成的图保存成 workfunction.pdf 文件，分辨率 dpi 为 400。</li>
</ol>
<p><strong>注意：</strong></p>
<ol>
<li>如果你想保存成 eps, png, jpg,只需将 .pdf 改成 .eps, .png, .jpg 即可；</li>
<li>如果想要分辨率更高，可以修改400这个数值；</li>
<li>如果只想保存成 pdf 文件，不想弹出图片的查看窗口，把 plt.show() 这一行注释掉就可以了， # plt.show()；</li>
<li>如果只想看一下图，不想保存 pdf 文件，将第 16 行注释掉就可以了。</li>
</ol>
<h3 id="2-使用-vtotav-py-脚本"><a href="#2-使用-vtotav-py-脚本" class="headerlink" title="2 使用 vtotav.py 脚本"></a>2 使用 vtotav.py 脚本</h3><p>第一个脚本就讲到这里了，这个脚本不错，唯一的缺点就是横坐标不是 z 方向的数值，那么我们看一下第二个脚本的操作。</p>
<p><img src="/2018/09/04/ex50/ex50-5.jpeg" alt=""></p>
<p><strong>注意：</strong></p>
<ol>
<li><p>这里用到的脚本名字为：<code>vtotav.py</code>；</p>
</li>
<li><p>vtotav.py LOCPOT z  这个命令意思是，用 vtotav.py 读取 LOCPOT 文件，并处理生成 z 方向的数据；</p>
</li>
<li><p>脚本运行完毕后，目录中多了一个 LOCPOT_Z 文件，这个文件内容如下：</p>
<p><img src="/2018/09/04/ex50/ex50-6.jpeg" alt=""></p>
</li>
<li><p>图中最后两行，</p>
<ol>
<li>大师兄又从前面的目录下拷贝了一个脚本： wplot.py；</li>
<li>然后运行这个 python 脚本， 效果如下：</li>
</ol>
</li>
</ol>
<p><img src="/2018/09/04/ex50/ex50-7.jpeg" alt=""></p>
<p>这个脚本中，横坐标为 z 方向的大小，比前面的脚本有所改进，和 p4vasp 的数据是一样的。首先我们先看一下可视化的脚本，然后再讲解 vtotav.py 这个脚本的获取和使用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># Written By Qiang for workfunction Visualization from LOCPOT_Z file</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">x = []</span><br><span class="line">y = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;LOCPOT_Z&quot;</span>, mode=<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    first_line = f.readline()</span><br><span class="line">    name_x = first_line.split()[<span class="number">1</span>]</span><br><span class="line">    name_y = first_line.split()[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        xy=line.rstrip().split()</span><br><span class="line">        x.append(<span class="built_in">float</span>(xy[<span class="number">0</span>]))</span><br><span class="line">        y.append(<span class="built_in">float</span>(xy[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">plt.plot(x,y) </span><br><span class="line">plt.xlabel(name_x) </span><br><span class="line">plt.ylabel(name_y) </span><br><span class="line">plt.savefig(<span class="string">&#x27;workfunction&#x27;</span> + <span class="string">&#x27;.pdf&#x27;</span>, dpi=<span class="number">400</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>这个跟前面的那个脚本很像，不同的地方在于这个脚本中读取了第一行的内容，并将它们作为横坐标和纵坐标的名字。(Distance 和 Potential)</p>
<h3 id="3-vtotav-py-脚本的获取和使用"><a href="#3-vtotav-py-脚本的获取和使用" class="headerlink" title="3 vtotav.py 脚本的获取和使用"></a>3 vtotav.py 脚本的获取和使用</h3><p>这个脚本可以在github网站免费下载，网址为：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/compphys/ase_tools/blob/master/scripts/vtotav.py">https://github.com/compphys/ase_tools/blob/master/scripts/vtotav.py</a> </p>
<p><img src="/2018/09/04/ex50/ex50-8.jpeg" alt=""></p>
<p>本人的做法是：</p>
<ol>
<li>把图中的代码复制下来，然后保存到一个文本里面，将文本命名为：vtotav.py；</li>
<li>赋予脚本可执行权限： chmod u+x vtotav.py；</li>
<li>将脚本移至 ~/bin 目录下： mv vtotav.py ~/bin；</li>
<li>然后直接用就可以了，跟前面图中的操作一样。</li>
</ol>
<p>不过本人刚刚发现这个脚本可以按照下面的方法下载，下载完成后，重复前面的 2-4 步即可：</p>
<ol>
<li><p>点击 scripts</p>
<p><img src="/2018/09/04/ex50/ex50-9.png" alt=""></p>
</li>
<li><p>鼠标右击这个脚本</p>
<p><img src="/2018/09/04/ex50/ex50-10.png" alt=""></p>
</li>
<li><p>另存为，然后选择保存的目录</p>
<p><img src="/2018/09/04/ex50/ex50-11.png" alt=""></p>
</li>
<li><p>这里本人保存到电脑桌面上了</p>
<p><img src="/2018/09/04/ex50/ex50-12.png" alt=""></p>
</li>
</ol>
<p><strong>注意：</strong></p>
<p>如果你运行脚本的时候，没有得到下面图中的这个结果：</p>
<p><img src="/2018/09/04/ex50/ex50-13.jpeg" alt=""></p>
<p>原因可能在与：</p>
<p><img src="/2018/09/04/ex50/ex50-14.png" alt=""></p>
<p>这个脚本需要调用 ase 这个程序中的模块，那么什么是 ase 呢？ase 怎么安装呢？</p>
<p>对于 ase，本书的 ex0 中就已经提到了，可能大家也忘记了。ASE 是 Atomic Simulation Environment 的缩写，这是一个非常强大的工具。官方网址：</p>
<p><a target="_blank" rel="noopener" href="https://wiki.fysik.dtu.dk/ase/">https://wiki.fysik.dtu.dk/ase/</a></p>
<p>是大大师兄(本人的师兄)做博后的课题组开发出来。Linux 系统下面，安装 ASE 很简单：</p>
<p><img src="/2018/09/04/ex50/ex50-15.png" alt=""></p>
<p>一个命令就可以搞定了，Soooo eeeeeasy! 至于 Windows 下面嘛，本人不会。不想用 Linux，还想用 ASE 的就只能自己捣鼓捣鼓了。捣鼓好了也不要给我发教程，因为本人不推荐用 Windows 做计算。</p>
<h3 id="4-扩展练习："><a href="#4-扩展练习：" class="headerlink" title="4 扩展练习："></a>4 扩展练习：</h3><ol>
<li>下载本节的例子，以及所有的脚本，按照讲解的操作一遍流程，链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1dEHvHr7">https://pan.baidu.com/s/1dEHvHr7</a> 密码：ponm；</li>
<li>Linux 用户自行安装 ASE，使用 vtotav.py 这个脚本走一遍过程；</li>
<li>熟悉下用 python 画图的基本方式。</li>
</ol>
<h3 id="5-总结："><a href="#5-总结：" class="headerlink" title="5 总结："></a>5 总结：</h3><p>讲解到这里，功函数的可视化也就差不多了。当然了，只要你有了数据，用什么画图都可以， excel, origin, matlab, gplot… 不过貌似作图也没什么用，我们大体上看下，然后找个区间取静电势的数值才是正事。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/09/03/ex49/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/09/03/ex49/" class="post-title-link" itemprop="url">Ex49 功函数（work function）的计算（一）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-03 02:06:48" itemprop="dateCreated datePublished" datetime="2018-09-03T02:06:48-04:00">2018-09-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:55" itemprop="dateModified" datetime="2021-12-27T22:15:55-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/09/03/ex49/" class="post-meta-item leancloud_visitors" data-flag-title="Ex49 功函数（work function）的计算（一）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/09/03/ex49/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/09/03/ex49/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前面我们讲完了表面的计算，后面两节我们主要讨论一下功函数的计算。</p>
<h3 id="1-功函数的定义"><a href="#1-功函数的定义" class="headerlink" title="1 功函数的定义"></a>1 功函数的定义</h3><p>首先，我们先看一下<strong><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Work_function">维基百科</a></strong>的解释：</p>
<p><strong>功函数</strong>(又称功函、逸出功)是指要使一粒电子立即从固体表面中逸出，所必须提供的最小能量(通常以电子伏特为单位)。这里“立即”一词表示最终电子位置从原子尺度上远离表面但从宏观尺度上依然靠近固体。功函数不是材料体相的本征性质，更准确的说法应为材料表面的性质(比如表面暴露晶面情况和受污染程度)功函数是金属的重要属性。功函数的大小通常大概是金属自由原子电离能的二分之一。</p>
<p>The work function W for a given surface is defined by the difference</p>
<p>W = - eϕ - E<sub>F</sub></p>
<p>where −e is the charge of an electron, ϕ is the electrostatic potential in the vacuum nearby the surface, and E<sub>F</sub> is the Fermi level (electrochemical potential of electrons) inside the material. The term −eϕ is the energy of an electron at rest in the vacuum nearby the surface. In words, the work function is thus defined as the thermodynamic work required to remove an electron from the material to a state at rest in the vacuum nearby the surface.</p>
<p><img src="/2018/09/03/ex49/ex49-1.jpeg" alt=""></p>
<p>我们再看下 <a target="_blank" rel="noopener" href="https://goldbook.iupac.org/html/E/E02015.html">IUPAC</a> 官网的解释：</p>
<p>The minimum work needed to extract electrons from the Fermi level of a metal M across a surface carrying no net charge. It is equal to the sum of the potential energy and the kinetic Fermi energy taken with the reverse sign:</p>
<script type="math/tex; mode=display">\phi^{M} = -(V_{e}+\varepsilon_e^ F)</script><p>where $V_{e}$ is the potential energy for electrons in metals and  $\varepsilon_e^ F$ is the kinetic energy of electrons at the Fermi level.</p>
<h3 id="2-VASP-计算功函数的过程"><a href="#2-VASP-计算功函数的过程" class="headerlink" title="2 VASP 计算功函数的过程"></a>2 VASP 计算功函数的过程</h3><p>从前面的定义中可以看出，计算功函数我们只需要得到体系的费米能级和电子所处的静电势能，然后求差即可。</p>
<h4 id="2-1-费米能级的计算："><a href="#2-1-费米能级的计算：" class="headerlink" title="2.1 费米能级的计算："></a>2.1 费米能级的计算：</h4><p>VASP 计算结束之后，通过命令：</p>
<p>grep E-fermi OUTCAR 即可提取出来。</p>
<h4 id="2-2-静电势能的计算："><a href="#2-2-静电势能的计算：" class="headerlink" title="2.2 静电势能的计算："></a>2.2 静电势能的计算：</h4><p>通过在 INCAR 中添加： <code>LVHAR =.TRUE.</code> 这个参数。</p>
<p>加入这个参数，计算结束后，VASP 会输出一个文件： LOCPOT 文件。我们可以通过脚本，或者程序对这个文件后处理来获取静电势能，怎么处理后面会讲的很清楚，大家先不要着急心慌。</p>
<h4 id="2-3-VASP的计算流程："><a href="#2-3-VASP的计算流程：" class="headerlink" title="2.3 VASP的计算流程："></a>2.3 VASP的计算流程：</h4><ol>
<li><p>优化获取稳定的结构</p>
</li>
<li><p>将 CONTCAR 复制成 POSCAR</p>
</li>
<li><p>在 INCAR 中设置单点计算：</p>
<p>方法1：设置 <code>NSW=1 或者 0</code></p>
<p>方法2：设置 <code>IBRION = -1</code></p>
<p>方法3：直接删除 INCAR 中 NSW 这一行，采用默认值</p>
</li>
<li><p>提交任务</p>
<p>注意：</p>
<ol>
<li>如果第一步计算中有保存 WAVECAR，则静态计算的时候可以设置：ISTART = 2 读取一下，以便节省计算时间;</li>
<li>如果没有保存，直接算即可。不要在读不读 WAVECAR 这个问题上瞎操心；</li>
<li>电子步数的默认值是 40，如果你的体系不容易收敛，计算的时候请设置一个较大的 NELM 值，比如 NELM = 500。</li>
</ol>
</li>
</ol>
<h3 id="3-Cu-111-表面的功函数计算"><a href="#3-Cu-111-表面的功函数计算" class="headerlink" title="3 Cu(111) 表面的功函数计算"></a>3 Cu(111) 表面的功函数计算</h3><h4 id="3-1-准备计算文件："><a href="#3-1-准备计算文件：" class="headerlink" title="3.1 准备计算文件："></a>3.1 准备计算文件：</h4><p>新建一个 workfunction 的文件夹，将前面优化计算的： INCAR KPOINTS POTCAR CONTCAR 和提交任务的脚本复制到这个文件夹中。</p>
<h4 id="3-2-修改-INCAR-改为静态（单点）计算"><a href="#3-2-修改-INCAR-改为静态（单点）计算" class="headerlink" title="3.2 修改 INCAR 改为静态（单点）计算"></a>3.2 修改 INCAR 改为静态（单点）计算</h4><h4 id="3-3-修改-INCAR，添加-LVHAR-TRUE-这一行"><a href="#3-3-修改-INCAR，添加-LVHAR-TRUE-这一行" class="headerlink" title="3.3 修改 INCAR，添加 LVHAR = .TRUE. 这一行"></a>3.3 修改 INCAR，添加 LVHAR = .TRUE. 这一行</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">System = Cull</span><br><span class="line">ISMEAR = 1 </span><br><span class="line">SIMGA = 0.1</span><br><span class="line">ALGO = FAST</span><br><span class="line">ENCUT = 450</span><br><span class="line">EDIFF = 1E-5</span><br><span class="line"></span><br><span class="line">IDIPOL =.TRUE.</span><br><span class="line">IDIPOL = 3</span><br><span class="line"></span><br><span class="line">NWRITE = 0</span><br><span class="line">LWAVE = .FALSE.</span><br><span class="line">LCHARG = .FALSE.</span><br><span class="line">IBRION = 2</span><br><span class="line">POTIM = 0</span><br><span class="line">EDIFFG = -0.01</span><br><span class="line">NSW = 1 </span><br><span class="line"></span><br><span class="line">LVHAR = .TRUE.</span><br></pre></td></tr></table></figure>
<h4 id="3-4-将-CONTCAR-重命名为-POSCAR"><a href="#3-4-将-CONTCAR-重命名为-POSCAR" class="headerlink" title="3.4 将 CONTCAR 重命名为 POSCAR"></a>3.4 将 CONTCAR 重命名为 POSCAR</h4><h4 id="3-5-提交任务，等待结束。"><a href="#3-5-提交任务，等待结束。" class="headerlink" title="3.5 提交任务，等待结束。"></a>3.5 提交任务，等待结束。</h4><h3 id="4-后处理方法-1：p4vasp"><a href="#4-后处理方法-1：p4vasp" class="headerlink" title="4 后处理方法-1：p4vasp"></a>4 后处理方法-1：p4vasp</h3><p>p4vasp 一直是本人强烈推荐的VASP计算相关的建模，可视化，查看结构，结果的软件。本节我们讲解一下如何通过 p4vasp 对功函数的计算结果可视化。</p>
<h4 id="4-1-导入数据"><a href="#4-1-导入数据" class="headerlink" title="4.1 导入数据"></a>4.1 导入数据</h4><ol>
<li><p>Linux 系统下面，进入计算的目录直接敲命令： p4v &amp; 即可 (我们稍微等下 Windows 用户的操作，后面可视化过程是一样的)</p>
</li>
<li><p>Windows 下面，首先要将计算生成的 LOCPOT 文件保存到本地电脑上。</p>
<p>注意：有时候这个文件可能会很大，下载的时候比较蛋疼，不想下载的话等待下节的讲解。</p>
</li>
<li><p>打开 p4vasp 并导入 LOCPOT 文件：file —&gt; loadsystem，然后找到 LOCPOT 所在的目录，点解导入，效果如下</p>
<p><img src="/2018/09/03/ex49/ex49-2.png" alt=""></p>
</li>
</ol>
<h4 id="4-2-开始可视化-Linux-Windows-都一样了"><a href="#4-2-开始可视化-Linux-Windows-都一样了" class="headerlink" title="4.2 开始可视化 (Linux, Windows 都一样了)"></a>4.2 开始可视化 (Linux, Windows 都一样了)</h4><p>Electronic –&gt; Local potential</p>
<p><img src="/2018/09/03/ex49/ex49-3.png" alt=""></p>
<p>效果如下：</p>
<p><img src="/2018/09/03/ex49/ex49-4.jpeg" alt=""></p>
<p>WOC，这是什么东东？ 是不是算错啦？</p>
<p>别急，看下面：</p>
<p>点击下图中的 <code>Show</code>，会出现三个方向让你选择，一般都是沿着 z 方向的，按照红色箭头点下即可。</p>
<p><img src="/2018/09/03/ex49/ex49-5.png" alt=""></p>
<p>效果如下：</p>
<p><img src="/2018/09/03/ex49/ex49-6.png" alt=""></p>
<p>Wow, Wonderful!!! 是不是很有成就感？</p>
<p>But， 怎么才能获取静电势能的数值呢？ 图中的纵坐标范围太大了，目测取值的话，误差应该在 0.5 eV 左右，太大了，不行。 那么我们只能导出数据，慢慢分析了。</p>
<h4 id="4-3-导出数据"><a href="#4-3-导出数据" class="headerlink" title="4.3 导出数据"></a>4.3 导出数据</h4><p>还记得前面我们讲的 DOS 的计算吗？我们求 <code>d band center</code>，电子数目积分的时候将数据导出来了。同样，图中组成曲线的点的坐标我们也可以导出来。<br>点击： <code>Graph</code>—&gt;<code>Export</code></p>
<p><img src="/2018/09/03/ex49/ex49-7.png" alt=""></p>
<p>选择保存的目录，并给保存的文件一个名字。然后点击，<code>Export</code>， 图中的 cu.dat 就会保存你指定的目录下了。</p>
<p><img src="/2018/09/03/ex49/ex49-8.png" alt=""></p>
<p><strong>注意：</strong></p>
<ol>
<li>名字后面一定要有尾缀<code>.dat</code>或者 <code>.data</code>， 否则会导出失败；</li>
<li>如果按照我说的步骤做的话，还不会弄，请自行查看前面关于 DOS 的计算，已经讲的很清楚了，不要再问我这个问题了。</li>
</ol>
<h4 id="4-4-分析数据"><a href="#4-4-分析数据" class="headerlink" title="4.4 分析数据"></a>4.4 分析数据</h4><p>有了数据，我们就底气十足，什么都不怕了。用 Notepad ++  打开 cu.dat 文件。</p>
<p><strong>注意</strong>： 这里大师兄说的是用 Notepad++，别问我从哪里下载这个神奇的软件。百度会告诉你的。</p>
<p>打开之后，我们会发现，和 DOS 计算导出来的结果有几分神似。数据共有三部分，每两部分之间由空行分开。</p>
<p><img src="/2018/09/03/ex49/ex49-9.png" alt=""></p>
<p><img src="/2018/09/03/ex49/ex49-10.png" alt=""></p>
<p>这三部分的顺序，如下图，</p>
<p><img src="/2018/09/03/ex49/ex49-11.png" alt=""></p>
<p>我们从图中可以看出，基本上在 10-18 的这个区间范围，三条线的数据差不多是一样的。静电势能的话，可以通过红线( Average 那条线)，也就是第二部分来获取。可以查看下 14-15 $\AA$ 时红色曲线的数值，如下图：</p>
<p><img src="/2018/09/03/ex49/ex49-12.png" alt=""></p>
<h4 id="4-5-获取费米能级"><a href="#4-5-获取费米能级" class="headerlink" title="4.5 获取费米能级"></a>4.5 获取费米能级</h4><p><img src="/2018/09/03/ex49/ex49-13.png" alt=""></p>
<p>套公式，功函数为： 4.84-0.03 = 4.81 eV</p>
<p>对比下维基百科中的数值：</p>
<p><img src="/2018/09/03/ex49/ex49-14.png" alt=""></p>
<p>注意：虽然维基百科给了功函数的一些数值，在发表文章的时候，你不能直接放 wiki 的链接到论文里面，这显得有些不专业。建议大家去参考 CRC handbook 里面的数值，然后引用。别问我 CRC handbook 是啥玩意，前面我也讲过了。 </p>
<h3 id="5-扩展练习："><a href="#5-扩展练习：" class="headerlink" title="5 扩展练习："></a>5 扩展练习：</h3><ol>
<li>重复本节的计算；</li>
<li>重复 VASP 官网 <a target="_blank" rel="noopener" href="https://cms.mpi.univie.ac.at/wiki/index.php/Ni_111_surface_high_precision">Ni(111) 表面</a> 的计算。</li>
</ol>
<h3 id="6-总结："><a href="#6-总结：" class="headerlink" title="6 总结："></a>6 总结：</h3><p>本节我们主要</p>
<ol>
<li><p>介绍了下功函数的定义(从别的地方拷过来的)；</p>
</li>
<li><p>介绍了下 VASP 怎么计算功函数；</p>
</li>
<li><p>怎么用 p4vasp 可视化，导出数据，并获取静电势能；</p>
</li>
<li><p>怎么获取 fermi level；</p>
</li>
<li><p>举例介绍了p(1x1)Cu(111) slab 的功函数计算流程，计算结果下载：</p>
<p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1c2m52UG">https://pan.baidu.com/s/1c2m52UG</a>   密码：kfse</p>
</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/09/02/ex48/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/09/02/ex48/" class="post-title-link" itemprop="url">Ex48 表面能的计算（二）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-02 02:06:48" itemprop="dateCreated datePublished" datetime="2018-09-02T02:06:48-04:00">2018-09-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/09/02/ex48/" class="post-meta-item leancloud_visitors" data-flag-title="Ex48 表面能的计算（二）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/09/02/ex48/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/09/02/ex48/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前面一节，我们讲解了一下 VASP 官网 Hand-On-Session-III 中表面能的计算。 </p>
<h3 id="1-首先我们要指出一点-VASP-官网的错误"><a href="#1-首先我们要指出一点-VASP-官网的错误" class="headerlink" title="1 首先我们要指出一点 VASP 官网的错误"></a>1 首先我们要指出一点 VASP 官网的错误</h3><p><img src="/2018/09/02/ex48/ex48-1.jpeg" alt=""></p>
<p>最后的表面能应该是： 0.86 - 0.015 = 0.845 eV 而不是 0.71 eV。</p>
<h3 id="2-为什么要除以-2？"><a href="#2-为什么要除以-2？" class="headerlink" title="2  为什么要除以 2？"></a>2  为什么要除以 2？</h3><p>很多人困惑为什么我们在计算的时候，上图中要除以 2。这是因为我们的单点计算中包含有 2 个面。前一节解释说是因为把 Bulk 切成了两半，以至于把大家给弄糊涂了。为什么我们的计算中会有两个面呢？首先我们看下 Slab 模型：</p>
<p><img src="/2018/09/02/ex48/ex48-2.jpeg" alt=""></p>
<p>问题： 上图的结构中有几个表面呢？</p>
<p>答案是 2 个，因为我们的 slab 模型在 z 方向上也具有周期性，虽然我们把底部的两层原子固定来模拟体相，但实际上它们还是表面。如下图：</p>
<p><img src="/2018/09/02/ex48/ex48-3.jpeg" alt=""></p>
<p>那么，为什么 E<sup>rel</sup> 没有除以 2 呢？</p>
<p>这是因为我们只优化了一个表面啊。</p>
<p>如果我们两个表面都要优化的时候，是不是 E<sup>rel</sup> 也除以 2 了呢？</p>
<p>答：是的。</p>
<p>如果你喜欢上下两个面都优化的话，那么这将引申出 slab 模型的两种情况，对称性和非对称性模型。前面我们讲的都是非对称的 slab 模型。那么什么是对称的 slab 模型呢？ 如下图：</p>
<p><img src="/2018/09/02/ex48/ex48-4.png" alt=""></p>
<p>在这个模型中，中间的三层原子被固定用来模拟体相，上下三层的原子放开用来模拟表面。此时，如果你计算表面能的时候，E<sup>rel</sup> 的数值就要除以 2 了。计算公式可以简化为：</p>
<script type="math/tex; mode=display">\begin{align*}
\sigma &=\frac{1}{2A}(E_{surf}-N_{atoms}\times E_{bulk}+E^{rel})\\
&=\frac{1}{2A}(E_{surf}^{rel} -N_{atoms}\times E_{bulk})\\
\end{align*}</script><p>其中： $E_{surf}^{rel}$ 直接就是我们优化完毕之后的对称slab模型的能量。</p>
<p>单个表面的面积 A， slab 模型中的原子数 $N<em>{atoms}$ 和 $E</em>{bulk}$ 这些能量的获取和前面一节讲的内容一致。</p>
<p>注意： 将这个公式和参考书 96 页底部的公式对比一下。然后仔细阅读参考书 97 页的公式各项的说明。</p>
<h3 id="3-对称和非对称slab模型的区别："><a href="#3-对称和非对称slab模型的区别：" class="headerlink" title="3 对称和非对称slab模型的区别："></a>3 对称和非对称slab模型的区别：</h3><ol>
<li>对称 slab 明显具有更多的原子数，在 z 方向更长，需要更多的真空层(上下两层)，这就不可避免地出现了计算量大的缺点，尤其是对于机时捉襟见肘的筒子们来说，这个模型就不用考虑啦；</li>
<li>非对称模型由于其非对称性，在计算过程中会产生偶极矩，注意这个偶极矩是由于模型引入的，并非我们常说的分子中的偶极矩。尤其是当我们要计算一些表面吸附或者反应的时候，两个 slab 之间偶极矩的相互作用会对我们的结果产生影响。但这不是什么大问题，很多计算软件都可以通过控制计算参数来消除或者将这一影响减至最小。</li>
<li>VASP 中可以通过设置：<ol>
<li><code>LDIPOL=.TRUE.</code>(打开偶极校正)</li>
<li><code>IDIPOL = 1-4</code>来解决。 1，2，3分表代表在x，y和z 方向上进行校正。4代表在所有方向上。</li>
</ol>
</li>
</ol>
<p>注意：1 和 2 必须同时加在 INCAR 里面。详见VASP官网的解释： <a target="_blank" rel="noopener" href="https://cms.mpi.univie.ac.at/wiki/index.php/LDIPOL">LDIPOL</a> 和 <a target="_blank" rel="noopener" href="https://cms.mpi.univie.ac.at/wiki/index.php/IDIPOL">IDIPOL</a></p>
<h3 id="4-表面能计算的参数影响："><a href="#4-表面能计算的参数影响：" class="headerlink" title="4 表面能计算的参数影响："></a>4 表面能计算的参数影响：</h3><p>从公式中可以看出 Slab 的能量和 Bulk 的能量是主要因素： </p>
<ol>
<li><p>Slab 能量：</p>
<ul>
<li>Slab的层数：如参考书中的结果。</li>
</ul>
<p><img src="/2018/09/02/ex48/ex48-5.jpeg" alt=""></p>
<ul>
<li>slab 表面的大小，一般来说 p(1x1) 的即可。当然啦，你可也比较下 p(1x1) 和 p(2x2) 的区别： 这里要注意的是： 改变表面的大小，KPOINTS 也要发生相应的变化，只有这样，两个计算的结果才具有可比性。 </li>
<li>真空层的厚度 这些大家都可以测试一下。</li>
</ul>
</li>
<li><p>Bulk 的能量前面一节我们已经讲过 Bulk 的能量计算了。前面有同学问到： Bulk 计算的时候，模型中应该包含多少个原子？<br>  个人认为：单胞或者原胞的计算均可，当然你也可以扩一下晶胞。但需要注意的是如果你要比较这些不同大小模型中单个原子的能量时，一定要注意 K 点的选择。如果 K 点密度不一致，导致单个原子的能量之间存在细小的差别，这会令你不知所措。有兴趣的可以测试一下。 </p>
</li>
<li><p>此外，大师兄还要推荐一本进阶版的参考书：Theoretical Surface Science: A Microscopic Perspective，作者是 Axel Groβ。课题组主页：<a target="_blank" rel="noopener" href="https://www.uni-ulm.de/en/nawi/institute-of-theoretical-chemistry/">https://www.uni-ulm.de/en/nawi/institute-of-theoretical-chemistry/</a></p>
</li>
</ol>
<p><img src="/2018/09/02/ex48/ex48-6.jpeg" alt=""></p>
<p>​    <img src="/2018/09/02/ex48/ex48-7.jpeg" alt=""></p>
<p><img src="/2018/09/02/ex48/ex48-8.jpeg" alt=""></p>
<p>本书关于表面能的介绍在第68页，具体内容大家认真阅读，必定受益匪浅。</p>
<h3 id="5-扩展练习："><a href="#5-扩展练习：" class="headerlink" title="5 扩展练习："></a>5 扩展练习：</h3><ol>
<li>请务必认真阅读参考书中表面能， slab 模型的相关介绍；</li>
<li>认真测试，重复 Cu(111), Cu(110) 和 Cu(100) 面的计算；</li>
<li>仔细阅读 Theoretical Surface Science: A Microscopic Perspective 这本书中关于表面能的内容；</li>
<li>结合计算结果和参考书中的解释，自己参悟一下。</li>
</ol>
<h3 id="6-总结："><a href="#6-总结：" class="headerlink" title="6 总结："></a>6 总结：</h3><p>本节主要回复了一下大家提问的比较多的问题，简单介绍了一下对称和非对称 slab 模型以及一些影响表面能计算的因素。学习 VASP 没有捷径，大家多练习，多出错，多总结分析，时间长了就会慢慢理解了。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/09/01/ex47/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/09/01/ex47/" class="post-title-link" itemprop="url">Ex47 表面能的计算（一）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-01 02:06:48" itemprop="dateCreated datePublished" datetime="2018-09-01T02:06:48-04:00">2018-09-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/09/01/ex47/" class="post-meta-item leancloud_visitors" data-flag-title="Ex47 表面能的计算（一）" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/09/01/ex47/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/09/01/ex47/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>继续前面的计算，这一节我们主要讲一下表面能的计算过程。</p>
<h3 id="1-表面能定义"><a href="#1-表面能定义" class="headerlink" title="1 表面能定义"></a>1 表面能定义</h3><p>首先，我们先介绍一下表面能的定义。为了偷懒，本人直接摘抄的<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Surface_energy">维基百科</a>的解释，如下：</p>
<p>表面能是创造物质表面时，破坏分子间化学键所需消耗的能量。在固体物理理论中，表面原子比物质内部的原子具有更多的能量，因此，根据能量最低原理，原子会自发的趋于物质内部而不是表面。表面能的另一种定义是，材料表面相对于材料内部所多出的能量。把一个固体材料分解成小块需要破坏它内部的化学键，所以需要消耗能量。如果这个分解的过程是可逆的，那么把材料分解成小块所需要的能量就和小块材料表面所增加的能量相等。但事实上，只有在真空中刚刚形成的表面才符合上述能量守恒。因为新形成的表面是非常不稳定的，它们通过表面原子重组和相互间的反应，或者对周围其他分子或原子的吸附，从而使表面能量降低。</p>
<h3 id="2-VASP计算"><a href="#2-VASP计算" class="headerlink" title="2 VASP计算"></a>2 VASP计算</h3><p>具体到VASP的计算中，表面能是怎么算出来的呢？ 下面我们看一下VASP官网的表面能的计算过程。</p>
<p><img src="/2018/09/01/ex47/ex47-2.jpeg" alt=""></p>
<p>公式先大体浏览一遍，我们分析下里面的各项所表示的内容：</p>
<ul>
<li>E<sup>rel</sup>： Relaxation energy， 即弛豫能量。这个前面一节我们已经讲过了，从刚刚切好的表面优化到稳定的表面所释放的热量。图中的第一个点就是刚刚切好表面的能量（E<sup>surf</sup>），最后一个点就是优化完成之后的能量。这个相信大家现在都能理解了。</li>
<li>σ： 在handonsession-III里面，这个用来表示表面能。</li>
<li>E<sup>surf</sup>：刚刚切好的 slab 能量；可以直接算个单点，也可以取优化过程中第一个离子步的能量。</li>
<li>N<sub>atoms</sub>： Slab 中的原子数目</li>
<li>E<sub>bulk</sub>： Bulk结构中单个原子的能量。</li>
</ul>
<p><strong>注意1：</strong></p>
<p>前面说的最后一点。E<sub>bulk</sub>， 这个不是指的体相的能量，而是体相中单个原子能量。即体相的能量除以原子数目。我们顺便回顾一下前面单胞的优化：</p>
<ol>
<li><p>获取稳定的晶格常数，两个方法：</p>
<ul>
<li>ISIF + Large ENCUT</li>
<li>通过计算不同的晶格常数的晶胞能量，用BM方程拟合</li>
</ul>
</li>
<li>得到稳定的晶格常数之后，如果用的 ISIF= 3 这个方法，则将 CONTCAR 复制成 POSCAR ，然后在 INCAR 中设置： ISIF = 2 + 正常的 ENCUT ，做个单算，算下计算晶胞的能量。</li>
<li>用晶胞的能量除以晶胞中的原子数目，就得到了这里的 E<sub>bulk</sub>。比如前面 Cu 的单胞中有4个原子，我们则用计算后体系的能量除以4。</li>
</ol>
<p><strong>注意2：</strong></p>
<p>Handonsession-III 里面的表面能，严格来说，这个定义其实是不对的。因为表面能，从字面上理解，它的单位应该是： 能量/面积。而图中只有能量，没有面积。所以，图中的表面能指的是纯能量。</p>
<ol>
<li><p>σ<sup>unrel</sup>： 将块体直接切开所用的功，因为是切成了2份，公式中除以2。  </p>
<p>注意，在这个计算里面，暂且不考虑表面的弛豫，单纯从体相切成2个表面的过程。<br>能量是刚刚切出来的slab的能量： -25.560</p>
</li>
<li><p>从体相到切开表面直至达到稳定状态，总的能量变化为：</p>
<script type="math/tex; mode=display">
\sigma = \sigma^{unrel + E^{rel}}</script></li>
</ol>
<p><strong>注意3：</strong></p>
<p>E<sup>rel</sup> 这里没有除以2。为什么呢？ 这是因为我们只放开了上面的两层原子。也就是只优化了一个表面。<br>至此，从体相切成表面，然后直至表面稳定，这一个过程的能量就算完了。<br>既然前面说了，表面能里面有面积，那么面积指的是什么面积？怎么求面积呢？</p>
<ol>
<li>面积就是你计算的slab的那一层表面积，很多人问我这个问题，我也是无语了！</li>
<li>怎么求呢? 我们先看一下Slab模型(Notepad++这个软件打开的！没有的话赶紧去安装一个)</li>
</ol>
<p><img src="/2018/09/01/ex47/ex47-3.png" alt=""></p>
<p>前面几行放大一下，看看晶格尺寸。</p>
<p><img src="/2018/09/01/ex47/ex47-4.png" alt=""></p>
<p>如果面积用A来表示， 则： </p>
<p>A = 2.57170 <em> 2.22716 – 0.000 </em> (-1.28585) </p>
<p><strong>注意4：</strong></p>
<p>这里的单位是 Å<sup>2</sup><br>原理如下图：(自画自拍，不喜勿喷!)</p>
<p><img src="/2018/09/01/ex47/ex47-5.jpeg" alt=""></p>
<p>菱形的面积等于： x1 * y2<br>如果坐标系不是那么正儿八经对在一起的时候，如下图：</p>
<p><img src="/2018/09/01/ex47/ex47-6.jpeg" alt=""></p>
<p>则面积等于：x1 <em> y2 – y1 </em> x2<br>Handonsession-III 中 Ni(100) 表面的面积为：</p>
<p><img src="/2018/09/01/ex47/ex47-7.png" alt=""></p>
<p>A = (0.5<em>0.5– 0.5 </em> (-0.5)) = 0.5 Å<sup>2</sup><br>这里我们还忘了乘以前面的缩放系数：所以，<br>A = 0.5 <em> 3.53 </em> 3.53 = 6.23045 Å<sup>2</sup><br>最终表面能为： 0.71 eV / 6.23045 Å<sup>2</sup> = 0.114 eV/Å<sup>2</sup><br>一般来说表面能的单位为： J/m<sup>2</sup><br>换算系数为： 1 eV/Å<sup>2</sup> = 16.02 J/m<sup>2</sup><br>换算完毕后，表面能为： σ = 0.114 * 16.02 J/m<sup>2</sup> = 1.826 J/m<sup>2</sup> 。</p>
<p><strong>注意5</strong>： 我们的参考书中(第97页中)给弄反了。</p>
<p><img src="/2018/09/01/ex47/ex47-8.jpeg" alt=""></p>
<p>这是因为：<br>1 eV = 1.602176487<em>10<sup>-19</sup> J<br>1 Å<sup>2</sup> = (1</em>10<sup>-10</sup>)<em> (1</em>10<sup>-10</sup>) m<sup>2</sup><br>大家自己算算就知道了。讲到这里，相信金属表面能，大家都可以照着去算一遍了。</p>
<p><strong>注意6：</strong></p>
<p>获取E<sup>surf</sup> 的时候，一定要检查：1） 单点计算是不是收敛了？或者2） 第一个离子步是不是收敛了？</p>
<p>如果没有收敛的话，表面能的计算就是错的。σ<sup>unrel</sup>和E<sup>rel</sup>都跟这个量密切相关。</p>
<h3 id="3-下面我们看一下这篇参考文献中的计算介绍："><a href="#3-下面我们看一下这篇参考文献中的计算介绍：" class="headerlink" title="3 下面我们看一下这篇参考文献中的计算介绍："></a>3 下面我们看一下这篇参考文献中的计算介绍：</h3><p>Shapecontrol in concave metal nanoparticles by etching<br>Nanoscale, 2017,9, 13089-13094 </p>
<p><img src="/2018/09/01/ex47/ex47-9.jpeg" alt=""></p>
<p>这是本人博士期间的一个工作，主要讨论了不同盐酸浓度下Pt纳米颗粒的成长，腐蚀过程以及形貌的预测。有兴趣的可以看看，当然啦，本人也希望大家多多引用。对于表面能的计算，大家可以参考支持信息中的公式1，如下图： </p>
<p><img src="/2018/09/01/ex47/ex47-10.jpeg" alt=""></p>
<p>相信到这里，大家可以完全明白这段话的意思，以及计算的整个流程了。</p>
<h3 id="4-扩展练习："><a href="#4-扩展练习：" class="headerlink" title="4 扩展练习："></a>4 扩展练习：</h3><ol>
<li>重复一下 Hand on Session -III 中 Ni(100)  表面能的计算;</li>
<li>计算下我们前面的 Cu(111) 表面能的计算;</li>
<li>计算下 Cu(100), Cu(110) 的表面能。</li>
<li>对比 Cu(111), Cu(110) 和 Cu(100) 的表面能，分析下规律。</li>
<li>思考1：表面能的计算有什么需要注意的， 请公众号留言回答！</li>
<li>思考2：表面能能用来干什么？请公众号留言回答！</li>
</ol>
<h3 id="5-总结："><a href="#5-总结：" class="headerlink" title="5 总结："></a>5 总结：</h3><p>本节，我们主要讲了表面能的计算，参考的资料有：</p>
<ol>
<li>VASP 官网的 Hand on session (如果你自己下载不到，请认真反思自己！)</li>
<li>我们的参考书： Density Functional Theory: A Practical Inroduction</li>
<li>以及本人发表的文章一篇。 </li>
<li>希望大家可以认真学习，不要急躁！！！</li>
</ol>
<p>本书中只要是用到的，提到的资料，本人都已经明确说明出处，获取方式以及下载链接了，请认真浏览，不要再浪费时间找我索要！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/08/30/ex46/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/08/30/ex46/" class="post-title-link" itemprop="url">Ex46 表面弛豫的计算结果分析以及Direct坐标转换脚本</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-08-30 02:06:48" itemprop="dateCreated datePublished" datetime="2018-08-30T02:06:48-04:00">2018-08-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/08/30/ex46/" class="post-meta-item leancloud_visitors" data-flag-title="Ex46 表面弛豫的计算结果分析以及Direct坐标转换脚本" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/08/30/ex46/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/08/30/ex46/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前面一节我们回顾了一下表面弛豫的基本概念，对于大多数的金属体系来说， 表面弛豫一般发生在垂直方向上。将金属沿表面方向切成两份后，由于表面原子的配位数发生了变化， 我们可以想象:该表层原子与下面一层的结合能力会更强，从而降低体系的能量。具体体现在层间距和能量两个方面。我们先回顾一下Ex44中Cu(111)表面的练习。</p>
<h2 id="1-结构优化前后变化"><a href="#1-结构优化前后变化" class="headerlink" title="1 结构优化前后变化"></a>1 结构优化前后变化</h2><p>首先观察一下结构的变化， POSCAR的结构如下：(刚刚切好的，热乎的表面)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Cu\(1\1\1)</span><br><span class="line">   1.00000000000000</span><br><span class="line">     2.5717000960999998    0.0000000000000000    0.0000000000000000</span><br><span class="line">    -1.2858500480999999    2.2271576141999998    0.0000000000000000</span><br><span class="line">     0.0000000000000000    0.0000000000000000   21.2994003296000010</span><br><span class="line">   Cu</span><br><span class="line">   4</span><br><span class="line">Selective</span><br><span class="line">Cartesian</span><br><span class="line">+0.0000000000   +0.0000000000   +0.0000000000   F F F</span><br><span class="line">-0.0000128765   +1.4847792201   +2.0999078998   F F F</span><br><span class="line">+1.2858629618   +0.7423784587   +4.1996028482   T T T</span><br><span class="line">+0.0000000000   +0.0000000000   +6.2995107693   T T T</span><br></pre></td></tr></table></figure>
<p>优化后的结构：冷却后的，转化为Cartesian坐标的CONTCAR) </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Cu\(1\1\1)</span><br><span class="line">   1.00000000000000</span><br><span class="line">     2.5717000960999998    0.0000000000000000    0.0000000000000000</span><br><span class="line">    -1.2858500480999999    2.2271576141999998    0.0000000000000000</span><br><span class="line">     0.0000000000000000    0.0000000000000000   21.2994003296000010</span><br><span class="line">   Cu</span><br><span class="line">     4</span><br><span class="line">Selective dynamics</span><br><span class="line">Cartesian</span><br><span class="line">+0.0000000000   +0.0000000000   +0.0000000000   F F F</span><br><span class="line">-0.0000128765   +1.4847792201   +2.0999078998   F F F</span><br><span class="line">+1.2858542192   +0.7423835062   +4.1890255872   T T T</span><br><span class="line">+0.0000182442   -0.0000105333   +6.2592676588   T T T</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>表层原子的坐标从6.2995 $\AA$减小到6.2593 $\AA$。说明该层原子向体相收缩了。<br>第一、二层的原子间距（单位： $\AA$）为:<br>6.2995-4.1996 = 2.0999 (POSCAR)<br>6.2593-4.1890 = 2.0703 (CONTCAR)，<br>前后变化了(2.0999-2.0703) / 2.0999  * 100% = 1.4 %<br>注意：这里没有区分正负号，一般来说，用负值表示向体相收缩！！！(详见参考书)</p>
<h2 id="2-弛豫能量"><a href="#2-弛豫能量" class="headerlink" title="2 弛豫能量"></a>2 弛豫能量</h2><p>那么怎么知道弛豫前后的能量变化呢? 这个问题很容易回答: </p>
<ul>
<li>第一步：我们对刚刚切好的表面算个单点计算；获得一个能量。</li>
<li>第二步：用优化完的能量减去前面单点能结果即可。</li>
</ul>
<p>实际计算过程中，第一步可以免去，因为在优化的时候，VASP会对初始结构计算一下，对应的为第一个离子步的能量。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbro:~/test/cu/cu111/opt1$ grep &#x27;  without&#x27; OUTCAR  | awk &#x27;&#123;print $7&#125;&#x27;</span><br><span class="line">-13.96892338</span><br><span class="line">-13.96932426</span><br><span class="line">-13.96974724</span><br><span class="line">-13.97030280</span><br><span class="line">-13.97016827</span><br><span class="line">-13.97041579</span><br><span class="line">-13.97047584</span><br><span class="line">-13.97063103</span><br><span class="line">-13.97082922</span><br><span class="line">-13.97086603</span><br></pre></td></tr></table></figure>
<p>所以，弛豫前后的能量（eV）变化为:<br>-13.97086603 - (-13.96892338)  = -0.00194265  </p>
<p>能量为负值，说明弛豫这个过程是放热的，也就是说刚刚切开的表面不稳定，表层原子向体相收缩后，体系能量降低，变得更稳定。<br><strong>注意：</strong>这么做的时候，一定要先检查第一个离子步中的电子步是否收敛。比如：VASP默认的单个离子步中的电子步数为60步（<code>NELM  =  60</code>），<a target="_blank" rel="noopener" href="https://cms.mpi.univie.ac.at/wiki/index.php/NELM">https://cms.mpi.univie.ac.at/wiki/index.php/NELM</a><br>如果你设置的的NELM为默认值，且第一个离子步中，到了60步还没有收敛，则该这一步的能量是不可以用的。<br>此时，你需要做的就是：</p>
<ul>
<li>尝试增大 <code>NELM = 100</code> 或者其他更大的数值， 对未优化的结构重新做个单点计算。</li>
<li>收敛很困难的话，可以调节下<code>ALGO</code>这个参数。</li>
</ul>
<h2 id="3-dire2cart-py"><a href="#3-dire2cart-py" class="headerlink" title="3 dire2cart.py"></a>3 dire2cart.py</h2><p>本节讲的太少，留个转化Direct为Cartesian的脚本(<code>dire2cart.py</code>）作为补充。下载链接： </p>
<p><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ScsLWhLAPpSul0SzYNPvpg。">https://pan.baidu.com/s/1ScsLWhLAPpSul0SzYNPvpg。</a></p>
<p>上面CONTCAR的转化就是用的这个脚本。使用如下图: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbro:~/test/cu/cu111/opt1$ ls</span><br><span class="line">CONTCAR  INCAR  KPOINTS  OSZICAR  OUTCAR  POSCAR  POTCAR  sub4  vasprun.xml</span><br><span class="line">qli@bigbro:~/test/cu/cu111/opt1$ dire2cart.py POSCAR</span><br><span class="line">###################################</span><br><span class="line"></span><br><span class="line"># #</span><br><span class="line"></span><br><span class="line">#for VASP 5.2 or higher versions  #</span><br><span class="line"></span><br><span class="line"># #</span><br><span class="line"></span><br><span class="line">###################################</span><br><span class="line"></span><br><span class="line">## This POSCAR has Direct Coordinations， Conversion is starting....</span><br><span class="line"></span><br><span class="line">## POSCAR with Cartesian Coordiations is named as POSCAR_C</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong></p>
<ul>
<li>如果你的<code>POSCAR</code>或者<code>CONTCAR</code>已经是<code>Cartesian</code>坐标了，这个脚本可以自动识别并终止转换。</li>
<li>转化后的文件为：<code>AAA_C</code>, <code>AAA</code>是你要转化的文件（POSCAR或者CONTCAR）。</li>
</ul>
<h2 id="4-扩展练习"><a href="#4-扩展练习" class="headerlink" title="4 扩展练习"></a>4 扩展练习</h2><ul>
<li><p>下载VASP官网的关于表面相关计算的pdf文档：<a target="_blank" rel="noopener" href="http://www.nersc.gov/assets/Uploads/VASP-tutorial-SurfaceScience.pdf"><code>VASP Tutorial: A bit of surface science</code></a></p>
</li>
<li><p>根据自己所学，尝试着练习里面的相关内容。</p>
</li>
<li><p>其他相关的材料：<a target="_blank" rel="noopener" href="http://www.nersc.gov/users/training/events/3-day-vasp-workshop/">http://www.nersc.gov/users/training/events/3-day-vasp-workshop/</a></p>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/08/28/ex45/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/08/28/ex45/" class="post-title-link" itemprop="url">Ex45 表面弛豫</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-08-28 02:06:48" itemprop="dateCreated datePublished" datetime="2018-08-28T02:06:48-04:00">2018-08-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/08/28/ex45/" class="post-meta-item leancloud_visitors" data-flag-title="Ex45 表面弛豫" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/08/28/ex45/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/08/28/ex45/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="答辩心得"><a href="#答辩心得" class="headerlink" title="答辩心得"></a>答辩心得</h2><p>顺利完成博士答辩，现在我们开始继续前面的章节。<br>首先，想跟大家分享下自己答辩的体会：基础知识太不扎实，前瞻性又太不够。导致回答问题的环节，被大牛们问的就想找个缝钻进去了。这对于我的启示就是，以后写这本书的时候，每个练习尽量分成4个部分:<br>1)  第一部分讲基础知识，<br>2)  第二部分讲计算过程的细节部分，<br>3) 第三部分讨论计算结果和基础知识;<br>4) 相关发表的文章中的计算。<br>这对大家的要求就是:<br>1)  有什么任何有疑问的地方，自己要记下来，主动查阅资料，然后反馈给我;<br>2)  有什么欠妥的地方，恳请批评指正;<br>3)  如果你有相关发表的文章，可以放在前面提到的第四部分供大家研究，欢迎分享;<br>4)  这本书的作者不是我自己一个人，更是我们大家的心血，希望我们一起努力;<br>5)  本人只接受邮件咨询或者批评: lqcata@gmail.com 因为群里讨论的很多宝贵的经验总是没法及时完整的保留下来，以至于造成了很多损失。</p>
<h2 id="表面弛豫"><a href="#表面弛豫" class="headerlink" title="表面弛豫"></a>表面弛豫</h2><p>我们先想想一下，有一块金属，我们从中间切开后，新生成的两个表面上的原子和体相中的有什么区别?<br>首先，表面上的原子配位数比体相中的少了，即表层原子具有悬键。因为切开的过程就等同于把两个表面的原子键切开了。其次，配位数的减少使得表面层与内部的相互作用会更强，与体相中有所不同。这就体现在层间距(键长)上面。</p>
<p><strong>1 维基百科的解释</strong></p>
<p>理想情况下的晶体向各方向无限延伸，其中任一原子的平衡位置由晶体中其他所有原子对其作用力的总和决定。因此，每个原子所在的位置在理想晶体中是等价的，生成的晶体结构是周期性的。现实情况下的晶体大小有限，这就导致了靠近晶体表层的原子受到的作用力不同于晶体内部的原子，从而造成晶体表面原子排列方式不同于晶体内部的结果。晶体表层原子的这种行为可被分为弛豫(relaxation)和重构(reconstruction)两种情况。<br>弛豫指表面的原子层整体相对于内部的本体(bulk)的位置变化。较为常见的情况是垂直方向上的上下位移，即法向弛豫(normalrelaxation)。大部分金属表面上的弛豫都是这种类型。某些材料的表面也可能在发生法向弛豫的同时有切向的弛豫。</p>
<p><strong>2 Surface Science: An Introduction 这本书的解释</strong><br><img src="/2018/08/28/ex45/ex45-1.jpeg" alt=""><br><img src="/2018/08/28/ex45/ex45-2.jpeg" alt=""><br><img src="/2018/08/28/ex45/ex45-3.jpeg" alt=""><br><img src="/2018/08/28/ex45/ex45-4.jpeg" alt=""></p>
<p><strong>3  参考书的解释:</strong><br>Density Functional Theory: A Practical Introduction， 第94页，第四章，第4.5节 SURFACE RELAXATION 这一部分(请务必认真看完这一部分)<br><img src="/2018/08/28/ex45/ex45-5.jpeg" alt=""><br><img src="/2018/08/28/ex45/ex45-6.jpeg" alt=""><br><img src="/2018/08/28/ex45/ex45-7.jpeg" alt=""></p>
<h2 id="4-扩展练习"><a href="#4-扩展练习" class="headerlink" title="4 扩展练习:"></a>4 扩展练习:</h2><p>1)  了解表面弛豫的相关内容;<br>2)  查找相关书籍;<br>3)  认真阅读参考书4.5节的内容，并重复4.5 节的练习<br>4)下载本节的两本参考书：QQ群共享或者百度网盘链接：<a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1eSB2Nx4">http://pan.baidu.com/s/1eSB2Nx4</a></p>
<h2 id="5-总结"><a href="#5-总结" class="headerlink" title="5 总结"></a>5 总结</h2><p>表面弛豫相信大家都很了解了，借此机会供大家复习一下。关于表面化学的经典书籍，如果你有特别喜欢的，也请推荐给大家。 </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/08/27/ex44/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/08/27/ex44/" class="post-title-link" itemprop="url">Ex44 p(1x1)Cu(111) 的优化计算</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-08-27 02:06:48" itemprop="dateCreated datePublished" datetime="2018-08-27T02:06:48-04:00">2018-08-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/08/27/ex44/" class="post-meta-item leancloud_visitors" data-flag-title="Ex44 p(1x1)Cu(111) 的优化计算" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/08/27/ex44/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/08/27/ex44/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前面我们学习了Slab模型的单点计算，在此基础上，本节我们主要学习下怎么优化Slab模型。</p>
<h2 id="1-修改Slab模型"><a href="#1-修改Slab模型" class="headerlink" title="1 修改Slab模型"></a>1 修改Slab模型</h2><p>前面单点计算的<code>POSCAR</code>不可以直接拿过来用吗？为什么要修改<code>POSCAR</code>文件？</p>
<p>这是因为在Slab模型中，要固定一部分原子来模拟体相，然后放开一部分原子来模拟表面。一般来说，表面的两层原子允许弛豫，而下面的那些原子则直接固定住。</p>
<p>这样做的物理意义在于：在真实的环境下，催化剂体相看做是不变的，只有表面的原子参与催化反应。</p>
<p>VASP中固定原子需要在POSCAR中进行操作。有两个关键点：</p>
<p>1）在POSCAR的第7行后添加一行，改行内容为<code>Selective Dynamics</code>，VASP只认第一个字母，你可以直接在这一行只加 S或者s。也可以换成其他的S开头的单词，比如<code>SB</code>，<code>Sexy BigBro</code> ， <code>Super BigBro</code>等等；<br>2）在原子坐标后面加上 F 或者 T 表示固定或者放开，因为坐标有xyz三个数值，因此我们需要三个F或者T。我们可以通过设置允许原子在某一方向上移动，而其他方向上固定。</p>
<ul>
<li><code>F F F</code>表示xyz全部固定； </li>
<li><code>T T T</code> 表示xyz全部放开，</li>
<li><code>F F T</code> 表示 xy方向固定，只允许原子在z方向上移动。</li>
</ul>
<p>这一点我们前面也已经讲过了，详见Ex24 频率计算的输出与POSCAR原子的固定。</p>
<p><strong>注意：</strong></p>
<ul>
<li>如果前面的<code>POSCAR</code>直接拿过来直接用，那么在优化过程中所有的原子都会被放开。回想一下我们计算Fe, Cu单胞的例子，计算中我们没有设置F或者T，晶胞尺寸和原子的坐标在优化过程前后都发生了变化。因此你不设置<code>Selective</code> 以及 F或者T，VASP默认是所有的原子都放开的。</li>
<li><code>Selective</code> 和 F 或者 T同时出现，不要只设置<code>Selective</code>忘了FT，也不要只设置FT忘了Selective.</li>
</ul>
<h2 id="2-如何修改？"><a href="#2-如何修改？" class="headerlink" title="2 如何修改？"></a>2 如何修改？</h2><p>根据前面说，我们需要做的无非有两步，<br>1）  在第7行后加入<code>Selective Dynamics</code><br>2）  在坐标后面加入<code>T T T</code>或者 <code>F F F</code><br>我们在本节中，将底部的两层原子固定，上面两层放开。</p>
<p>实现本目的，有以下几种方式： </p>
<p>2.1）这个用文本编辑器就可以做到，很多编辑器都有列块模式，允许你同时添加N列到每行的最后。你可以使用下<code>Notepad++</code>，<code>Atom</code>这些免费开源的软件来操作</p>
<p>2.2）使用<code>p4vasp</code>，详见前面的练习Ex24</p>
<p>2.3） 本节我们重温一下<code>sed</code>的用法，直接使用命令进行操作。</p>
<p>A) 在第 7行 后添加一行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed  -i  &#x27;7aSelective Dynamics&#x27;  POSCAR</span><br></pre></td></tr></table></figure>
<p>7a 代表在第7行后面添加一行，a 是append的缩写。注意，a 和 Selective之间可以没有空格，也可以有空格，这里我们没有加空格。</p>
<p>B） 添加了Selective这一行之后，原子坐标的行数也发生了变化，为10-13行。</p>
<p>C） 第10，11行为底部的两层原子坐标，我们在最后面加上<code>F F F</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed  -i  &#x27;10,11s/$/ F F F/g&#x27; POSCAR</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong> 第一个F前面有个空格。</p>
<p>d） 在12-13行最后面加上 <code>T T T</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed  -i  &#x27;12,13s/$/ T T T/g&#x27; POSCAR</span><br></pre></td></tr></table></figure>
<p>这样，我们就顺利完成POSCAR的改造了，可以用来进行slab的优化计算了。</p>
<h2 id="3-KPOINTS-和-POTCAR"><a href="#3-KPOINTS-和-POTCAR" class="headerlink" title="3 KPOINTS 和 POTCAR"></a>3 KPOINTS 和 POTCAR</h2><p>保持原来的样子不变</p>
<h2 id="4-INCAR"><a href="#4-INCAR" class="headerlink" title="4 INCAR"></a>4 INCAR</h2><p>优化的时候，我门回想一下要设置的东西：<br>4.1<code>IBRION</code> 和 <code>POTIM</code><br>IBRION可以使用 1 和2，我们这里用2。（1的话适合初始结构比较好的情况，这里我们也可以用。）<br><code>POTIM =0.1</code>  官网默认值是0.5，个人感觉比较大， 0.1是一个很不错的选择。<br>4.2 <code>EDIFFG = -0.01</code>优化时以力作为收敛标准。注意 -0.01 已经很严格了，除非特殊需要，不要设置-0.001，这样你就会在QQ群里求助大家，为什么我优化的时候一直不收敛啊。如果设置-0.01，很多步过后仍然不收敛，可以尝试一下-0.02，也是一个很安全的选择。<br>4.3 <code>NSW = 500</code>  设置最大的优化步数。<br>4.4 <code>ISIF = 2</code>   slab 模型优化的时候，我们用<code>ISIF =2</code> ，也就是VASP的默认值，不用设置， 最终<code>INCAR</code>如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">System = Cu111</span><br><span class="line"></span><br><span class="line">ISMEAR = 1</span><br><span class="line">SIGMA = 0.1</span><br><span class="line">ALGO = FAST</span><br><span class="line">ENCUT = 450</span><br><span class="line">EDIFF = 1E-5</span><br><span class="line"></span><br><span class="line">LDIPOL = .TRUE.</span><br><span class="line">IDIPOL = 3</span><br><span class="line"></span><br><span class="line">NWRITE = 0</span><br><span class="line">LWAVE = .FALSE.</span><br><span class="line">LCHARG = .FALSE.</span><br><span class="line"></span><br><span class="line">IBRION = 2</span><br><span class="line">POTIM = 0.1</span><br><span class="line">EDIFFG = -0.01</span><br><span class="line">NSW = 500</span><br></pre></td></tr></table></figure>
<p>注意：<br>上一节我们提到Cu没有磁性，表述是不准确的，应该是纯净的Cu(111) slab模型中，Cu不需要考虑自旋。如果你算的是CuO(111)表面，则需要考虑自旋了。</p>
<h2 id="5-提交任务"><a href="#5-提交任务" class="headerlink" title="5 提交任务"></a>5 提交任务</h2><p>计算结束后，查看OUTCAR，OSZICAR的最后几行检查下是不是正常结束。</p>
<h2 id="6-扩展练习"><a href="#6-扩展练习" class="headerlink" title="6 扩展练习"></a>6 扩展练习</h2><p>6.1 掌握本节提到的固定原子的三种做法：文本编辑器，p4vasp,  sed， 当然啦，更可以直接使用Vim 这个强大的工具来执行<br>6.2 查看结构优化相关的这几个参数，复习下它们的VASP官网说明。<br>6.3 运行本文的例子，然后将EDIFFG设置成 -0.02或者-0.001进行测试，查看与-0.01的区别。<br>6.4 VASP官网查找表面能计算的案例，结合本节以及前面的学习，尝试算一下Cu(111)面的表面能。</p>
<h2 id="7-总结"><a href="#7-总结" class="headerlink" title="7 总结"></a>7 总结</h2><p>截止到本节为止，Slab模型的优化，你已经可以初步掌握了。请务必跟着节奏认真练习。后面我们会继续学习Slab模型的优化，现在感觉陌生没上手的也不用担心。认真总结一下，我们如何从Bulk模型，然后一步一步操作到Slab模型优化的。每一步中都有哪些该注意的细节。这些都掌握了，就可以大大提高你计算的成功率，进而节省时间和精力。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/08/26/ex43/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/08/26/ex43/" class="post-title-link" itemprop="url">Ex43 p(1x1) Cu(111)的单点计算</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-08-26 02:06:48" itemprop="dateCreated datePublished" datetime="2018-08-26T02:06:48-04:00">2018-08-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/08/26/ex43/" class="post-meta-item leancloud_visitors" data-flag-title="Ex43 p(1x1) Cu(111)的单点计算" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/08/26/ex43/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/08/26/ex43/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>上一节的内容主要简单介绍了一下Slab模型，具体的大家去看推荐的参考书！计算部分我们做了以下几个方面的操作：</p>
<ul>
<li>Cu的Bulk计算，获取了稳定体相结构，晶胞参数；</li>
<li>将结果导入Material Studio， 并切(111)面</li>
<li>将切出来的Cu(111) 面转换成POSCAR格式。</li>
</ul>
<p>因此，VASP的四个输入文件，我们已经有了POSCAR和POTCAR，下面我们复习下POSCAR，INCAR和KPOINTS的准备工作， 然后进行单点计算。</p>
<h2 id="1-搭建slab模型"><a href="#1-搭建slab模型" class="headerlink" title="1  搭建slab模型"></a>1  搭建slab模型</h2><p>Cu(111) slab 模型（POSCAR）的制作流程（复习一下）。<strong>注意：</strong>前面我们用的是Conventional cell，下面用的是Primitive Cell。 一般来说用<code>Conventional cell</code>， FCC的金属可以用<code>Primitive Cell</code> 但对于其他体系，通过<code>Primitive Cell</code>切出来表面模型有问题。</p>
<p>A）Bulk计算结束后，将CONTCAR用VESTA转换为cif文件，然后MS导入。<br>B）Build→Symmetry→primitive cell<br>C）Build→surfaces→cleave surface<br><img src="/2018/08/26/ex43/ex43-1.jpeg" alt=""><br>D）Build→Crystals→Build Vaccum Slab 真空层选择15Å<br><img src="/2018/08/26/ex43/ex43-2.jpeg" alt=""><br>E）导出为cif，通过VESTA转化为POSCAR格式，如下：<br><img src="/2018/08/26/ex43/ex43-3.jpeg" alt=""></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Cu\(1\1\1)</span><br><span class="line">1.0</span><br><span class="line">        2.5717000961         0.0000000000         0.0000000000</span><br><span class="line">       -1.2858500481         2.2271576142         0.0000000000</span><br><span class="line">        0.0000000000         0.0000000000        21.2994003296</span><br><span class="line">   Cu</span><br><span class="line">    4</span><br><span class="line">Direct</span><br><span class="line">     0.000000000         0.000000000         0.000000000</span><br><span class="line">     0.333330005         0.666670024         0.098590001</span><br><span class="line">     0.000000000         0.000000000         0.295760006</span><br><span class="line">     0.666670024         0.333330005         0.197170004</span><br></pre></td></tr></table></figure>
<p>前面的操作，我们生成 <code>p(1x1)</code> 的Cu(111)面，p是<code>Primitive</code>的简称，如果你不了解p(1x1)， 去学习一下<code>Wood  Notation</code>。当然，在此基础上，你也可以将p(1x1) 在晶胞a 和b方向上扩展，生成<code>p(2x2)</code>，<code>p(3x3)</code>， <code>p(2x1)</code>等不同大小的Cu(111)表面。本节，我们就用p(1x1)做为例子。</p>
<h2 id="2-KPOINTS"><a href="#2-KPOINTS" class="headerlink" title="2  KPOINTS"></a>2  KPOINTS</h2><p><code>POSCAR</code>中，slab在平面方向上a 和 b 的大小为2.5717 Å，根据前面的经验规则，我们可以在两个方向上K点取值为：$13\times13$，z 方向上取值为1，最终KPOINTS如下图，脚本使用命令为：<code>kpoints.sh 13 13 1</code> （不知道脚本的请往前翻）</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">qli@bigbro:~/test/cu$  kpoints.sh <span class="number">13</span> <span class="number">13</span> <span class="number">1</span> </span><br><span class="line">qli@bigbro:~/test/cu$  cat KPOINTS</span><br><span class="line">K-POINTS</span><br><span class="line"> <span class="number">0</span></span><br><span class="line"><span class="built_in">Gamma</span></span><br><span class="line">  <span class="number">13</span> <span class="number">13</span> <span class="number">1</span></span><br><span class="line">  <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>为什么在z方向上只用1个K点？查找参考书（DFT：A Practical Introduction， Page 88）的说明：<br>If the vacuum region is large enough， the electron density tails off to zero a short distance from the edge of the slab. It turns out that this means that accurate results are possible using just one k point in the b3 direction.</p>
<h2 id="3-INCAR"><a href="#3-INCAR" class="headerlink" title="3  INCAR"></a>3  INCAR</h2><p>在贴出来INCAR之前，大家首先回顾一下单点计算需要注意的几个方面：<br>1）<code>System = Cu(111)</code> 可有可无<br>2）Cu 是金属，可以使用<code>ISMEAR = 1;SIGMA = 0.1</code><br>3）<code>ALGO = FAST</code> 或者使用默认值<br>4）纯净的Cu(111)体系中，Cu没有磁性，ISPIN 不用设置<br>注意：CuO中Cu具有磁性，如果你算的是Cu的氧化物，就需要考虑ISPIN了<br>5）单点计算：<code>NSW = 0</code> 也可以不设置，因为默认值就是0<br>6）截断能： <code>ENCUT = 450</code> 很多人喜欢测试这个参数，450直接用是一个很好的选择<br>7）<code>EDIFF = 1E-5</code> 电子步的收敛标准<br>8）偶极矫正：<code>LDIPOL = .TRUE. ; IDIPOL = 3</code> Slab模型一般都需要加上这个参数<br>9）控制OUTCAR和其他文件的输出：<code>NWRITE = 0 ; LWAVE  = .FALSE.;LCHARG = .FALSE.</code><br>10）也可以加上<code>NCORE</code>这个参数来加快计算步骤。一般来说，不同的机子大家需要自己测试下NCORE参数对计算的影响，个人经验：如果你的机器一个节点有12个核，设置<code>NCORE = 6</code>； 一个节点有24核，设置<code>NCORE = 12</code>。也就是节点中核数的一半。由于这个计算很快，本操作就不考虑了。最终INCAR 如下:</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">System = Cu111</span><br><span class="line"></span><br><span class="line">ISMEAR = <span class="number">1</span></span><br><span class="line">SIGMA = <span class="number">0.1</span></span><br><span class="line">ALGO = FAST</span><br><span class="line">ENCUT = <span class="number">450</span></span><br><span class="line">EDIFF = <span class="number">1E-5</span></span><br><span class="line"></span><br><span class="line">LDIPOL = .TRUE.</span><br><span class="line">IDIPOL = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">NWRITE = <span class="number">0</span></span><br><span class="line">LWAVE = .FALSE.</span><br><span class="line">LCHARG = .FALSE.</span><br></pre></td></tr></table></figure>
<h2 id="4-准备任务脚本，提交任务"><a href="#4-准备任务脚本，提交任务" class="headerlink" title="4 准备任务脚本，提交任务"></a>4 准备任务脚本，提交任务</h2><p>计算完成后， <code>grep &#39;  without&#39; OUTCAR</code>  （without前面有2个空格）或者<code>grep E0 OSZICAR | tail-n 1</code>，得到单点能为：<code>-13.96918440 eV</code></p>
<h2 id="5-扩展练习"><a href="#5-扩展练习" class="headerlink" title="5   扩展练习"></a>5   扩展练习</h2><p>5.1 计算的例子下载链接：链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1cHY-9g2Iswl5zV9bijBG7Q">https://pan.baidu.com/s/1cHY-9g2Iswl5zV9bijBG7Q</a> 提取码: ctxc<br>5.2 重复本节所有的练习<br>5.3 VASP官网查找本节中不了解的参数，然后学习<br>5.4 思考一下：我们得到的单点能量可以干吗用？</p>
<h2 id="6-总结："><a href="#6-总结：" class="headerlink" title="6 总结："></a>6 总结：</h2><p>刚刚步入slab的计算，我们速度稍微慢一些，本节只讲单点计算，希望大家能够跟上步骤，亲自进行操作练习，如果出错了，请认真改正，直至得到和上传的结果一样为止。再次强调，大家平时一定要多浏览VASP官网，请把VASP手册下载放到桌面上，没事的时候就翻一翻。不要去网上找一些乱七八糟的教程，拿过来就直接照着练，官网才是最正宗的。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/08/25/ex42/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/08/25/ex42/" class="post-title-link" itemprop="url">Ex42 slab模型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-08-25 02:06:48" itemprop="dateCreated datePublished" datetime="2018-08-25T02:06:48-04:00">2018-08-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/08/25/ex42/" class="post-meta-item leancloud_visitors" data-flag-title="Ex42 slab模型" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/08/25/ex42/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/08/25/ex42/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前面我们学习了Bulk计算的一些基本的计算，拟合以及优化晶格常数，DOS计算。在材料计算方面，还有能带，声子谱的计算等等，但由于本人方向不在这一块（主要是做表面反应机理研究的），就不能详细给大家解释了。如果有同学在这方面很擅长，可以把自己的计算心得写进本书，将不胜感激。说到表面反应的机理研究，我们首先要做的就是搭建模型。先理一下思路：</p>
<p>1）计算Bulk的结构，获取稳定的晶格常数<br>2）在此基础上，搭建Slab模型。</p>
<h2 id="1-什么是Slab-模型？"><a href="#1-什么是Slab-模型？" class="headerlink" title="1 什么是Slab 模型？"></a>1 什么是Slab 模型？</h2><p>这个问题，我们看一下参考书的第四章：Density Functional Theory: A Practical Introduction （注意：本书有中文版的，本人强烈不建议！请静下心来看原版的，也恳请不要在群里求中文的pdf版本！）<br><img src="/2018/08/25/ex42/ex42-2.jpeg" alt=""><br>多相催化中，反应发生在催化剂表面上，也就是气（液）固两相的交界处。为了模拟固体的表面，我们需要一个在二维方向上具有周期性的结构来模拟固体的表面，第三维方向则不具有周期性，用来模拟气相或者液相。但是，更常用的则是在第三维方向上加上周期性，周期性的结构之间用一个什么都没有的空间（free space）来分割，也就是真空层。在这里我们需要注意的是要避免第三维方向上两个周期性结构的相互影响，也就是一个周期的电子密度沿着真空层方向要趋于零，这样才不会对相邻的结构产生影响。此时，我们需要做的就是：</p>
<p>1）增大真空层的厚度，厚度要适中，太小肯定不行，太大也不合适。想一想我们前面讲到的影响计算速度的一个因素，真空层太厚，也就意味着我们的模型尺寸变大，从而导致计算变慢。一般来说，对于表面反应的计算，15$\AA$的真空层厚度足够了。但是，对于功函数这一类对真空层敏感的计算来说，我们需要注意。</p>
<p>2）VASP中还需要加入：<code>LDIPOL = .TRUE.</code>和<code>IDIPOL = 3</code>(3指的是在z方向上)这两个参数来消除上下不对称的slab表面导致的偶极矩影响。<a target="_blank" rel="noopener" href="https://cms.mpi.univie.ac.at/wiki/index.php/LDIPOL">https://cms.mpi.univie.ac.at/wiki/index.php/LDIPOL</a><br><img src="/2018/08/25/ex42/ex42-3.jpeg" alt=""><br>对于表面结构，有以下几个需要注意的:<br>1）xy 方向上表面的大小;<br>A）这个影响表面吸附物种的覆盖度;<br>B）影响体系的尺寸大小和计算时间;<br>C）不同的大小需要选取对应的K点；回想一下我们前面提到的经验规则。</p>
<p>2）不同的晶面，(111)， (100)，(110);<br>A) 这取决于你研究的方向;<br>B) 不同晶面的表面能;<br>C) 不同晶面的表面结构，反应活性等。</p>
<p>3）表面结构的层数<br>A）层数多了，原子变多，体系在 z 方向的尺寸增加，也会影响计算速度；<br>B）计算中需要弛豫的层数；<br>C）不同层数对你要计算的性质会产生影响，比如表面能；<br>D）不同晶面需要的层数也不尽相同，一般开放的表面需要更多的层数；<br>E）根据自己感兴趣的性质，选择合适的层数，也就是需要你去测试一番。</p>
<p>4）Slab模型有两种，一种是上下表面对称的，一种是非对称的。对称性结构往往需要很多层，体系较大。 非对称的结构体系较小，但存在偶极矩的影响，要注意加LDIPOL 和IDIPOL这两个参数来消除，后面我们会介绍到。</p>
<p>注意，为了更加顺利的进行下面的学习，参考书第4章的内容务必认真阅读。这会为你今后的表面研究打下坚实的基础</p>
<h2 id="2-表面模型的搭建："><a href="#2-表面模型的搭建：" class="headerlink" title="2 表面模型的搭建："></a>2 表面模型的搭建：</h2><p><img src="/2018/08/25/ex42/ex42-1.jpeg" alt="">主要使用Material Studio进行切面操作，这一部分，本人不想做过多的解释，因为各大培训班，网上各种博客都有操作说明。本节大师兄通过Cu(111)面的例子给大家简单演示一下。</p>
<p><strong>2.1 块体计算</strong><br>1) 搭建Cu单胞模型，用VESTA导出VASP计算使用的POSCAR文件，这部分不清楚的筒子们可以复习前面bulk计算的相关内容。</p>
<p>2)  INCAR文件的准备<br>A) Cu是金属，ISMEAR=1， SIGMA=0.1<br>B) ENCUT=700， Cu单胞含有的原子数很少，可以把ENCUT设置大一点<br>C) EDIFF和EDIFFG控制电子步收敛和离子弛豫的精度<br>D) PREC=High  </p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">SYSTEM = Cu-Bulk calculation RELAX</span><br><span class="line">ISTART = <span class="number">0</span></span><br><span class="line">ICHARG = <span class="number">2</span></span><br><span class="line">ENCUT = <span class="number">700</span></span><br><span class="line">EDIFF = <span class="number">1e-6</span></span><br><span class="line">IBRION = <span class="number">1</span></span><br><span class="line">NSW = <span class="number">200</span></span><br><span class="line">EDIFFG = -<span class="number">0.01</span></span><br><span class="line">ISIF = <span class="number">3</span></span><br><span class="line">POTIM = <span class="number">0.1</span></span><br><span class="line">ISMEAR = <span class="number">1</span></span><br><span class="line">SIGMA = <span class="number">0.1</span></span><br><span class="line">PREC = H</span><br><span class="line">LREAL = Auto</span><br><span class="line">ALGO = Fast</span><br><span class="line">NCORE = <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>E）这里LREAL设置为Auto，是为了和后面表面能计算统一。计算时要根据原子数的多少，以及后续的计算选择LREAL的值。不能拿LREAL=.FALSE.和LREAL=ON/.TRUE.计算的结果进行能量比较。看下面<br><img src="/2018/08/25/ex42/ex42-4.jpeg" alt=""><br>F) 注意：块体材料计算时，为了后续计算其他性质，常常要求整个计算中使用相同的ENCUT，ENAUG， PREC， LREAL， ROPT，这部分大家可以看看手册 8.3 What kind of “technical” errors do exist， overview<br><img src="/2018/08/25/ex42/ex42-5.jpeg" alt=""></p>
<p>3) KPOINTS<br>a=b=c=3.6147 $\AA$， 根据前面的经验，这里设置为$13\times13\times13$的KPOINTS(Gamma  Centered).</p>
<p>4) 准备POTCAR文件进行计算：见前面讲的相关脚本—Ex30 进阶前的准备（三）</p>
<p>5) 最后计算完的Cu的晶格常数为 3.6370 $\AA$，实验值为3.615 $\AA$。大家可以去计算下。（计算例子可以QQ群中下载，也可通过该链接：<a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1dE84fhn">http://pan.baidu.com/s/1dE84fhn</a> 密码：nvwa）</p>
<p><strong>2.2 结构优化的注意事项：</strong></p>
<p>关于结构优化，大家在计算时要注意下面的部分，7.6.2 Accurate bulk relaxations with internal parameters (one)一定要详细的读。<br><img src="/2018/08/25/ex42/ex42-6.jpeg" alt=""></p>
<p><strong>2.3 小结</strong><br>主要以金属Cu为例讲了块体材料的计算，以及块体材料计算时的一些注意事项：</p>
<ul>
<li>体材料计算时首先要对要了解材料的性质，根据材料是金属、非金属，还是半导体，选择不同的ISMEAR和SIGMA；</li>
<li>计算时要根据原子数的多少，以及后续的计算选择LREAL的值，这方面不熟悉的朋友可以看看手册；</li>
<li>精确进行块体计算的过程以及注意事项；</li>
<li>回顾Ex36 Bulk的优化。</li>
</ul>
<h2 id="3-MS建立slab模型"><a href="#3-MS建立slab模型" class="headerlink" title="3   MS建立slab模型"></a>3   MS建立slab模型</h2><p><strong>3.1 具体步骤</strong></p>
<ul>
<li><p><code>VESTA</code>将<code>CONTCAR</code>转成<code>cif</code>格式，</p>
</li>
<li><p>MS导入cif文件，</p>
</li>
<li><p><code>build</code>→<code>surface</code>→<code>cleave surface</code>， 如下图所示，在<code>cleave plane(hkl)</code>可以输入要切的晶面，如（111）面，<img src="/2018/08/25/ex42/ex42-7.jpeg" alt=""></p>
</li>
<li><p>在<code>Surface Mesh</code>→<code>surface vectors</code>可以改变slab模型的vectors，之后选择Cleave进行切面，本例为（111）。这个时候也可以通过调节<code>Surface Box</code>→<code>top</code>和<code>thickness</code>，选择slab模型的表面终端和厚度。<img src="/2018/08/25/ex42/ex42-8.jpeg" alt="">     <img src="/2018/08/25/ex42/ex42-9.jpeg" alt=""></p>
</li>
<li><p>确定好表面终端和slab厚度之后，加真空层。<br><code>Build</code>→<code>Crystals</code>→<code>Build vacuum slab</code>，<code>Vacuum orientation</code>选择C指定真空层加在z方向上。可以通过改变<code>Vacuum thickness</code>设置真空层的厚度10 $\AA$，15 $\AA$或者更大。这可以参照之前的计算。最后选择Build完成slab模型的建立。<br><img src="/2018/08/25/ex42/ex42-10.jpeg" alt=""></p>
</li>
<li><p>可以通过<code>Lattice parameters</code>→<code>Advanced</code>→<code>Re-orient to standard</code>把真空层设置沿Z轴。<img src="/2018/08/25/ex42/ex42-11.jpeg" alt="">   <img src="/2018/08/25/ex42/ex42-12.jpeg" alt=""></p>
</li>
</ul>
<h2 id="4-总结："><a href="#4-总结：" class="headerlink" title="4  总结："></a>4  总结：</h2><p>  从本节开始，大家开始步入表面相关的计算学习。请务必认真阅读参考书，重复计算示例。本节主要简单介绍了一下Slab模型以及基本的注意事项。通过Cu的计算复习了一下<code>Bulk</code>的计算以及展示了一下通过<code>Material Studio</code>进行Cu(111)表面的搭建过程。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/02/10/ex41/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/02/10/ex41/" class="post-title-link" itemprop="url">Ex-41 DOS 计算(五)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-02-10 15:30:16" itemprop="dateCreated datePublished" datetime="2018-02-10T15:30:16-05:00">2018-02-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/02/10/ex41/" class="post-meta-item leancloud_visitors" data-flag-title="Ex-41 DOS 计算(五)" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/02/10/ex41/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/02/10/ex41/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>前面我们讲解了手动求积分的原理，本节由QQ群中的小书童给大家演示一遍Origin求积分的操作，加深一下对积分原理的印象，也借此机会掌握另一项Origin的技能。Origin的 .opj文件和Excel数据已经打包上传到QQ群中，也可以百度网盘下载：<a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1bpvmXY3">http://pan.baidu.com/s/1bpvmXY3</a></p>
<h2 id="1-求d带中心"><a href="#1-求d带中心" class="headerlink" title="1 求d带中心"></a><strong>1 求d带中心</strong></h2><p>1.1 复制粘贴能量、态密度、能量*态密度这三列数据到Origin中，数据见前一节练习：</p>
<p>下面我们取了<code>d band</code> 的一小部分区间作为示例进行讲解，大家学习完之后自己主动练习，获取最终的<code>d band center</code>.</p>
<p><img src="/2018/02/10/ex41/ex41-1.png" alt=""></p>
<p>1.2 选中数据并作图：</p>
<p><img src="/2018/02/10/ex41/ex41-2.png" alt=""></p>
<p><strong>plot —&gt; Line —&gt; Line</strong></p>
<p><img src="/2018/02/10/ex41/ex41-3.png" alt=""></p>
<p><img src="/2018/02/10/ex41/ex41-4.png" alt=""></p>
<p>1.3 求积分，先选中一条曲线，右键，<code>Ungroup</code>（将曲线从组中分离，便于选择）。</p>
<p><img src="/2018/02/10/ex41/ex41-5.png" alt=""></p>
<p>1.4 打开积分对话框：</p>
<p><img src="/2018/02/10/ex41/ex41-6.png" alt=""></p>
<p>1.5 再选择一条曲线进行积分，下图选择的是黑线。</p>
<p><img src="/2018/02/10/ex41/ex41-7.png" alt=""></p>
<p><img src="/2018/02/10/ex41/ex41-8.png" alt=""></p>
<p>点击OK，截图中的area就是我们要的积分，这一面积对应下图公式中的分母部分。</p>
<p><img src="/2018/02/10/ex41/ex41-9.png" alt=""></p>
<p> <img src="/2018/02/10/ex41/ex41-10.png" alt=""></p>
<p><code>d band center</code> 的积分区间为整个d带：即从负无穷到正无穷。本例我们用区间 [-6, 2]作为例子！有时候大家会对积分的区间产生疑问。一般来说积分区间是从负无穷到正无穷，但是：</p>
<ul>
<li><p>1）如上图，[-9,-8]这个区间Density为0，积分从[-9,4.0] 和[-8,4.0]结果没什么区别。</p>
</li>
<li><p>2）如果我们关心的是[-6,4.0]这一部分的性质，倘若4.0以后的部分会产生很大的噪音，那么我们也可以只从-6积分到4.0。</p>
</li>
<li><p>所以，积分区间也不是很绝对，大家要根据自己的体系合理选择。</p>
</li>
</ul>
<p>1.6 同理，选中另一条红线（能量和密度乘积），进行积分计算（上图中的分子部分） </p>
<p><img src="/2018/02/10/ex41/ex41-11.png" alt=""></p>
<p> 结果如下:</p>
<p> <img src="/2018/02/10/ex41/ex41-12.png" alt=""></p>
<p>最终，我们计算的d带区间[-6,2]的中心果为：-34.035/ 17.428 = -1.953</p>
<hr>
<h2 id="2-求电子数目"><a href="#2-求电子数目" class="headerlink" title="2 求电子数目"></a><strong>2</strong> <strong>求电子数目</strong></h2><p>电子数目的积分是从负无穷到费米能级。本例中是从-10到0（费米能级）进行积分， 选择黑线，重复前面的操作：</p>
<p>  <img src="/2018/02/10/ex41/ex41-15.png" alt=""></p>
<p>计算结果如下，电子数为13.00</p>
<p>  <img src="/2018/02/10/ex41/ex41-16.png" alt=""></p>
<hr>
<p><strong>3</strong> <strong>扩展练习：</strong></p>
<p>3.1 熟练Get本节Origin求积分的技巧；</p>
<p>3.2 阅读前面几节DOS计算的练习章节；熟练掌握DOS的提取，导出，作图和积分；</p>
<p>3.3 <code>d band center</code> 是对整个区间求积分，电子数目的积分区间是从负无穷到费米能级。</p>
<hr>
<p><strong>4</strong> <strong>总结：</strong></p>
<p>截止到本节，DOS的计算就暂时告一段落了，实际计算中，DOS的分析远远不止我们讲述的这么简单，而且网上DOS分析的脚本很多。大师兄了解到的有VTST的DOS处理脚本和vaspkit等，大家可以尝试练习使用下。如果你在科研工作中对DOS分析有自己的心得，DOS分析脚本的使用经验等，欢迎补充，分享给大家。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.bigbrosci.com/2018/02/09/ex40/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="By BigBro(a)s">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Learn VASP The Hard Way">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/02/09/ex40/" class="post-title-link" itemprop="url">Ex-40 DOS 计算(四)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-02-09 15:30:16" itemprop="dateCreated datePublished" datetime="2018-02-09T15:30:16-05:00">2018-02-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-12-27 22:15:54" itemprop="dateModified" datetime="2021-12-27T22:15:54-05:00">2021-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LVASPTHW/" itemprop="url" rel="index"><span itemprop="name">LVASPTHW</span></a>
        </span>
    </span>

  
    <span id="/2018/02/09/ex40/" class="post-meta-item leancloud_visitors" data-flag-title="Ex-40 DOS 计算(四)" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/02/09/ex40/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/02/09/ex40/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>DOS积分的原理，积分公式相信大学的时候，大家已经掌握了，现在还有可能忘记了。不过没关系，虽然本节将积分，高等数学里面的暂时还用不到。对于DOS图来说，通过求积分可以得到相应的电子数。积分也就是求DOS曲线下的面积。但DOS图并不能通过一个函数的积分来获得，因为所对应的区域毫无规则可言。那么我们该怎么样积分呢？</p>
<p><strong>1</strong> <strong>积分的原理</strong></p>
<p>积分的原理就是把区域分成N个小块，计算每一块的面积，然后求和。如下图：</p>
<p><img src="/2018/02/09/ex40/ex40-1.png" alt=""></p>
<p>大师兄…..</p>
<p><img src="/2018/02/09/ex40/ex40-2.png" alt=""></p>
<p>好吧，言归正传，大师兄亲自画了一幅图，讲解积分的原理，如下：</p>
<p><img src="/2018/02/09/ex40/ex40-3.png" alt=""></p>
<p>1)将每一个小区间近似看成一个小的梯形，</p>
<p>2) 梯形的上底和下底为：$y_2$ 和$y_1$，高为：$x_2-x_1$。</p>
<p>3, 4)  也可以看成一个高为：$（y_1+y_2）/2$， 底为$x_2-x_1$ 的长方形。</p>
<p>5）面积为两者的乘积：$ΔA =（x_2-x_1）* （y_1+y_2）/2$。</p>
<p>6）将所有的小区间面积求和便得到了曲线所覆盖的面积，也就得到了我们所想要的电子数：$A =\sum\Delta A$</p>
<hr>
<p>注意：</p>
<p>1）电子数的积分区间是从负无穷到费米能级；</p>
<p>2）p4vasp的图中的0点就是费米能级，已经扣除过了。</p>
<p>3）科学网的一个参考链接：<a href="&lt;&lt;http://blog.sciencenet.cn/blog-567091-736149.html">&lt;&lt;http://blog.sciencenet.cn/blog-567091-736149.html</a>/&gt;&gt;</p>
<p><img src="/2018/02/09/ex40/ex40-4.png" alt=""></p>
<p>注意： 图中的DOS，如果你计算了，发现和大师兄的不一样，不用担心，大师兄本人把这个例子再运行了一遍，跟上面的图也不一样。（原因正在调查中）</p>
<hr>
<h2 id="2-d-band-center-的公式"><a href="#2-d-band-center-的公式" class="headerlink" title="2 d-band center 的公式"></a>2 d-band center 的公式</h2><p><img src="/2018/02/09/ex40/ex40-5.png" alt=""></p>
<p>在这里：</p>
<p>ε为前面的我们提到的x， $n_d$(ε)为y。在DOS图中，ε为能量， $n_d$(ε)为电子的密度。</p>
<p>注意： 积分区间是从 <strong>负无穷</strong> 到 <strong>正无穷</strong></p>
<p>参考书籍： Fundamental Concepts in Heterogeneous Catalysis，Jens K. Nørskov, Felix Studt, Frank Abild-Pedersen, Thomas Bligaard， John Wiley &amp; Sons, Inc.</p>
<p>!<img src="/2018/02/09/ex40/ex40-6.png" alt=""></p>
<p>QQ群文件的Books文件夹中下载 </p>
<p><img src="/2018/02/09/ex40/ex40-7.png" alt=""></p>
<p>百度网盘下载链接：<a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1bWS2Gu">http://pan.baidu.com/s/1bWS2Gu</a></p>
<p><img src="/2018/02/09/ex40/ex40-8.png" alt=""></p>
<hr>
<p>d 带穿过了费米能级，说明Ru是金属。（废话，等于白说！）</p>
<p>d带的积分从最左面到最右面。</p>
<p>关于d band 的介绍：知乎有个专栏，有兴趣的可以浏览一下：</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/26230183">https://zhuanlan.zhihu.com/p/26230183</a> </p>
<hr>
<p><strong>3 Excel手动求积分：</strong></p>
<p>对应的公式都写在第二行里面了，excel中计算完第一个数值，直接选中然后往下拽就可以得到后面的数据了。计算文件以及Excel表格已经上传到QQ群和百度网盘，大家可以下载仔细观看练习，掌握该技能。</p>
<p>计算下载链接：<a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1kVqWFQn">http://pan.baidu.com/s/1kVqWFQn</a> </p>
<p><img src="/2018/02/09/ex40/ex40-9.png" alt=""></p>
<p>Step1: p4vasp 的 d band 数据！</p>
<p>Step2：A,B两列的乘积，也就是能量和密度的乘积：对应d band center公式中的<strong>分子</strong>：</p>
<p><img src="/2018/02/09/ex40/ex40-10.png" alt=""></p>
<p>Step3：</p>
<p>1）A4-A3:  小区间的能量间隔，也就是 dε，或者 xdx，$\Delta$x， $x_2-x_1$;</p>
<p>2）B4+B3: 小区间的两个起点和终点的高度：也就是对应的小区间两端的能量密度：$y_2+y_1$</p>
<p>3）C4+C3：小区间两端能量和密度乘积的加和： $x_1<em>y_1 + x_2</em>y_2 $ </p>
<p>4）Step4：求小区间的面积：</p>
<p>​      $D4<em>E4</em>0.5$：$(x_2-x_1) * (y_2+y_1)/2$</p>
<p>​      $D4<em>F4</em>0.5$: $ (x_2-x_1) <em> (x_1</em>y_1 + x_2*y_2)/2$</p>
<p>5）Step5: 将所有小区间的面积求和：</p>
<p>电子数：$\sum( (x_2-x_1) * (y_2+y_1)/2 ) $，从G4到G137(G137对应的是费米能级的那个点！！！)求和。</p>
<p><strong>再次强调：电子数目是从负无穷积分到费米能级！</strong></p>
<p>d带中心公式中的分子：从H4到H303求和</p>
<p>d带中心公式中的分母：和电子数的积分一样，但积分区间不同，这里从G4到G303求加和。</p>
<p><strong>再次强调：d带中心积分区间，按照公式，从负无穷积分到正无穷！</strong></p>
<p><em>d</em>带中心公式中的分子：从H4到H303求和</p>
<p><em>d</em>带中心公式中的分母：和电子数的积分一样，但积分区间不同，这里从G4到G303求加和。</p>
<p>以上将公式分开写，是为了方便大家理解，实际操作中，直接使用导出来的数据，将所有的公式合并在一起就可以了。</p>
<hr>
<p><strong>4 扩展练习：</strong></p>
<p>4.1 亲自上手操作，重现本节的结果；</p>
<p>4.2 尝试使用其他软件，方法求积分；</p>
<p>4.3 有好程序的，好脚本的分享给大家。</p>
<hr>
<p><strong>5</strong> <strong>总结：</strong></p>
<p>学习完本节，大家对DOS积分的数学知识应该可以掌握了，后面不管用什么软件或者脚本，都是将这个积分的原理写成机器语言来执行。知道了原理和通过excel自己操作一遍之后，基本上DOS积分的东西就懂了。下一节，QQ群里的小书童给大家演示一下Origin的积分操作。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">By BigBro(a)s</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"OWE4jcfK8IWkx4zaWuOloxKU-gzGzoHsz","app_key":"MRBwViAFCsPSOnnRF9LW7bdo","server_url":null,"security":true}</script>
  <script src="/js/third-party/statistics/lean-analytics.js"></script>


  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"bigbrosci-com","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({{ JSON.stringify(config) }});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="{{ src }}">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

</body>
</html>
